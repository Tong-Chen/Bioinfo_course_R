<!DOCTYPE html>
<html >

<head>

  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <title>转录组分析培训</title>
  <meta name="description" content="转录组分析培训">
  <meta name="generator" content="bookdown 0.5 and GitBook 2.6.7">

  <meta property="og:title" content="转录组分析培训" />
  <meta property="og:type" content="book" />
  
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="转录组分析培训" />
  
  
  

<meta name="author" content="R_course">


<meta name="date" content="2017-11-29">

  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black">
  
  
<link rel="prev" href="questions.html">
<link rel="next" href="r-plots.html">
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />









<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="http://www.ehbio.com"><img src="http://www.ehbio.com/logos/ehbio_gitbook_logo.png" width="95%"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>EHBIO Gene Technology</a></li>
<li class="chapter" data-level="1" data-path="questions.html"><a href="questions.html"><i class="fa fa-check"></i><b>1</b> 考题</a><ul>
<li class="chapter" data-level="1.1" data-path="questions.html"><a href="questions.html#section-1.1"><i class="fa fa-check"></i><b>1.1</b> 理论题</a></li>
<li class="chapter" data-level="1.2" data-path="questions.html"><a href="questions.html#section-1.2"><i class="fa fa-check"></i><b>1.2</b> 代码题</a></li>
<li class="chapter" data-level="1.3" data-path="questions.html"><a href="questions.html#section-1.3"><i class="fa fa-check"></i><b>1.3</b> 错误识别题</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="r.html"><a href="r.html"><i class="fa fa-check"></i><b>2</b> R基础</a><ul>
<li class="chapter" data-level="2.1" data-path="r.html"><a href="r.html#r"><i class="fa fa-check"></i><b>2.1</b> R安装</a></li>
<li class="chapter" data-level="2.2" data-path="r.html"><a href="r.html#rstudio"><i class="fa fa-check"></i><b>2.2</b> Rstudio基础</a><ul>
<li class="chapter" data-level="2.2.1" data-path="r.html"><a href="r.html#rstudio"><i class="fa fa-check"></i><b>2.2.1</b> Rstudio版本</a></li>
<li class="chapter" data-level="2.2.2" data-path="r.html"><a href="r.html#rstudio"><i class="fa fa-check"></i><b>2.2.2</b> Rstudio安装</a></li>
<li class="chapter" data-level="2.2.3" data-path="r.html"><a href="r.html#rstudio-"><i class="fa fa-check"></i><b>2.2.3</b> Rstudio 使用</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="r.html"><a href="r.html#r"><i class="fa fa-check"></i><b>2.3</b> R基本语法</a><ul>
<li class="chapter" data-level="2.3.1" data-path="r.html"><a href="r.html#section-2.3.1"><i class="fa fa-check"></i><b>2.3.1</b> 获取帮助文档，查看命令或函数的使用方法、事例或适用范围</a></li>
<li class="chapter" data-level="2.3.2" data-path="r.html"><a href="r.html#r"><i class="fa fa-check"></i><b>2.3.2</b> R中的变量及其初始化</a></li>
<li class="chapter" data-level="2.3.3" data-path="r.html"><a href="r.html#section-2.3.3"><i class="fa fa-check"></i><b>2.3.3</b> 变量类型和转换</a></li>
<li class="chapter" data-level="2.3.4" data-path="r.html"><a href="r.html#r"><i class="fa fa-check"></i><b>2.3.4</b> R中矩阵运算</a></li>
<li class="chapter" data-level="2.3.5" data-path="r.html"><a href="r.html#r"><i class="fa fa-check"></i><b>2.3.5</b> R中矩阵筛选合并</a></li>
<li class="chapter" data-level="2.3.6" data-path="r.html"><a href="r.html#str"><i class="fa fa-check"></i><b>2.3.6</b> <code>str</code>的应用</a></li>
<li class="chapter" data-level="2.3.7" data-path="r.html"><a href="r.html#r"><i class="fa fa-check"></i><b>2.3.7</b> R的包管理</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="r.html"><a href="r.html#cheetsheets"><i class="fa fa-check"></i><b>2.4</b> CheetSheets</a></li>
<li class="chapter" data-level="2.5" data-path="r.html"><a href="r.html#section-2.5"><i class="fa fa-check"></i><b>2.5</b> 参考</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="r-plots.html"><a href="r-plots.html"><i class="fa fa-check"></i><b>3</b> R plots</a><ul>
<li class="chapter" data-level="3.1" data-path="r-plots.html"><a href="r-plots.html#section-3.1"><i class="fa fa-check"></i><b>3.1</b> 热图绘制</a><ul>
<li class="chapter" data-level="3.1.1" data-path="r-plots.html"><a href="r-plots.html#section-3.1.1"><i class="fa fa-check"></i><b>3.1.1</b> 生成测试数据</a></li>
<li class="chapter" data-level="3.1.2" data-path="r-plots.html"><a href="r-plots.html#section-3.1.2"><i class="fa fa-check"></i><b>3.1.2</b> 转换数据格式</a></li>
<li class="chapter" data-level="3.1.3" data-path="r-plots.html"><a href="r-plots.html#section-3.1.3"><i class="fa fa-check"></i><b>3.1.3</b> 分解绘图</a></li>
<li class="chapter" data-level="3.1.4" data-path="r-plots.html"><a href="r-plots.html#section-3.1.4"><i class="fa fa-check"></i><b>3.1.4</b> 图形存储</a></li>
</ul></li>
<li class="chapter" data-level="3.2" data-path="r-plots.html"><a href="r-plots.html#section-3.2"><i class="fa fa-check"></i><b>3.2</b> 热图美化</a><ul>
<li class="chapter" data-level="3.2.1" data-path="r-plots.html"><a href="r-plots.html#section-3.2.1"><i class="fa fa-check"></i><b>3.2.1</b> 对数转换</a></li>
<li class="chapter" data-level="3.2.2" data-path="r-plots.html"><a href="r-plots.html#z-score"><i class="fa fa-check"></i><b>3.2.2</b> Z-score转换</a></li>
<li class="chapter" data-level="3.2.3" data-path="r-plots.html"><a href="r-plots.html#section-3.2.3"><i class="fa fa-check"></i><b>3.2.3</b> 抹去异常值</a></li>
<li class="chapter" data-level="3.2.4" data-path="r-plots.html"><a href="r-plots.html#section-3.2.4"><i class="fa fa-check"></i><b>3.2.4</b> 非线性颜色</a></li>
<li class="chapter" data-level="3.2.5" data-path="r-plots.html"><a href="r-plots.html#section-3.2.5"><i class="fa fa-check"></i><b>3.2.5</b> 调整行或列的顺序</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="r-plots.html"><a href="r-plots.html#---pheatmap"><i class="fa fa-check"></i><b>3.3</b> 热图绘制 - pheatmap</a></li>
<li class="chapter" data-level="3.4" data-path="r-plots.html"><a href="r-plots.html#section-3.4"><i class="fa fa-check"></i><b>3.4</b> 不改脚本的热图绘制</a></li>
<li class="chapter" data-level="3.5" data-path="r-plots.html"><a href="r-plots.html#section-3.5"><i class="fa fa-check"></i><b>3.5</b> 箱线图</a><ul>
<li class="chapter" data-level="3.5.1" data-path="r-plots.html"><a href="r-plots.html#section-3.5.1"><i class="fa fa-check"></i><b>3.5.1</b> 一步步解析箱线图绘制</a></li>
<li class="chapter" data-level="3.5.2" data-path="r-plots.html"><a href="r-plots.html#-a"><i class="fa fa-check"></i><b>3.5.2</b> 绘制单个基因 (A)的箱线图</a></li>
<li class="chapter" data-level="3.5.3" data-path="r-plots.html"><a href="r-plots.html#section-3.5.3"><i class="fa fa-check"></i><b>3.5.3</b> 长矩阵绘制箱线图</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="r-plots.html"><a href="r-plots.html#---"><i class="fa fa-check"></i><b>3.6</b> 箱线图 - 一步绘制</a></li>
<li class="chapter" data-level="3.7" data-path="r-plots.html"><a href="r-plots.html#section-3.7"><i class="fa fa-check"></i><b>3.7</b> 线图</a><ul>
<li class="chapter" data-level="3.7.1" data-path="r-plots.html"><a href="r-plots.html#section-3.7.1"><i class="fa fa-check"></i><b>3.7.1</b> 单线图</a></li>
<li class="chapter" data-level="3.7.2" data-path="r-plots.html"><a href="r-plots.html#section-3.7.2"><i class="fa fa-check"></i><b>3.7.2</b> 多线图</a></li>
<li class="chapter" data-level="3.7.3" data-path="r-plots.html"><a href="r-plots.html#section-3.7.3"><i class="fa fa-check"></i><b>3.7.3</b> 横轴文本线图</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="r-plots.html"><a href="r-plots.html#---"><i class="fa fa-check"></i><b>3.8</b> 线图 - 一步绘制</a></li>
<li class="chapter" data-level="3.9" data-path="r-plots.html"><a href="r-plots.html#section-3.9"><i class="fa fa-check"></i><b>3.9</b> 散点图</a><ul>
<li class="chapter" data-level="3.9.1" data-path="r-plots.html"><a href="r-plots.html#section-3.9.1"><i class="fa fa-check"></i><b>3.9.1</b> 横纵轴都为数字的散点图解析</a></li>
<li class="chapter" data-level="3.9.2" data-path="r-plots.html"><a href="r-plots.html#section-3.9.2"><i class="fa fa-check"></i><b>3.9.2</b> 横纵轴都为字符串的散点图展示</a></li>
<li class="chapter" data-level="3.9.3" data-path="r-plots.html"><a href="r-plots.html#section-3.9.3"><i class="fa fa-check"></i><b>3.9.3</b> 一网打进散点图绘制</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="r-plots.html"><a href="r-plots.html#section-3.10"><i class="fa fa-check"></i><b>3.10</b> 功能富集泡泡图</a><ul>
<li class="chapter" data-level="3.10.1" data-path="r-plots.html"><a href="r-plots.html#section-3.10.1"><i class="fa fa-check"></i><b>3.10.1</b> 单样品分开绘制</a></li>
<li class="chapter" data-level="3.10.2" data-path="r-plots.html"><a href="r-plots.html#section-3.10.2"><i class="fa fa-check"></i><b>3.10.2</b> 多样品合并绘制</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="r-plots.html"><a href="r-plots.html#section-3.11"><i class="fa fa-check"></i><b>3.11</b> 韦恩图</a><ul>
<li class="chapter" data-level="3.11.1" data-path="r-plots.html"><a href="r-plots.html#section-3.11.1"><i class="fa fa-check"></i><b>3.11.1</b> 韦恩图一步法</a></li>
<li class="chapter" data-level="3.11.2" data-path="r-plots.html"><a href="r-plots.html#upsetview"><i class="fa fa-check"></i><b>3.11.2</b> UpSetView展示</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="r-plots.html"><a href="r-plots.html#section-3.12"><i class="fa fa-check"></i><b>3.12</b> 柱状图绘制</a><ul>
<li class="chapter" data-level="3.12.1" data-path="r-plots.html"><a href="r-plots.html#section-3.12.1"><i class="fa fa-check"></i><b>3.12.1</b> 常规矩阵柱状图绘制</a></li>
<li class="chapter" data-level="3.12.2" data-path="r-plots.html"><a href="r-plots.html#section-3.12.2"><i class="fa fa-check"></i><b>3.12.2</b> 长矩阵分面绘制</a></li>
</ul></li>
<li class="chapter" data-level="3.13" data-path="r-plots.html"><a href="r-plots.html#section-3.13"><i class="fa fa-check"></i><b>3.13</b> 图形支持中文字体</a><ul>
<li class="chapter" data-level="3.13.1" data-path="r-plots.html"><a href="r-plots.html#section-3.13.1"><i class="fa fa-check"></i><b>3.13.1</b> 修改图形的字体</a></li>
<li class="chapter" data-level="3.13.2" data-path="r-plots.html"><a href="r-plots.html#ggplot2pdf"><i class="fa fa-check"></i><b>3.13.2</b> ggplot2支持中文字体输出PDF</a></li>
<li class="chapter" data-level="3.13.3" data-path="r-plots.html"><a href="r-plots.html#section-3.13.3"><i class="fa fa-check"></i><b>3.13.3</b> 系统可用字体</a></li>
<li class="chapter" data-level="3.13.4" data-path="r-plots.html"><a href="r-plots.html#section-3.13.4"><i class="fa fa-check"></i><b>3.13.4</b> 合并字体支持中英文</a></li>
<li class="chapter" data-level="3.13.5" data-path="r-plots.html"><a href="r-plots.html#section-3.13.5"><i class="fa fa-check"></i><b>3.13.5</b> 一个示例</a></li>
</ul></li>
<li class="chapter" data-level="3.14" data-path="r-plots.html"><a href="r-plots.html#pca"><i class="fa fa-check"></i><b>3.14</b> PCA</a><ul>
<li class="chapter" data-level="3.14.1" data-path="r-plots.html"><a href="r-plots.html#section-3.14.1"><i class="fa fa-check"></i><b>3.14.1</b> 主成分分析简介</a></li>
<li class="chapter" data-level="3.14.2" data-path="r-plots.html"><a href="r-plots.html#section-3.14.2"><i class="fa fa-check"></i><b>3.14.2</b> 主成分分析的意义</a></li>
<li class="chapter" data-level="3.14.3" data-path="r-plots.html"><a href="r-plots.html#section-3.14.3"><i class="fa fa-check"></i><b>3.14.3</b> 示例展示原始变量对样品的分类</a></li>
<li class="chapter" data-level="3.14.4" data-path="r-plots.html"><a href="r-plots.html#pca"><i class="fa fa-check"></i><b>3.14.4</b> PCA的实现原理</a></li>
<li class="chapter" data-level="3.14.5" data-path="r-plots.html"><a href="r-plots.html#pca"><i class="fa fa-check"></i><b>3.14.5</b> 简单的PCA实现</a></li>
<li class="chapter" data-level="3.14.6" data-path="r-plots.html"><a href="r-plots.html#pca"><i class="fa fa-check"></i><b>3.14.6</b> PCA结果解释</a></li>
<li class="chapter" data-level="3.14.7" data-path="r-plots.html"><a href="r-plots.html#pca"><i class="fa fa-check"></i><b>3.14.7</b> PCA应用于测试数据</a></li>
<li class="chapter" data-level="3.14.8" data-path="r-plots.html"><a href="r-plots.html#pca"><i class="fa fa-check"></i><b>3.14.8</b> PCA总结</a></li>
<li class="chapter" data-level="3.14.9" data-path="r-plots.html"><a href="r-plots.html#pca"><i class="fa fa-check"></i><b>3.14.9</b> PCA注意事项</a></li>
<li class="chapter" data-level="3.14.10" data-path="r-plots.html"><a href="r-plots.html#section-3.14.10"><i class="fa fa-check"></i><b>3.14.10</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="3.15" data-path="r-plots.html"><a href="r-plots.html#section-3.15"><i class="fa fa-check"></i><b>3.15</b> 生存分析</a><ul>
<li class="chapter" data-level="3.15.1" data-path="r.html"><a href="r.html#r"><i class="fa fa-check"></i><b>3.15.1</b> R做生存分析</a></li>
<li class="chapter" data-level="3.15.2" data-path="r-plots.html"><a href="r-plots.html#section-3.15.2"><i class="fa fa-check"></i><b>3.15.2</b> 一步作图的优势</a></li>
</ul></li>
<li class="chapter" data-level="3.16" data-path="r-plots.html"><a href="r-plots.html#-1"><i class="fa fa-check"></i><b>3.16</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cytoscape.html"><a href="cytoscape.html"><i class="fa fa-check"></i><b>4</b> 网络图</a><ul>
<li class="chapter" data-level="4.0.1" data-path="cytoscape.html"><a href="cytoscape.html#section-4.0.1"><i class="fa fa-check"></i><b>4.0.1</b> 基本操作</a></li>
<li class="chapter" data-level="4.0.2" data-path="cytoscape.html"><a href="cytoscape.html#mirna-mrna"><i class="fa fa-check"></i><b>4.0.2</b> miRNA-mRNA调控网络</a></li>
<li class="chapter" data-level="4.0.3" data-path="cytoscape.html"><a href="cytoscape.html#section-4.0.3"><i class="fa fa-check"></i><b>4.0.3</b> 不同的布局的调试和修改</a></li>
<li class="chapter" data-level="4.1" data-path="r-plots.html"><a href="r-plots.html#-1"><i class="fa fa-check"></i><b>4.1</b> 参考</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="AI.html"><a href="AI.html"><i class="fa fa-check"></i><b>5</b> 图形排版</a><ul>
<li class="chapter" data-level="5.0.1" data-path="AI.html"><a href="AI.html#section-5.0.1"><i class="fa fa-check"></i><b>5.0.1</b> 矢量图和标量图</a></li>
<li class="chapter" data-level="5.0.2" data-path="AI.html"><a href="AI.html#section-5.0.2"><i class="fa fa-check"></i><b>5.0.2</b> 矢量图的制作</a></li>
<li class="chapter" data-level="5.0.3" data-path="AI.html"><a href="AI.html#section-5.0.3"><i class="fa fa-check"></i><b>5.0.3</b> 矢量图编辑工具</a></li>
<li class="chapter" data-level="5.0.4" data-path="AI.html"><a href="AI.html#section-5.0.4"><i class="fa fa-check"></i><b>5.0.4</b> 作图基本原则</a></li>
<li class="chapter" data-level="5.0.5" data-path="AI.html"><a href="AI.html#section-5.0.5"><i class="fa fa-check"></i><b>5.0.5</b> 作图中的要点注意</a></li>
<li class="chapter" data-level="5.0.6" data-path="AI.html"><a href="AI.html#adobe-illustrator"><i class="fa fa-check"></i><b>5.0.6</b> <code>Adobe Illustrator</code>中的基本概念和操作描述</a></li>
<li class="chapter" data-level="5.0.7" data-path="AI.html"><a href="AI.html#section-5.0.7"><i class="fa fa-check"></i><b>5.0.7</b> 视频教程</a></li>
<li class="chapter" data-level="5.0.8" data-path="AI.html"><a href="AI.html#section-5.0.8"><i class="fa fa-check"></i><b>5.0.8</b> 动图教程</a></li>
<li class="chapter" data-level="5.1" data-path="AI.html"><a href="AI.html#-2"><i class="fa fa-check"></i><b>5.1</b> 参考</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="-3.html"><a href="-3.html"><i class="fa fa-check"></i><b>6</b> 参考</a><ul>
<li class="chapter" data-level="6.1" data-path="-3.html"><a href="-3.html#section-6.1"><i class="fa fa-check"></i><b>6.1</b> 程序学习心得</a></li>
<li class="chapter" data-level="6.2" data-path="-3.html"><a href="-3.html#ngs"><i class="fa fa-check"></i><b>6.2</b> NGS分析工具评估</a></li>
<li class="chapter" data-level="6.3" data-path="-3.html"><a href="-3.html#section-6.3"><i class="fa fa-check"></i><b>6.3</b> 文献精读</a></li>
<li class="chapter" data-level="6.4" data-path="-3.html"><a href="-3.html#linux-"><i class="fa fa-check"></i><b>6.4</b> Linux 学习</a></li>
<li class="chapter" data-level="6.5" data-path="r.html"><a href="r.html#r"><i class="fa fa-check"></i><b>6.5</b> R统计和作图</a></li>
<li class="chapter" data-level="6.6" data-path="-3.html"><a href="-3.html#ngs"><i class="fa fa-check"></i><b>6.6</b> NGS基础</a></li>
<li class="chapter" data-level="6.7" data-path="-3.html"><a href="-3.html#section-6.7"><i class="fa fa-check"></i><b>6.7</b> 癌症数据库</a></li>
<li class="chapter" data-level="6.8" data-path="-3.html"><a href="-3.html#python"><i class="fa fa-check"></i><b>6.8</b> Python学习</a></li>
<li class="chapter" data-level="6.9" data-path="-3.html"><a href="-3.html#ngs"><i class="fa fa-check"></i><b>6.9</b> NGS软件</a></li>
<li class="chapter" data-level="6.10" data-path="cytoscape.html"><a href="cytoscape.html#cytoscape"><i class="fa fa-check"></i><b>6.10</b> Cytoscape网络图</a></li>
<li class="chapter" data-level="6.11" data-path="-3.html"><a href="-3.html#section-6.11"><i class="fa fa-check"></i><b>6.11</b> 分子对接</a></li>
<li class="chapter" data-level="6.12" data-path="-3.html"><a href="-3.html#section-6.12"><i class="fa fa-check"></i><b>6.12</b> 生信宝典之傻瓜式</a></li>
<li class="chapter" data-level="6.13" data-path="-3.html"><a href="-3.html#section-6.13"><i class="fa fa-check"></i><b>6.13</b> 生信人写程序</a></li>
<li class="chapter" data-level="6.14" data-path="-3.html"><a href="-3.html#section-6.14"><i class="fa fa-check"></i><b>6.14</b> 小技巧系列</a></li>
<li class="chapter" data-level="6.15" data-path="-3.html"><a href="-3.html#section-6.15"><i class="fa fa-check"></i><b>6.15</b> 招聘</a></li>
</ul></li>
<li class="chapter" data-level="7" data-path="company-intro.html"><a href="company-intro.html"><i class="fa fa-check"></i><b>7</b> 公司简介</a></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="mailto:ct@ehbio.com" target="blank">ct@ehbio.com</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">转录组分析培训</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="r" class="section level1">
<h1><span class="header-section-number">2</span> R基础</h1>
<p>R语言是比较常用的统计分析和绘图语言，拥有强大的统计库、绘图库和生信分析的Bioconductor库，是学习生物信息分析的必备语言之一。</p>
<div id="r" class="section level2">
<h2><span class="header-section-number">2.1</span> R安装</h2>
<p><strong>Linux下安装</strong></p>
<p>如果使用的是新版的操作系统。直接可以用<code>sudo apt-get installl r-base</code> 或者<code>yum install r-base</code>来安装。</p>
<p>若系统版本老，或没有根用户权限，则需要下载编译源码安装，最新地址为<a href="https://cran.r-project.org/src/base/R-latest.tar.gz" class="uri">https://cran.r-project.org/src/base/R-latest.tar.gz</a>。</p>
<p>具体编译方式为 (Linux下软件安装见 <a href="http://blog.genesino.com/2016/06/bash1" class="uri">http://blog.genesino.com/2016/06/bash1</a>):</p>
<pre><code># configure是收集系统信息，生成Makefile的过程
# --enable-R-shlib 需要设置，使得其他程序包括Rstudio可以使用R的动态库
# --prefix指定软件安装目录，需使用绝对路径
./configure --prefix=/home/ehbio/R/3.4.0 --enable-R-shlib

# 也可以使用这个命令，共享系统的blas库，提高运输速度
#./configure --prefix=/home/ehbio/R/3.4.0 --enable-R-shlib --with-blas --with-lapack

# make是编译的过程
make

# 安装到指定目录的过程
make install</code></pre>
<p>安装完成之后，在Linux终端输入<code>R</code>即可启动交互式运行界面，<code>ctrl+d</code>推出<code>R</code>运行界面。若提示<code>找不到命令</code>，需要判断有没有加入进环境变量。</p>
<p><strong>Windows下安装</strong></p>
<p>下载 <a href="https://cran.r-project.org/bin/windows/" class="uri">https://cran.r-project.org/bin/windows/</a>双击就可以了。</p>
<p>两者都需要考虑环境变量，若有问题，见文后的参考。</p>
</div>
<div id="rstudio" class="section level2">
<h2><span class="header-section-number">2.2</span> Rstudio基础</h2>
<p>Rstudio是编辑、运行R语言的最为理想的工具之一，支持纯R脚本、Rmarkdown (脚本文档混排)、Bookdown (脚本文档混排成书)、Shiny (交互式网络应用)等。</p>
<div id="rstudio" class="section level3">
<h3><span class="header-section-number">2.2.1</span> Rstudio版本</h3>
<p>Rsdutio分为桌面版和服务器版，桌面版可以在单机使用，服务器版可以从浏览器访问供多人使用。</p>
<p>服务器版安装好之后，访问地址为<服务器IP:8787> (8787为默认端口号)，用户名和密码为Linux用户的用户名和密码。</p>
<div class="figure">
<img src="images/Rstudio_version.png" alt="Rstudio version" />
<p class="caption">Rstudio version</p>
</div>
</div>
<div id="rstudio" class="section level3">
<h3><span class="header-section-number">2.2.2</span> Rstudio安装</h3>
<p><strong>Linux下安装服务器版</strong></p>
<p>安装参考 <a href="https://www.rstudio.com/products/rstudio/download-server/" class="uri">https://www.rstudio.com/products/rstudio/download-server/</a></p>
<pre><code>wget https://download2.rstudio.org/rstudio-server-rhel-1.0.136-x86_64.rpm
sudo yum install --nogpgcheck rstudio-server-rhel-1.0.136-x86_64.rpm</code></pre>
<p>安装完之后的检测、启动和配置</p>
<pre><code>sudo rstudio-server verify-installation #查看是否安装正确
sudo rstudio-server start ## 启动
sudo rstudio-server status ## 查看状态
sudo rstudio-server stop ## 停止
ifconfig | grep &#39;inet addr&#39; ## 查看服务端ip地址
sudo rstudio-server start ## 修改配置文件后重启
sudo rstudio-server active-sessions ## 列出活跃的sessions:
sudo rstudio-server suspend-session &lt;pid&gt; ## 暂停session
sudo rstudio-server suspend-all ##暂停所有session</code></pre>
<ul>
<li>Rstudio日志目录，方便查看错误信息：/var/log/rstudio-server/</li>
<li>配置文件：</li>
<li><p>/etc/rstudio/rserver.conf</p>
<div class="sourceCode"><pre class="sourceCode bash"><code class="sourceCode bash"><span class="kw">www-port</span>=8787 (default)
<span class="kw">www-address</span>=0.0.0.0 (default)
<span class="kw">rsession-ld-library-path</span>=/opt/local/lib:/opt/local/someapp/lib
<span class="kw">rsession-which-r</span>=/usr/local/bin/R</code></pre></div></li>
<li>/etc/rstudio/rsession.conf
<ul>
<li>Timeout</li>
</ul>
<p><code>[user]   session-timeout-minutes=30   [@powerusers]   session-timeout-minutes=0</code></p></li>
</ul>
<p><strong>Windows下安装桌面版</strong></p>
<p>下载之后 (<a href="https://www.rstudio.com/products/rstudio/download2/" class="uri">https://www.rstudio.com/products/rstudio/download2/</a>)双击安装，需要使用<strong>管理员权限</strong>，其它无需要注意的。</p>
</div>
<div id="rstudio-" class="section level3">
<h3><span class="header-section-number">2.2.3</span> Rstudio 使用</h3>
<p>Windows下桌面版直接双击打开即可使用，Linux服务器版访问地址为<服务器IP:8787>，用户名和密码为Linux用户的用户名和密码。</p>
<div id="rstudio-" class="section level4">
<h4><span class="header-section-number">2.2.3.1</span> Rstudio 界面</h4>
<div class="figure">
<img src="images/Rstudio_IDE.png" alt="Rstudio" />
<p class="caption">Rstudio</p>
</div>
</div>
<div id="rstudio" class="section level4">
<h4><span class="header-section-number">2.2.3.2</span> Rstudio中新建或打开文件</h4>
<p>如果是桌面版，直接就可以访问“我的电脑”去打开之前写过的脚本。如果是服务器版，可直接访问服务器上写过的脚本。Rstudio右下1/4部分可以切换目录，点击more，设置工作目录。可以上传本地的脚本到对应目录打开。</p>
<div class="figure">
<img src="images/Rstudio.gif" alt="Rstudio.gif" />
<p class="caption">Rstudio.gif</p>
</div>
</div>
</div>
</div>
<div id="r" class="section level2">
<h2><span class="header-section-number">2.3</span> R基本语法</h2>
<div id="section-2.3.1" class="section level3">
<h3><span class="header-section-number">2.3.1</span> 获取帮助文档，查看命令或函数的使用方法、事例或适用范围</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">&gt;<span class="er">&gt;&gt;</span><span class="st"> </span>?command
&gt;<span class="er">&gt;&gt;</span><span class="st"> </span>??command <span class="co">#深度搜索或模糊搜索此命令</span>

&gt;<span class="er">&gt;&gt;</span><span class="st"> </span><span class="kw">example</span>(command) <span class="co">#得到命令的例子</span>

&gt;<span class="er">&gt;&gt;</span><span class="st"> </span><span class="kw">example</span>(plot)</code></pre></div>
</div>
<div id="r" class="section level3">
<h3><span class="header-section-number">2.3.2</span> R中的变量及其初始化</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 数字变量</span>
a &lt;-<span class="st"> </span><span class="dv">10</span>
a</code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 字符串变量</span>
a &lt;-<span class="st"> &quot;abc&quot;</span>
a</code></pre></div>
<pre><code>## [1] &quot;abc&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 逻辑变量</span>
a &lt;-<span class="st"> </span><span class="ot">TRUE</span>
a</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">b &lt;-<span class="st"> </span>T
b</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">d &lt;-<span class="st"> </span><span class="ot">FALSE</span>
d</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 向量</span>
a &lt;-<span class="st"> </span><span class="kw">vector</span>(<span class="dt">mode=</span><span class="st">&quot;logical&quot;</span>, <span class="dt">length=</span><span class="dv">5</span>)
a</code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)
<span class="co"># 判断一个变量是不是vector</span>
<span class="kw">is.vector</span>(a)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 矩阵</span>
a &lt;-<span class="st"> </span><span class="kw">matrix</span>(<span class="dv">1</span>:<span class="dv">20</span>,<span class="dt">nrow=</span><span class="dv">5</span>,<span class="dt">ncol=</span><span class="dv">4</span>,<span class="dt">byrow=</span>T)
a</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    2    3    4
## [2,]    5    6    7    8
## [3,]    9   10   11   12
## [4,]   13   14   15   16
## [5,]   17   18   19   20</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.matrix</span>(a)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">dim</span>(a) <span class="co">#查看或设置数组的维度向量</span></code></pre></div>
<pre><code>## [1] 5 4</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 错误的用法</span>
<span class="co"># dim(a) &lt;- c(4,4)</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 正确的用法</span>
a &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">20</span>
<span class="kw">dim</span>(a) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="dv">5</span>,<span class="dv">4</span>) <span class="co">#转换向量为矩阵</span>
a</code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    6   11   16
## [2,]    2    7   12   17
## [3,]    3    8   13   18
## [4,]    4    9   14   19
## [5,]    5   10   15   20</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;矩阵a的行数&quot;</span>, <span class="kw">nrow</span>(a)))</code></pre></div>
<pre><code>## [1] &quot;矩阵a的行数 5&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(<span class="kw">paste</span>(<span class="st">&quot;矩阵a的列数&quot;</span>, <span class="kw">ncol</span>(a)))</code></pre></div>
<pre><code>## [1] &quot;矩阵a的列数 4&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#查看或设置行列名</span>
<span class="kw">rownames</span>(a)</code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rownames</span>(a) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;c&#39;</span>,<span class="st">&#39;d&#39;</span>,<span class="st">&#39;e&#39;</span>)
a</code></pre></div>
<pre><code>##   [,1] [,2] [,3] [,4]
## a    1    6   11   16
## b    2    7   12   17
## c    3    8   13   18
## d    4    9   14   19
## e    5   10   15   20</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># R中获取一系列的字母</span>
letters[<span class="dv">1</span>:<span class="dv">4</span>]</code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">colnames</span>(a) &lt;-<span class="st"> </span>letters[<span class="dv">1</span>:<span class="dv">4</span>]
a</code></pre></div>
<pre><code>##   a  b  c  d
## a 1  6 11 16
## b 2  7 12 17
## c 3  8 13 18
## d 4  9 14 19
## e 5 10 15 20</code></pre>
</div>
<div id="section-2.3.3" class="section level3">
<h3><span class="header-section-number">2.3.3</span> 变量类型和转换</h3>
<p>不同的变量类型有不同的操作方式，<code>is</code>系列和<code>as</code>系列函数用来判断变量的属性和转换变量的属性</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.character</span>(a)</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.numeric</span>(a)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.matrix</span>(a)</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.data.frame</span>(a)</code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">is.data.frame</span>(<span class="kw">as.data.frame</span>(a))</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="r" class="section level3">
<h3><span class="header-section-number">2.3.4</span> R中矩阵运算</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 获得随机的正态分布数据</span>
<span class="co"># random generation for the normal distribution with mean equal to ‘mean’</span>
<span class="co"># and standard deviation equal to ‘sd’.</span>
<span class="kw">rnorm</span>(<span class="dv">10</span>, <span class="dt">mean =</span> <span class="dv">0</span>, <span class="dt">sd =</span> <span class="dv">1</span>) <span class="co"># 正态分布的随机数</span></code></pre></div>
<pre><code>##  [1]  2.23024165 -2.73941461  2.33929095  1.32758921 -0.64100292
##  [6] -0.08163893  1.47417453  1.59296361 -0.71412891  0.63441125</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 获得随机的均匀分布的数据</span>
<span class="co"># random generation for the uniform distribution with mean equal to ‘mean’</span>
<span class="co"># and standard deviation equal to ‘sd’.</span>
<span class="kw">runif</span>(<span class="dv">10</span>, <span class="dt">min =</span> <span class="dv">0</span>, <span class="dt">max =</span> <span class="dv">1</span>) <span class="co"># 平均分布的随机数</span></code></pre></div>
<pre><code>##  [1] 0.2699124 0.1339054 0.1498938 0.3053348 0.8649099 0.3953863 0.1925224
##  [8] 0.8236042 0.2131369 0.4147530</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>) <span class="co"># 把1重复5次</span></code></pre></div>
<pre><code>## [1] 1 1 1 1 1</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">scale</span>(<span class="dv">1</span>:<span class="dv">5</span>) <span class="co"># 标准化数据</span></code></pre></div>
<pre><code>##            [,1]
## [1,] -1.2649111
## [2,] -0.6324555
## [3,]  0.0000000
## [4,]  0.6324555
## [5,]  1.2649111
## attr(,&quot;scaled:center&quot;)
## [1] 3
## attr(,&quot;scaled:scale&quot;)
## [1] 1.581139</code></pre>
<p><code>scale</code>默认操作对等于</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 标准化数据</span>
a &lt;-<span class="st"> </span><span class="dv">1</span>:<span class="dv">5</span>
(a -<span class="st"> </span><span class="kw">mean</span>(a)) /<span class="st"> </span><span class="kw">sd</span>(a)</code></pre></div>
<pre><code>## [1] -1.2649111 -0.6324555  0.0000000  0.6324555  1.2649111</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">a &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="kw">rnorm</span>(<span class="dv">5</span>), <span class="kw">rnorm</span>(<span class="dv">5</span>,<span class="dv">1</span>), <span class="kw">runif</span>(<span class="dv">5</span>), <span class="kw">runif</span>(<span class="dv">5</span>,-<span class="dv">1</span>,<span class="dv">1</span>), <span class="dv">1</span>:<span class="dv">5</span>, <span class="kw">rep</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">13</span>,<span class="dv">4</span>), <span class="kw">scale</span>(<span class="dv">1</span>:<span class="dv">5</span>)[<span class="dv">1</span>:<span class="dv">5</span>])
a</code></pre></div>
<pre><code>##  [1]  0.47019704  1.30801540  1.53840128 -1.53610334 -0.76193499
##  [6]  0.32528326  0.47365445  2.37135402  1.00608936  1.40063889
## [11]  0.56042973  0.69221798  0.63840428  0.45255559  0.16584059
## [16] -0.52479857 -0.07757796  0.62680430  0.98954402  0.25185230
## [21]  1.00000000  2.00000000  3.00000000  4.00000000  5.00000000
## [26]  0.00000000  0.00000000  0.00000000  0.00000000  0.00000000
## [31]  2.00000000 10.00000000 11.00000000 13.00000000  4.00000000
## [36] -1.26491106 -0.63245553  0.00000000  0.63245553  1.26491106</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># ncol=5 5列</span>
<span class="co"># byrow=T: 先填充行</span>
a &lt;-<span class="st"> </span><span class="kw">matrix</span>(a, <span class="dt">ncol=</span><span class="dv">5</span>, <span class="dt">byrow=</span>T)
a</code></pre></div>
<pre><code>##            [,1]        [,2]       [,3]       [,4]       [,5]
## [1,]  0.4701970  1.30801540  1.5384013 -1.5361033 -0.7619350
## [2,]  0.3252833  0.47365445  2.3713540  1.0060894  1.4006389
## [3,]  0.5604297  0.69221798  0.6384043  0.4525556  0.1658406
## [4,] -0.5247986 -0.07757796  0.6268043  0.9895440  0.2518523
## [5,]  1.0000000  2.00000000  3.0000000  4.0000000  5.0000000
## [6,]  0.0000000  0.00000000  0.0000000  0.0000000  0.0000000
## [7,]  2.0000000 10.00000000 11.0000000 13.0000000  4.0000000
## [8,] -1.2649111 -0.63245553  0.0000000  0.6324555  1.2649111</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 按行加和</span>
<span class="kw">rowSums</span>(a)</code></pre></div>
<pre><code>## [1]  1.018575  5.577020  2.509448  1.265824 15.000000  0.000000 40.000000
## [8]  0.000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 注意检查括号的配对</span>
<span class="co">#a &lt;- a[rowSums(abs(a)!=0,]</span>
<span class="co">#错误: 意外的&#39;]&#39; in &quot;a &lt;- a[rowSums(abs(a)!=0,]&quot;</span>

<span class="co"># 去除全部为0的行</span>
a &lt;-<span class="st"> </span>a[<span class="kw">rowSums</span>(<span class="kw">abs</span>(a))!=<span class="dv">0</span>,]

<span class="co"># 另外一种方式去除全部为0的行</span>
<span class="co">#a[rowSums(a==0)&lt;ncol(a),]</span>

a</code></pre></div>
<pre><code>##            [,1]        [,2]       [,3]       [,4]       [,5]
## [1,]  0.4701970  1.30801540  1.5384013 -1.5361033 -0.7619350
## [2,]  0.3252833  0.47365445  2.3713540  1.0060894  1.4006389
## [3,]  0.5604297  0.69221798  0.6384043  0.4525556  0.1658406
## [4,] -0.5247986 -0.07757796  0.6268043  0.9895440  0.2518523
## [5,]  1.0000000  2.00000000  3.0000000  4.0000000  5.0000000
## [6,]  2.0000000 10.00000000 11.0000000 13.0000000  4.0000000
## [7,] -1.2649111 -0.63245553  0.0000000  0.6324555  1.2649111</code></pre>
<p>矩阵运算，R默认针对整个数据进行常见运算</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#所有值都乘以2</span>
a *<span class="st"> </span><span class="dv">2</span></code></pre></div>
<pre><code>##            [,1]       [,2]      [,3]       [,4]       [,5]
## [1,]  0.9403941  2.6160308  3.076803 -3.0722067 -1.5238700
## [2,]  0.6505665  0.9473089  4.742708  2.0121787  2.8012778
## [3,]  1.1208595  1.3844360  1.276809  0.9051112  0.3316812
## [4,] -1.0495971 -0.1551559  1.253609  1.9790880  0.5037046
## [5,]  2.0000000  4.0000000  6.000000  8.0000000 10.0000000
## [6,]  4.0000000 20.0000000 22.000000 26.0000000  8.0000000
## [7,] -2.5298221 -1.2649111  0.000000  1.2649111  2.5298221</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 所有值取绝对值，再取对数 （取对数前一般加一个数避免对0或负值取对数）</span>
<span class="kw">log2</span>(<span class="kw">abs</span>(a)+<span class="dv">1</span>)</code></pre></div>
<pre><code>##           [,1]      [,2]      [,3]      [,4]      [,5]
## [1,] 0.5560095 1.2066529 1.3439202 1.3426135 0.8171607
## [2,] 0.4063008 0.5593983 1.7533281 1.0043859 1.2634184
## [3,] 0.6419434 0.7589154 0.7122914 0.5385934 0.2213705
## [4,] 0.6086187 0.1077922 0.7020407 0.9924378 0.3240644
## [5,] 1.0000000 1.5849625 2.0000000 2.3219281 2.5849625
## [6,] 1.5849625 3.4594316 3.5849625 3.8073549 2.3219281
## [7,] 1.1794544 0.7070437 0.0000000 0.7070437 1.1794544</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 取出最大值、最小值、行数、列数</span>
<span class="kw">max</span>(a)</code></pre></div>
<pre><code>## [1] 13</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">min</span>(a)</code></pre></div>
<pre><code>## [1] -1.536103</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">nrow</span>(a)</code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">ncol</span>(a)</code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co">#增加一列或一行</span>
<span class="co">#cbind: column bind</span>
<span class="kw">cbind</span>(a, <span class="dv">1</span>:<span class="dv">7</span>)</code></pre></div>
<pre><code>##            [,1]        [,2]       [,3]       [,4]       [,5] [,6]
## [1,]  0.4701970  1.30801540  1.5384013 -1.5361033 -0.7619350    1
## [2,]  0.3252833  0.47365445  2.3713540  1.0060894  1.4006389    2
## [3,]  0.5604297  0.69221798  0.6384043  0.4525556  0.1658406    3
## [4,] -0.5247986 -0.07757796  0.6268043  0.9895440  0.2518523    4
## [5,]  1.0000000  2.00000000  3.0000000  4.0000000  5.0000000    5
## [6,]  2.0000000 10.00000000 11.0000000 13.0000000  4.0000000    6
## [7,] -1.2649111 -0.63245553  0.0000000  0.6324555  1.2649111    7</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># rbind: row bind</span>
<span class="kw">rbind</span>(a,<span class="dv">1</span>:<span class="dv">5</span>)</code></pre></div>
<pre><code>##            [,1]        [,2]       [,3]       [,4]       [,5]
## [1,]  0.4701970  1.30801540  1.5384013 -1.5361033 -0.7619350
## [2,]  0.3252833  0.47365445  2.3713540  1.0060894  1.4006389
## [3,]  0.5604297  0.69221798  0.6384043  0.4525556  0.1658406
## [4,] -0.5247986 -0.07757796  0.6268043  0.9895440  0.2518523
## [5,]  1.0000000  2.00000000  3.0000000  4.0000000  5.0000000
## [6,]  2.0000000 10.00000000 11.0000000 13.0000000  4.0000000
## [7,] -1.2649111 -0.63245553  0.0000000  0.6324555  1.2649111
## [8,]  1.0000000  2.00000000  3.0000000  4.0000000  5.0000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 计算每一行的var (方差)</span>
<span class="co"># apply表示对数据（第一个参数）的每一行 (第二个参数赋值为1) 或每一列 (2)操作</span>
<span class="co">#      最后返回一个列表</span>
<span class="kw">apply</span>(a,<span class="dv">1</span>,var)</code></pre></div>
<pre><code>## [1]  1.75783183  0.67671309  0.04341272  0.34912008  2.50000000 22.50000000
## [7]  1.00000000</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 计算每一行的mad (中值绝对偏差)</span>
<span class="co"># 一般认为比方差的鲁棒性更强，更少受异常值的影响，更能反映数据间的差异)</span>
<span class="co"># 函数中的第二个参数 1 表示安行操作</span>
<span class="kw">apply</span>(a,<span class="dv">1</span>,mad)</code></pre></div>
<pre><code>## [1] 1.5837196 0.7893880 0.1599342 0.5559038 1.4826000 4.4478000 0.9376786</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 计算每一列的平均值</span>
<span class="kw">apply</span>(a,<span class="dv">2</span>,mean)</code></pre></div>
<pre><code>## [1] 0.3666001 1.9662649 2.7392806 2.6492202 1.6173297</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 取出中值绝对偏差大于0.5的行</span>
b =<span class="st"> </span>a[<span class="kw">apply</span>(a,<span class="dv">1</span>,mad)&gt;<span class="fl">0.5</span>,]
b</code></pre></div>
<pre><code>##            [,1]        [,2]       [,3]       [,4]       [,5]
## [1,]  0.4701970  1.30801540  1.5384013 -1.5361033 -0.7619350
## [2,]  0.3252833  0.47365445  2.3713540  1.0060894  1.4006389
## [3,] -0.5247986 -0.07757796  0.6268043  0.9895440  0.2518523
## [4,]  1.0000000  2.00000000  3.0000000  4.0000000  5.0000000
## [5,]  2.0000000 10.00000000 11.0000000 13.0000000  4.0000000
## [6,] -1.2649111 -0.63245553  0.0000000  0.6324555  1.2649111</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 输出 1 4 2 3 5</span>
<span class="co"># 解释：原列表第一个元素显示在第一位</span>
<span class="co">#       原列表第四个元素显示在第二位</span>
<span class="co">#       原列表第二个元素显示在第三位</span>
<span class="kw">order</span>(<span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">5</span>))</code></pre></div>
<pre><code>## [1] 1 4 2 3 5</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 产生新的顺序</span>
<span class="co"># </span>
<span class="kw">order</span>(<span class="kw">apply</span>(b,<span class="dv">1</span>,mad), <span class="dt">decreasing=</span>T)</code></pre></div>
<pre><code>## [1] 5 1 4 6 2 3</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 矩阵按照mad的大小降序排列</span>
c =<span class="st"> </span>b[<span class="kw">order</span>(<span class="kw">apply</span>(b,<span class="dv">1</span>,mad), <span class="dt">decreasing=</span>T),]
c</code></pre></div>
<pre><code>##            [,1]        [,2]       [,3]       [,4]       [,5]
## [1,]  2.0000000 10.00000000 11.0000000 13.0000000  4.0000000
## [2,]  0.4701970  1.30801540  1.5384013 -1.5361033 -0.7619350
## [3,]  1.0000000  2.00000000  3.0000000  4.0000000  5.0000000
## [4,] -1.2649111 -0.63245553  0.0000000  0.6324555  1.2649111
## [5,]  0.3252833  0.47365445  2.3713540  1.0060894  1.4006389
## [6,] -0.5247986 -0.07757796  0.6268043  0.9895440  0.2518523</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rownames</span>(c) &lt;-<span class="st"> </span><span class="kw">paste</span>(<span class="st">&#39;Gene&#39;</span>, letters[<span class="dv">1</span>:<span class="kw">nrow</span>(c)], <span class="dt">sep=</span><span class="st">&quot;_&quot;</span>)
<span class="kw">colnames</span>(c) &lt;-<span class="st"> </span><span class="kw">toupper</span>(letters[<span class="dv">1</span>:<span class="kw">ncol</span>(c)])
c</code></pre></div>
<pre><code>##                 A           B          C          D          E
## Gene_a  2.0000000 10.00000000 11.0000000 13.0000000  4.0000000
## Gene_b  0.4701970  1.30801540  1.5384013 -1.5361033 -0.7619350
## Gene_c  1.0000000  2.00000000  3.0000000  4.0000000  5.0000000
## Gene_d -1.2649111 -0.63245553  0.0000000  0.6324555  1.2649111
## Gene_e  0.3252833  0.47365445  2.3713540  1.0060894  1.4006389
## Gene_f -0.5247986 -0.07757796  0.6268043  0.9895440  0.2518523</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 矩阵转置</span>
expr =<span class="st"> </span><span class="kw">t</span>(c)
expr</code></pre></div>
<pre><code>##   Gene_a    Gene_b Gene_c     Gene_d    Gene_e      Gene_f
## A      2  0.470197      1 -1.2649111 0.3252833 -0.52479857
## B     10  1.308015      2 -0.6324555 0.4736544 -0.07757796
## C     11  1.538401      3  0.0000000 2.3713540  0.62680430
## D     13 -1.536103      4  0.6324555 1.0060894  0.98954402
## E      4 -0.761935      5  1.2649111 1.4006389  0.25185230</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 矩阵值的替换</span>
expr2 =<span class="st"> </span>expr
expr2[expr2&lt;<span class="dv">0</span>] =<span class="st"> </span><span class="dv">0</span>
expr2</code></pre></div>
<pre><code>##   Gene_a   Gene_b Gene_c    Gene_d    Gene_e    Gene_f
## A      2 0.470197      1 0.0000000 0.3252833 0.0000000
## B     10 1.308015      2 0.0000000 0.4736544 0.0000000
## C     11 1.538401      3 0.0000000 2.3713540 0.6268043
## D     13 0.000000      4 0.6324555 1.0060894 0.9895440
## E      4 0.000000      5 1.2649111 1.4006389 0.2518523</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 矩阵中只针对某一列替换</span>
<span class="co"># expr2是个矩阵不是数据框，不能使用列名字索引</span>
<span class="co"># expr2[expr2$Gene_b&lt;1, &quot;Gene_b&quot;] &lt;- 1</span></code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># str是一个最为常用、好用的查看变量信息的工具，尤其是对特别复杂的变量，</span>
<span class="co">#    可以看清其层级结构，便于提取数据</span>
<span class="kw">str</span>(expr2)</code></pre></div>
<pre><code>##  num [1:5, 1:6] 2 10 11 13 4 ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : chr [1:5] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; ...
##   ..$ : chr [1:6] &quot;Gene_a&quot; &quot;Gene_b&quot; &quot;Gene_c&quot; &quot;Gene_d&quot; ...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 转换为数据库，再进行相应的操作</span>
expr2 &lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(expr2)
<span class="kw">str</span>(expr2)</code></pre></div>
<pre><code>## &#39;data.frame&#39;:    5 obs. of  6 variables:
##  $ Gene_a: num  2 10 11 13 4
##  $ Gene_b: num  0.47 1.31 1.54 0 0
##  $ Gene_c: num  1 2 3 4 5
##  $ Gene_d: num  0 0 0 0.632 1.265
##  $ Gene_e: num  0.325 0.474 2.371 1.006 1.401
##  $ Gene_f: num  0 0 0.627 0.99 0.252</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">expr2[expr2$Gene_b&lt;<span class="dv">1</span>, <span class="st">&quot;Gene_b&quot;</span>] &lt;-<span class="st"> </span><span class="dv">1</span>
expr2</code></pre></div>
<pre><code>##   Gene_a   Gene_b Gene_c    Gene_d    Gene_e    Gene_f
## A      2 1.000000      1 0.0000000 0.3252833 0.0000000
## B     10 1.308015      2 0.0000000 0.4736544 0.0000000
## C     11 1.538401      3 0.0000000 2.3713540 0.6268043
## D     13 1.000000      4 0.6324555 1.0060894 0.9895440
## E      4 1.000000      5 1.2649111 1.4006389 0.2518523</code></pre>
</div>
<div id="r" class="section level3">
<h3><span class="header-section-number">2.3.5</span> R中矩阵筛选合并</h3>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 读入样品信息</span>
sampleInfo =<span class="st"> &quot;Samp;Group;Genotype</span>
<span class="st">A;Control;WT</span>
<span class="st">B;Control;WT</span>
<span class="st">D;Treatment;Mutant</span>
<span class="st">C;Treatment;Mutant</span>
<span class="st">E;Treatment;WT</span>
<span class="st">F;Treatment;WT&quot;</span>

phenoData =<span class="st"> </span><span class="kw">read.table</span>(<span class="dt">text=</span>sampleInfo,<span class="dt">sep=</span><span class="st">&quot;;&quot;</span>, <span class="dt">header=</span>T, <span class="dt">row.names=</span><span class="dv">1</span>, <span class="dt">quote=</span><span class="st">&quot;&quot;</span>)
phenoData</code></pre></div>
<pre><code>##       Group Genotype
## A   Control       WT
## B   Control       WT
## D Treatment   Mutant
## C Treatment   Mutant
## E Treatment       WT
## F Treatment       WT</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 把样品信息按照基因表达矩阵中的样品信息排序，并只保留有基因表达信息的样品</span>
<span class="co"># ‘%in%’ is a more intuitive interface as a binary operator, which</span>
<span class="co">#     returns a logical vector indicating if there is a match or not for</span>
<span class="co">#     its left operand.</span>
     
phenoData =<span class="st"> </span>phenoData[<span class="kw">rownames</span>(phenoData) %in%<span class="st"> </span><span class="kw">rownames</span>(expr),]
phenoData</code></pre></div>
<pre><code>##       Group Genotype
## A   Control       WT
## B   Control       WT
## D Treatment   Mutant
## C Treatment   Mutant
## E Treatment       WT</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 合并矩阵</span>
<span class="co"># by=0 表示按照行的名字排序</span>
<span class="co"># by=columnname 表示按照共有的某一列排序</span>
<span class="co"># 合并后多出了新的一列Row.names</span>
merge_data =<span class="st"> </span><span class="kw">merge</span>(expr, phenoData, <span class="dt">by=</span><span class="dv">0</span>, <span class="dt">all.x=</span>T)
merge_data</code></pre></div>
<pre><code>##   Row.names Gene_a    Gene_b Gene_c     Gene_d    Gene_e      Gene_f
## 1         A      2  0.470197      1 -1.2649111 0.3252833 -0.52479857
## 2         B     10  1.308015      2 -0.6324555 0.4736544 -0.07757796
## 3         C     11  1.538401      3  0.0000000 2.3713540  0.62680430
## 4         D     13 -1.536103      4  0.6324555 1.0060894  0.98954402
## 5         E      4 -0.761935      5  1.2649111 1.4006389  0.25185230
##       Group Genotype
## 1   Control       WT
## 2   Control       WT
## 3 Treatment   Mutant
## 4 Treatment   Mutant
## 5 Treatment       WT</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">rownames</span>(merge_data) &lt;-<span class="st"> </span>merge_data$Row.names
merge_data</code></pre></div>
<pre><code>##   Row.names Gene_a    Gene_b Gene_c     Gene_d    Gene_e      Gene_f
## A         A      2  0.470197      1 -1.2649111 0.3252833 -0.52479857
## B         B     10  1.308015      2 -0.6324555 0.4736544 -0.07757796
## C         C     11  1.538401      3  0.0000000 2.3713540  0.62680430
## D         D     13 -1.536103      4  0.6324555 1.0060894  0.98954402
## E         E      4 -0.761935      5  1.2649111 1.4006389  0.25185230
##       Group Genotype
## A   Control       WT
## B   Control       WT
## C Treatment   Mutant
## D Treatment   Mutant
## E Treatment       WT</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 去除一列；-1表示去除第一列</span>
merge_data =<span class="st"> </span>merge_data[,-<span class="dv">1</span>]
merge_data</code></pre></div>
<pre><code>##   Gene_a    Gene_b Gene_c     Gene_d    Gene_e      Gene_f     Group
## A      2  0.470197      1 -1.2649111 0.3252833 -0.52479857   Control
## B     10  1.308015      2 -0.6324555 0.4736544 -0.07757796   Control
## C     11  1.538401      3  0.0000000 2.3713540  0.62680430 Treatment
## D     13 -1.536103      4  0.6324555 1.0060894  0.98954402 Treatment
## E      4 -0.761935      5  1.2649111 1.4006389  0.25185230 Treatment
##   Genotype
## A       WT
## B       WT
## C   Mutant
## D   Mutant
## E       WT</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 提取出所有的数值列</span>
merge_data[<span class="kw">sapply</span>(merge_data, is.numeric)]</code></pre></div>
<pre><code>##   Gene_a    Gene_b Gene_c     Gene_d    Gene_e      Gene_f
## A      2  0.470197      1 -1.2649111 0.3252833 -0.52479857
## B     10  1.308015      2 -0.6324555 0.4736544 -0.07757796
## C     11  1.538401      3  0.0000000 2.3713540  0.62680430
## D     13 -1.536103      4  0.6324555 1.0060894  0.98954402
## E      4 -0.761935      5  1.2649111 1.4006389  0.25185230</code></pre>
</div>
<div id="str" class="section level3">
<h3><span class="header-section-number">2.3.6</span> <code>str</code>的应用</h3>
<p><code>str</code>: Compactly display the internal <em>str</em>ucture of an R object, a diagnostic function and an alternative to ‘summary (and to some extent, ’dput’). Ideally, only one line for each ‘basic’ structure is displayed. It is especially well suited to compactly display the (abbreviated) contents of (possibly nested) lists. The idea is to give reasonable output for <em>any</em> R object. It calls ‘args’ for (non-primitive) function objects.</p>
<p><code>str</code>用来告诉结果的构成方式，对于不少Bioconductor的包，或者复杂的R函数的输出，都是一堆列表的嵌套，<code>str(complex_result)</code>会输出每个列表的名字，方便提取对应的信息。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># str的一个应用例子</span>
<span class="kw">str</span>(<span class="kw">list</span>(<span class="dt">a =</span> <span class="st">&quot;A&quot;</span>, <span class="dt">L =</span> <span class="kw">as.list</span>(<span class="dv">1</span>:<span class="dv">100</span>)), <span class="dt">list.len =</span> <span class="dv">9</span>)</code></pre></div>
<pre><code>## List of 2
##  $ a: chr &quot;A&quot;
##  $ L:List of 100
##   ..$ : int 1
##   ..$ : int 2
##   ..$ : int 3
##   ..$ : int 4
##   ..$ : int 5
##   ..$ : int 6
##   ..$ : int 7
##   ..$ : int 8
##   ..$ : int 9
##   .. [list output truncated]</code></pre>
<p>利用<code>str</code>查看<code>pca</code>的结果，具体的<code>PCA</code>应用查看 <a href="http://mp.weixin.qq.com/s/sRElBMkyR9rGa4TQp9KjNQ" class="uri">http://mp.weixin.qq.com/s/sRElBMkyR9rGa4TQp9KjNQ</a>。</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">pca_result &lt;-<span class="st"> </span><span class="kw">prcomp</span>(expr)
pca_result</code></pre></div>
<pre><code>## Standard deviations (1, .., p=5):
## [1] 4.801436e+00 2.095908e+00 1.078861e+00 4.160639e-01 8.096135e-17
## 
## Rotation (n x k) = (6 x 5):
##                PC1        PC2         PC3        PC4         PC5
## Gene_a -0.98629666 -0.1235956  0.07365414 -0.0413082 -0.06881527
## Gene_b  0.01191917 -0.5048044 -0.72046637 -0.4229959  0.21514721
## Gene_c -0.09472357  0.7043835 -0.27954889 -0.3618025  0.07759219
## Gene_d -0.05990844  0.4454912 -0.17680224 -0.2288240 -0.09981627
## Gene_e -0.06627067  0.1208985 -0.60364749  0.7094489 -0.33390100
## Gene_f -0.10061537  0.1437416 -0.04130837  0.3644020  0.90636771</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">str</span>(pca_result)</code></pre></div>
<pre><code>## List of 5
##  $ sdev    : num [1:5] 4.80 2.10 1.08 4.16e-01 8.10e-17
##  $ rotation: num [1:6, 1:5] -0.9863 0.0119 -0.0947 -0.0599 -0.0663 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:6] &quot;Gene_a&quot; &quot;Gene_b&quot; &quot;Gene_c&quot; &quot;Gene_d&quot; ...
##   .. ..$ : chr [1:5] &quot;PC1&quot; &quot;PC2&quot; &quot;PC3&quot; &quot;PC4&quot; ...
##  $ center  : Named num [1:6] 8 0.204 3 0 1.115 ...
##   ..- attr(*, &quot;names&quot;)= chr [1:6] &quot;Gene_a&quot; &quot;Gene_b&quot; &quot;Gene_c&quot; &quot;Gene_d&quot; ...
##  $ scale   : logi FALSE
##  $ x       : num [1:5, 1:5] 6.32 -1.75 -3.06 -5.15 3.65 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:5] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; ...
##   .. ..$ : chr [1:5] &quot;PC1&quot; &quot;PC2&quot; &quot;PC3&quot; &quot;PC4&quot; ...
##  - attr(*, &quot;class&quot;)= chr &quot;prcomp&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># 取出每个主成分解释的差异</span>
pca_result$sdev</code></pre></div>
<pre><code>## [1] 4.801436e+00 2.095908e+00 1.078861e+00 4.160639e-01 8.096135e-17</code></pre>
</div>
<div id="r" class="section level3">
<h3><span class="header-section-number">2.3.7</span> R的包管理</h3>
<p>什么时候需要安装包</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&#39;unExistedPackage&#39;</span>)
Error in <span class="kw">library</span>(<span class="st">&quot;unExistedPackage&quot;</span>) :<span class="st"> </span>
<span class="st">  </span>不存在叫‘unExistedPackage’这个名字的程辑包</code></pre></div>
<p>如何安装R包</p>
<pre><code>install.packages(&quot;package_name&quot;)
# 指定安装来源
install.packages(&quot;package_name&quot;, repo=&quot;http://cran.us.r-project.org&quot;)

# 安装Bioconductor的包
source(&#39;https://bioconductor.org/biocLite.R&#39;)
biocLite(&#39;BiocInstaller&#39;)
biocLite(c(&quot;RUVSeq&quot;,&quot;pcaMethods&quot;))

# 安装Github的R包
install.packages(&quot;devtools&quot;)
devtools::install_github(&quot;JustinaZ/pcaReduce&quot;)

# 手动安装, 首先下载包的源文件（压缩版就可），然后在终端运行下面的命令。
ct@ehbio:~$ R CMD INSTALL package.tar.gz

# 移除包
remove.packages(&quot;package_name&quot;)

# 查看所有安装的包
library()

# 查看特定安装包的版本
installed.packages()[c(&quot;ggplot2&quot;), c(&quot;Package&quot;, &quot;Version&quot;)]

#  Package  Version 
# &quot;DESeq2&quot; &quot;1.14.1&quot; 

# 查看默认安装包的位置
.libPaths()

# 查看已加载的包
.packages()

# 调用安装的包
library(package_name)</code></pre>
<p>自动安装包</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">usePackage &lt;-<span class="st"> </span>function(p) {
    if (!<span class="kw">is.element</span>(p, <span class="kw">installed.packages</span>()[,<span class="dv">1</span>])) {
        <span class="kw">install.packages</span>(p, <span class="dt">dep =</span> <span class="ot">TRUE</span>)
    }
    <span class="kw">require</span>(p, <span class="dt">character.only =</span> <span class="ot">TRUE</span>)
}</code></pre></div>
</div>
</div>
<div id="cheetsheets" class="section level2">
<h2><span class="header-section-number">2.4</span> CheetSheets</h2>
<p><a href="https://www.rstudio.com/resources/cheatsheets/" class="uri">https://www.rstudio.com/resources/cheatsheets/</a></p>
</div>
<div id="section-2.5" class="section level2">
<h2><span class="header-section-number">2.5</span> 参考</h2>
<ul>
<li><a href="http://mp.weixin.qq.com/s/hEYU80fPf1eD5OWL3fO4Bg">生信宝典Linux系列</a></li>
<li><a href="https://mp.weixin.qq.com/s/bsvB1k17Izom2ldgdwXrdg">生信宝典R系列</a></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="questions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="r-plots.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": false,
"twitter": false,
"google": false,
"weibo": false,
"instapper": false,
"vk": false,
"all": ["facebook", "google", "twitter", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"download": ["R_course.pdf"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://cdn.bootcss.com/mathjax/2.7.1/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:" && /^https?:/.test(script.src))
      script.src  = script.src.replace(/^https?:/, '');
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
