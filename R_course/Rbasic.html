<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>2 R基础 | R Cytoscape AI生信作图分析教程</title>
  <meta name="description" content="2 R基础 | R Cytoscape AI生信作图分析教程" />
  <meta name="generator" content="bookdown 0.45 and GitBook 2.6.7" />

  <meta property="og:title" content="2 R基础 | R Cytoscape AI生信作图分析教程" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="2 R基础 | R Cytoscape AI生信作图分析教程" />
  
  
  

<meta name="author" content="生信宝典 陈同" />
<meta name="author" content="chentong_biology@163.com" />


<meta name="date" content="2025-11-01" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="questions.html"/>
<link rel="next" href="Rplots.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="http://www.bic.ac.cn">Hello</a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Hello</a></li>
<li class="chapter" data-level="1" data-path="questions.html"><a href="questions.html"><i class="fa fa-check"></i><b>1</b> 考题</a>
<ul>
<li class="chapter" data-level="1.1" data-path="questions.html"><a href="questions.html#%E7%90%86%E8%AE%BA%E9%A2%98-50%E5%88%86"><i class="fa fa-check"></i><b>1.1</b> 理论题 (50分)</a></li>
<li class="chapter" data-level="1.2" data-path="questions.html"><a href="questions.html#%E4%BB%A3%E7%A0%81%E9%A2%98-70%E5%88%86"><i class="fa fa-check"></i><b>1.2</b> 代码题 (70分)</a></li>
<li class="chapter" data-level="1.3" data-path="questions.html"><a href="questions.html#%E9%94%99%E8%AF%AF%E8%AF%86%E5%88%AB%E9%A2%98-%E9%80%89%E7%AD%94"><i class="fa fa-check"></i><b>1.3</b> 错误识别题 (选答)</a></li>
</ul></li>
<li class="chapter" data-level="2" data-path="Rbasic.html"><a href="Rbasic.html"><i class="fa fa-check"></i><b>2</b> R基础</a>
<ul>
<li class="chapter" data-level="2.1" data-path="Rbasic.html"><a href="Rbasic.html#R_install"><i class="fa fa-check"></i><b>2.1</b> R安装</a></li>
<li class="chapter" data-level="2.2" data-path="Rbasic.html"><a href="Rbasic.html#R_basic"><i class="fa fa-check"></i><b>2.2</b> Rstudio基础</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="Rbasic.html"><a href="Rbasic.html#R_version"><i class="fa fa-check"></i><b>2.2.1</b> Rstudio版本</a></li>
<li class="chapter" data-level="2.2.2" data-path="Rbasic.html"><a href="Rbasic.html#Rstudio_install"><i class="fa fa-check"></i><b>2.2.2</b> Rstudio安装</a></li>
<li class="chapter" data-level="2.2.3" data-path="Rbasic.html"><a href="Rbasic.html#Rstudio_usage"><i class="fa fa-check"></i><b>2.2.3</b> Rstudio 使用</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="Rbasic.html"><a href="Rbasic.html#R_basic_formula"><i class="fa fa-check"></i><b>2.3</b> R基本语法</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="Rbasic.html"><a href="Rbasic.html#R_help"><i class="fa fa-check"></i><b>2.3.1</b> 获取帮助文档，查看命令或函数的使用方法、事例或适用范围</a></li>
<li class="chapter" data-level="2.3.2" data-path="Rbasic.html"><a href="Rbasic.html#R_variable"><i class="fa fa-check"></i><b>2.3.2</b> R中的变量及其初始化</a></li>
<li class="chapter" data-level="2.3.3" data-path="Rbasic.html"><a href="Rbasic.html#vairableType"><i class="fa fa-check"></i><b>2.3.3</b> 变量类型和转换</a></li>
<li class="chapter" data-level="2.3.4" data-path="Rbasic.html"><a href="Rbasic.html#Rmatrix"><i class="fa fa-check"></i><b>2.3.4</b> R中矩阵运算</a></li>
<li class="chapter" data-level="2.3.5" data-path="Rbasic.html"><a href="Rbasic.html#Rmatrixcombine"><i class="fa fa-check"></i><b>2.3.5</b> R中矩阵筛选合并</a></li>
<li class="chapter" data-level="2.3.6" data-path="Rbasic.html"><a href="Rbasic.html#str"><i class="fa fa-check"></i><b>2.3.6</b> <code>str</code>的应用</a></li>
<li class="chapter" data-level="2.3.7" data-path="Rbasic.html"><a href="Rbasic.html#Rpackage"><i class="fa fa-check"></i><b>2.3.7</b> R的包管理</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="Rbasic.html"><a href="Rbasic.html#checkinstalltpackages"><i class="fa fa-check"></i><b>2.4</b> 检查并安装本教程需要的 R 包</a></li>
<li class="chapter" data-level="2.5" data-path="Rbasic.html"><a href="Rbasic.html#ggplot2_plot"><i class="fa fa-check"></i><b>2.5</b> ggplot2绘图</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="Rbasic.html"><a href="Rbasic.html#matrixFormat"><i class="fa fa-check"></i><b>2.5.1</b> 数据格式转换和字符串处理</a></li>
<li class="chapter" data-level="2.5.2" data-path="Rbasic.html"><a href="Rbasic.html#RColorBrewer"><i class="fa fa-check"></i><b>2.5.2</b> 配色</a></li>
<li class="chapter" data-level="2.5.3" data-path="Rbasic.html"><a href="Rbasic.html#phetamap"><i class="fa fa-check"></i><b>2.5.3</b> pheatmap绘制热图</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="Rbasic.html"><a href="Rbasic.html#cheetsheets"><i class="fa fa-check"></i><b>2.6</b> CheetSheets</a></li>
<li class="chapter" data-level="2.7" data-path="Rbasic.html"><a href="Rbasic.html#%E5%8F%82%E8%80%83-ref01"><i class="fa fa-check"></i><b>2.7</b> 参考 {ref01}</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="Rplots.html"><a href="Rplots.html"><i class="fa fa-check"></i><b>3</b> R plots</a>
<ul>
<li class="chapter" data-level="3.1" data-path="Rplots.html"><a href="Rplots.html#plot"><i class="fa fa-check"></i><b>3.1</b> qplot绘制图形 (王绪宁)</a></li>
<li class="chapter" data-level="3.2" data-path="Rplots.html"><a href="Rplots.html#ggplot2_heatmap"><i class="fa fa-check"></i><b>3.2</b> 热图绘制</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="Rplots.html"><a href="Rplots.html#ggplot2_heatmap_data"><i class="fa fa-check"></i><b>3.2.1</b> 生成测试数据</a></li>
<li class="chapter" data-level="3.2.2" data-path="Rplots.html"><a href="Rplots.html#ggplot2_heatmap_dataformat"><i class="fa fa-check"></i><b>3.2.2</b> 转换数据格式</a></li>
<li class="chapter" data-level="3.2.3" data-path="Rplots.html"><a href="Rplots.html#ggplot2_heatmap_split"><i class="fa fa-check"></i><b>3.2.3</b> 分解绘图</a></li>
<li class="chapter" data-level="3.2.4" data-path="Rplots.html"><a href="Rplots.html#ggplot2_heatmapsave"><i class="fa fa-check"></i><b>3.2.4</b> 图形存储</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="Rplots.html"><a href="Rplots.html#ggplot2_heatmapmeihua"><i class="fa fa-check"></i><b>3.3</b> 热图美化</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="Rplots.html"><a href="Rplots.html#ggplot2_heatmap_log"><i class="fa fa-check"></i><b>3.3.1</b> 对数转换</a></li>
<li class="chapter" data-level="3.3.2" data-path="Rplots.html"><a href="Rplots.html#ggplot2_heatmapzscore"><i class="fa fa-check"></i><b>3.3.2</b> Z-score转换</a></li>
<li class="chapter" data-level="3.3.3" data-path="Rplots.html"><a href="Rplots.html#ggplot2_heatmapoutlier"><i class="fa fa-check"></i><b>3.3.3</b> 抹去异常值</a></li>
<li class="chapter" data-level="3.3.4" data-path="Rplots.html"><a href="Rplots.html#ggplot2_heatmapnonlinear"><i class="fa fa-check"></i><b>3.3.4</b> 非线性颜色</a></li>
<li class="chapter" data-level="3.3.5" data-path="Rplots.html"><a href="Rplots.html#ggplot2_heatmaporder"><i class="fa fa-check"></i><b>3.3.5</b> 调整行或列的顺序</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="Rplots.html"><a href="Rplots.html#pheatmap_simple"><i class="fa fa-check"></i><b>3.4</b> 热图绘制 - pheatmap</a></li>
<li class="chapter" data-level="3.5" data-path="Rplots.html"><a href="Rplots.html#pheatmap_branchorder"><i class="fa fa-check"></i><b>3.5</b> 聚类热图如何按自己的意愿调整分支顺序？</a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="Rplots.html"><a href="Rplots.html#pheatmap_branchorderdata"><i class="fa fa-check"></i><b>3.5.1</b> 数据示例</a></li>
<li class="chapter" data-level="3.5.2" data-path="Rplots.html"><a href="Rplots.html#pheatmap_branchorder1"><i class="fa fa-check"></i><b>3.5.2</b> 绘制一个聚类热图很简单</a></li>
<li class="chapter" data-level="3.5.3" data-path="Rplots.html"><a href="Rplots.html#pheatmap_branchorder2"><i class="fa fa-check"></i><b>3.5.3</b> 如何自定义分支顺序呢</a></li>
<li class="chapter" data-level="3.5.4" data-path="Rplots.html"><a href="Rplots.html#pheatmap_branchorder3"><i class="fa fa-check"></i><b>3.5.4</b> 人为指定顺序排序样品</a></li>
<li class="chapter" data-level="3.5.5" data-path="Rplots.html"><a href="Rplots.html#pheatmap_branchorder4"><i class="fa fa-check"></i><b>3.5.5</b> 按某个基因的表达由小到大排序</a></li>
<li class="chapter" data-level="3.5.6" data-path="Rplots.html"><a href="Rplots.html#pheatmap_branchorder5"><i class="fa fa-check"></i><b>3.5.6</b> 按某个基因的表达由大到小排序</a></li>
<li class="chapter" data-level="3.5.7" data-path="Rplots.html"><a href="Rplots.html#pheatmap_branchorder6"><i class="fa fa-check"></i><b>3.5.7</b> 按分支名字（样品名字）的字母顺序排序</a></li>
<li class="chapter" data-level="3.5.8" data-path="Rplots.html"><a href="Rplots.html#pheatmap_branchorder7"><i class="fa fa-check"></i><b>3.5.8</b> 梯子形排序：最小的分支在右侧</a></li>
<li class="chapter" data-level="3.5.9" data-path="Rplots.html"><a href="Rplots.html#pheatmap_branchorder8"><i class="fa fa-check"></i><b>3.5.9</b> 梯子形排序：最小的分支在左侧</a></li>
<li class="chapter" data-level="3.5.10" data-path="Rplots.html"><a href="Rplots.html#pheatmap_branchorder9"><i class="fa fa-check"></i><b>3.5.10</b> 按特征值排序</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="Rplots.html"><a href="Rplots.html#ggplot2boxplot"><i class="fa fa-check"></i><b>3.6</b> 箱线图</a>
<ul>
<li class="chapter" data-level="3.6.1" data-path="Rplots.html"><a href="Rplots.html#ggplot2boxplot1"><i class="fa fa-check"></i><b>3.6.1</b> 一步步解析箱线图绘制</a></li>
<li class="chapter" data-level="3.6.2" data-path="Rplots.html"><a href="Rplots.html#ggplot2boxplot2"><i class="fa fa-check"></i><b>3.6.2</b> 绘制单个基因 (A)的箱线图</a></li>
<li class="chapter" data-level="3.6.3" data-path="Rplots.html"><a href="Rplots.html#ggplot2boxplot3"><i class="fa fa-check"></i><b>3.6.3</b> 长矩阵绘制箱线图</a></li>
</ul></li>
<li class="chapter" data-level="3.7" data-path="Rplots.html"><a href="Rplots.html#ggplot2lineplot"><i class="fa fa-check"></i><b>3.7</b> 线图</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="Rplots.html"><a href="Rplots.html#ggplot2singleline"><i class="fa fa-check"></i><b>3.7.1</b> 单线图</a></li>
<li class="chapter" data-level="3.7.2" data-path="Rplots.html"><a href="Rplots.html#ggplot2multipleline"><i class="fa fa-check"></i><b>3.7.2</b> 多线图</a></li>
<li class="chapter" data-level="3.7.3" data-path="Rplots.html"><a href="Rplots.html#ggplot2xaxistext"><i class="fa fa-check"></i><b>3.7.3</b> 横轴文本线图</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="Rplots.html"><a href="Rplots.html#ggplot2scatter"><i class="fa fa-check"></i><b>3.8</b> 散点图</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="Rplots.html"><a href="Rplots.html#ggplot2scatter1"><i class="fa fa-check"></i><b>3.8.1</b> 横纵轴都为数字的散点图解析</a></li>
<li class="chapter" data-level="3.8.2" data-path="Rplots.html"><a href="Rplots.html#ggplot2scatter3"><i class="fa fa-check"></i><b>3.8.2</b> 横纵轴都为字符串的散点图展示</a></li>
</ul></li>
<li class="chapter" data-level="3.9" data-path="Rplots.html"><a href="Rplots.html#ggplot2enrichment"><i class="fa fa-check"></i><b>3.9</b> 功能富集泡泡图</a>
<ul>
<li class="chapter" data-level="3.9.1" data-path="Rplots.html"><a href="Rplots.html#ggplot2enric2hment"><i class="fa fa-check"></i><b>3.9.1</b> 单样品分开绘制</a></li>
<li class="chapter" data-level="3.9.2" data-path="Rplots.html"><a href="Rplots.html#ggplot2enrichmen2t"><i class="fa fa-check"></i><b>3.9.2</b> 多样品合并绘制</a></li>
</ul></li>
<li class="chapter" data-level="3.10" data-path="Rplots.html"><a href="Rplots.html#venn"><i class="fa fa-check"></i><b>3.10</b> 韦恩图</a>
<ul>
<li class="chapter" data-level="3.10.1" data-path="Rplots.html"><a href="Rplots.html#venn2"><i class="fa fa-check"></i><b>3.10.1</b> 韦恩图三个圈</a></li>
<li class="chapter" data-level="3.10.2" data-path="Rplots.html"><a href="Rplots.html#venn5"><i class="fa fa-check"></i><b>3.10.2</b> 韦恩图五个圈</a></li>
<li class="chapter" data-level="3.10.3" data-path="Rplots.html"><a href="Rplots.html#UpSetView"><i class="fa fa-check"></i><b>3.10.3</b> UpSetView展示</a></li>
</ul></li>
<li class="chapter" data-level="3.11" data-path="Rplots.html"><a href="Rplots.html#Barplot"><i class="fa fa-check"></i><b>3.11</b> 柱状图绘制</a>
<ul>
<li class="chapter" data-level="3.11.1" data-path="Rplots.html"><a href="Rplots.html#Barplot1"><i class="fa fa-check"></i><b>3.11.1</b> 常规矩阵柱状图绘制</a></li>
<li class="chapter" data-level="3.11.2" data-path="Rplots.html"><a href="Rplots.html#Barplot2"><i class="fa fa-check"></i><b>3.11.2</b> 长矩阵分面绘制</a></li>
</ul></li>
<li class="chapter" data-level="3.12" data-path="Rplots.html"><a href="Rplots.html#Barplot3"><i class="fa fa-check"></i><b>3.12</b> 图形支持中文字体</a>
<ul>
<li class="chapter" data-level="3.12.1" data-path="Rplots.html"><a href="Rplots.html#Barplot4"><i class="fa fa-check"></i><b>3.12.1</b> 修改图形的字体</a></li>
<li class="chapter" data-level="3.12.2" data-path="Rplots.html"><a href="Rplots.html#Barplot41"><i class="fa fa-check"></i><b>3.12.2</b> ggplot2支持中文字体输出PDF</a></li>
<li class="chapter" data-level="3.12.3" data-path="Rplots.html"><a href="Rplots.html#Barplot5"><i class="fa fa-check"></i><b>3.12.3</b> 系统可用字体</a></li>
<li class="chapter" data-level="3.12.4" data-path="Rplots.html"><a href="Rplots.html#Barplot6"><i class="fa fa-check"></i><b>3.12.4</b> 合并字体支持中英文</a></li>
<li class="chapter" data-level="3.12.5" data-path="Rplots.html"><a href="Rplots.html#Barplot7"><i class="fa fa-check"></i><b>3.12.5</b> 一个示例</a></li>
</ul></li>
<li class="chapter" data-level="3.13" data-path="Rplots.html"><a href="Rplots.html#pca"><i class="fa fa-check"></i><b>3.13</b> PCA原理解析和图形绘制</a>
<ul>
<li class="chapter" data-level="3.13.1" data-path="Rplots.html"><a href="Rplots.html#pcaintroduc"><i class="fa fa-check"></i><b>3.13.1</b> 主成分分析简介</a></li>
<li class="chapter" data-level="3.13.2" data-path="Rplots.html"><a href="Rplots.html#pcaintroduc1"><i class="fa fa-check"></i><b>3.13.2</b> 主成分分析的意义</a></li>
<li class="chapter" data-level="3.13.3" data-path="Rplots.html"><a href="Rplots.html#pcaintroduc2"><i class="fa fa-check"></i><b>3.13.3</b> 示例展示原始变量对样品的分类</a></li>
<li class="chapter" data-level="3.13.4" data-path="Rplots.html"><a href="Rplots.html#pcaintroduc3"><i class="fa fa-check"></i><b>3.13.4</b> PCA的实现原理</a></li>
<li class="chapter" data-level="3.13.5" data-path="Rplots.html"><a href="Rplots.html#pcaintroduc4"><i class="fa fa-check"></i><b>3.13.5</b> 简单的PCA实现</a></li>
<li class="chapter" data-level="3.13.6" data-path="Rplots.html"><a href="Rplots.html#pcaintroduc5"><i class="fa fa-check"></i><b>3.13.6</b> PCA结果解释</a></li>
<li class="chapter" data-level="3.13.7" data-path="Rplots.html"><a href="Rplots.html#pcaintroduc6"><i class="fa fa-check"></i><b>3.13.7</b> PCA应用于测试数据</a></li>
<li class="chapter" data-level="3.13.8" data-path="Rplots.html"><a href="Rplots.html#pcaintroduc7"><i class="fa fa-check"></i><b>3.13.8</b> PCA注意事项</a></li>
<li class="chapter" data-level="3.13.9" data-path="Rplots.html"><a href="Rplots.html#pcaintroduc8"><i class="fa fa-check"></i><b>3.13.9</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="3.14" data-path="Rplots.html"><a href="Rplots.html#survival"><i class="fa fa-check"></i><b>3.14</b> 生存分析</a>
<ul>
<li class="chapter" data-level="3.14.1" data-path="Rplots.html"><a href="Rplots.html#survival1"><i class="fa fa-check"></i><b>3.14.1</b> R做生存分析</a></li>
</ul></li>
<li class="chapter" data-level="3.15" data-path="Rplots.html"><a href="Rplots.html#survival2"><i class="fa fa-check"></i><b>3.15</b> 一步作图的优势</a></li>
<li class="chapter" data-level="3.16" data-path="Rplots.html"><a href="Rplots.html#survival3365"><i class="fa fa-check"></i><b>3.16</b> 不改脚本的热图绘制</a>
<ul>
<li class="chapter" data-level="3.16.1" data-path="Rplots.html"><a href="Rplots.html#survival3367"><i class="fa fa-check"></i><b>3.16.1</b> 箱线图 - 一步绘制</a></li>
<li class="chapter" data-level="3.16.2" data-path="Rplots.html"><a href="Rplots.html#survival3719"><i class="fa fa-check"></i><b>3.16.2</b> 线图 - 一步绘制</a></li>
<li class="chapter" data-level="3.16.3" data-path="Rplots.html"><a href="Rplots.html#survival4137"><i class="fa fa-check"></i><b>3.16.3</b> 一网打进散点图绘制</a></li>
</ul></li>
<li class="chapter" data-level="3.17" data-path="Rplots.html"><a href="Rplots.html#%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99"><i class="fa fa-check"></i><b>3.17</b> 参考资料</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="cytoscape.html"><a href="cytoscape.html"><i class="fa fa-check"></i><b>4</b> 网络图</a>
<ul>
<li class="chapter" data-level="4.0.1" data-path="cytoscape.html"><a href="cytoscape.html#basic"><i class="fa fa-check"></i><b>4.0.1</b> 基本操作</a></li>
<li class="chapter" data-level="4.0.2" data-path="cytoscape.html"><a href="cytoscape.html#mirna"><i class="fa fa-check"></i><b>4.0.2</b> miRNA-mRNA调控网络</a></li>
<li class="chapter" data-level="4.0.3" data-path="cytoscape.html"><a href="cytoscape.html#layout"><i class="fa fa-check"></i><b>4.0.3</b> 不同的布局的调试和修改</a></li>
<li class="chapter" data-level="4.1" data-path="cytoscape.html"><a href="cytoscape.html#%E5%8F%82%E8%80%83"><i class="fa fa-check"></i><b>4.1</b> 参考</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="AI.html"><a href="AI.html"><i class="fa fa-check"></i><b>5</b> 图形排版</a>
<ul>
<li class="chapter" data-level="5.0.1" data-path="AI.html"><a href="AI.html#%E7%9F%A2%E9%87%8F%E5%9B%BE%E5%92%8C%E6%A0%87%E9%87%8F%E5%9B%BE"><i class="fa fa-check"></i><b>5.0.1</b> 矢量图和标量图</a></li>
<li class="chapter" data-level="5.0.2" data-path="AI.html"><a href="AI.html#%E7%9F%A2%E9%87%8F%E5%9B%BE%E7%9A%84%E5%88%B6%E4%BD%9C"><i class="fa fa-check"></i><b>5.0.2</b> 矢量图的制作</a></li>
<li class="chapter" data-level="5.0.3" data-path="AI.html"><a href="AI.html#%E7%9F%A2%E9%87%8F%E5%9B%BE%E7%BC%96%E8%BE%91%E5%B7%A5%E5%85%B7"><i class="fa fa-check"></i><b>5.0.3</b> 矢量图编辑工具</a></li>
<li class="chapter" data-level="5.0.4" data-path="AI.html"><a href="AI.html#%E4%BD%9C%E5%9B%BE%E5%9F%BA%E6%9C%AC%E5%8E%9F%E5%88%99"><i class="fa fa-check"></i><b>5.0.4</b> 作图基本原则</a></li>
<li class="chapter" data-level="5.0.5" data-path="AI.html"><a href="AI.html#%E4%BD%9C%E5%9B%BE%E4%B8%AD%E7%9A%84%E8%A6%81%E7%82%B9%E6%B3%A8%E6%84%8F"><i class="fa fa-check"></i><b>5.0.5</b> 作图中的要点注意</a></li>
<li class="chapter" data-level="5.0.6" data-path="AI.html"><a href="AI.html#adobe-illustrator%E4%B8%AD%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5%E5%92%8C%E6%93%8D%E4%BD%9C%E6%8F%8F%E8%BF%B0"><i class="fa fa-check"></i><b>5.0.6</b> <code>Adobe Illustrator</code>中的基本概念和操作描述</a></li>
<li class="chapter" data-level="5.0.7" data-path="AI.html"><a href="AI.html#%E8%A7%86%E9%A2%91%E6%95%99%E7%A8%8B"><i class="fa fa-check"></i><b>5.0.7</b> 视频教程</a></li>
<li class="chapter" data-level="5.0.8" data-path="AI.html"><a href="AI.html#%E5%8A%A8%E5%9B%BE%E6%95%99%E7%A8%8B"><i class="fa fa-check"></i><b>5.0.8</b> 动图教程</a></li>
<li class="chapter" data-level="5.1" data-path="AI.html"><a href="AI.html#%E5%8F%82%E8%80%83-1"><i class="fa fa-check"></i><b>5.1</b> 参考</a></li>
</ul></li>
<li class="chapter" data-level="6" data-path="batch.html"><a href="batch.html"><i class="fa fa-check"></i><b>6</b> 高通量数据中批次效应的鉴定和处理</a>
<ul>
<li class="chapter" data-level="6.1" data-path="batch.html"><a href="batch.html#batch1"><i class="fa fa-check"></i><b>6.1</b> 什么是批次效应？</a></li>
<li class="chapter" data-level="6.2" data-path="batch.html"><a href="batch.html#batch2"><i class="fa fa-check"></i><b>6.2</b> 批次效应会有什么影响？</a></li>
<li class="chapter" data-level="6.3" data-path="batch.html"><a href="batch.html#batch3"><i class="fa fa-check"></i><b>6.3</b> 怎么确认数据有无受到批次效应影响</a></li>
<li class="chapter" data-level="6.4" data-path="batch.html"><a href="batch.html#batch4"><i class="fa fa-check"></i><b>6.4</b> 怎么避免批次效应呢？</a></li>
<li class="chapter" data-level="6.5" data-path="batch.html"><a href="batch.html#batch5"><i class="fa fa-check"></i><b>6.5</b> 如何在差异基因鉴定过程中移除批次效应</a></li>
<li class="chapter" data-level="6.6" data-path="batch.html"><a href="batch.html#%E6%A3%80%E6%9F%A5%E6%9C%89%E6%97%A0%E7%BC%BA%E5%A4%B1%E7%9A%84%E5%8C%85%E5%B9%B6%E5%AE%89%E8%A3%85%E5%8A%A0%E8%BD%BD%E6%89%80%E6%9C%89%E5%8C%85"><i class="fa fa-check"></i><b>6.6</b> 检查有无缺失的包并安装，加载所有包</a></li>
<li class="chapter" data-level="6.7" data-path="batch.html"><a href="batch.html#batch6"><i class="fa fa-check"></i><b>6.7</b> 不考虑批次因素直接进行差异基因分析</a></li>
<li class="chapter" data-level="6.8" data-path="batch.html"><a href="batch.html#batch7"><i class="fa fa-check"></i><b>6.8</b> 考虑已知的批次因素进行差异基因分析</a>
<ul>
<li class="chapter" data-level="6.8.1" data-path="batch.html"><a href="batch.html#batch8"><i class="fa fa-check"></i><b>6.8.1</b> 比较批次校正前后差异基因变化</a></li>
</ul></li>
<li class="chapter" data-level="6.9" data-path="batch.html"><a href="batch.html#batch9"><i class="fa fa-check"></i><b>6.9</b> 批次效应未知时如何判断和在差异基因鉴定过程中移除批次效应</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="batch.html"><a href="batch.html#batch10"><i class="fa fa-check"></i><b>6.9.1</b> 预测混杂因素(cofounding factors)并在差异基因分析中移除这些因素</a></li>
<li class="chapter" data-level="6.9.2" data-path="batch.html"><a href="batch.html#batch11"><i class="fa fa-check"></i><b>6.9.2</b> 预测可能存在的混杂因素</a></li>
<li class="chapter" data-level="6.9.3" data-path="batch.html"><a href="batch.html#%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B1%95%E7%A4%BA%E9%A2%84%E6%B5%8B%E5%87%BA%E7%9A%84surrogate-variable%E5%B1%9E%E6%80%A7%E4%B8%8E%E5%B7%B2%E7%9F%A5%E7%9A%84%E6%89%B9%E6%AC%A1%E4%BF%A1%E6%81%AF%E7%9A%84%E5%85%B3%E7%B3%BB"><i class="fa fa-check"></i><b>6.9.3</b> 可视化展示预测出的<code>Surrogate variable</code>属性与已知的批次信息的关系</a></li>
<li class="chapter" data-level="6.9.4" data-path="batch.html"><a href="batch.html#%E5%9F%BA%E4%BA%8E%E9%A2%84%E6%B5%8B%E5%87%BA%E7%9A%84%E6%B7%B7%E6%9D%82%E5%9B%A0%E7%B4%A0%E5%86%8D%E6%AC%A1%E8%BF%9B%E8%A1%8C%E5%B7%AE%E5%BC%82%E5%88%86%E6%9E%90"><i class="fa fa-check"></i><b>6.9.4</b> 基于预测出的混杂因素再次进行差异分析</a></li>
<li class="chapter" data-level="6.9.5" data-path="batch.html"><a href="batch.html#batch12"><i class="fa fa-check"></i><b>6.9.5</b> 比较批次校正前、已知批次校正后和预测的批次校正后差异基因变化</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="batch.html"><a href="batch.html#batch13"><i class="fa fa-check"></i><b>6.10</b> 直接校正表达矩阵</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="batch.html"><a href="batch.html#%E8%AF%BB%E5%85%A5%E6%A0%87%E5%87%86%E5%8C%96%E5%90%8E%E7%9A%84%E8%A1%A8%E8%BE%BE%E7%9F%A9%E9%98%B5%E5%92%8C%E6%A0%B7%E5%93%81%E4%BF%A1%E6%81%AF%E8%A1%A8"><i class="fa fa-check"></i><b>6.10.1</b> 读入标准化后的表达矩阵和样品信息表</a></li>
<li class="chapter" data-level="6.10.2" data-path="batch.html"><a href="batch.html#batch14"><i class="fa fa-check"></i><b>6.10.2</b> 使用ComBat校正</a></li>
<li class="chapter" data-level="6.10.3" data-path="batch.html"><a href="batch.html#batch15"><i class="fa fa-check"></i><b>6.10.3</b> 使用limma校正</a></li>
<li class="chapter" data-level="6.10.4" data-path="batch.html"><a href="batch.html#%E6%9F%A5%E7%9C%8B%E6%A0%A1%E6%AD%A3%E5%AE%8C%E5%90%8E%E5%9F%BA%E5%9B%A0%E7%9A%84%E8%A1%A8%E8%BE%BE%E6%83%85%E5%86%B5"><i class="fa fa-check"></i><b>6.10.4</b> 查看校正完后基因的表达情况</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="7" data-path="questions06.html"><a href="questions06.html"><i class="fa fa-check"></i><b>7</b> 问题答疑</a>
<ul>
<li class="chapter" data-level="7.1" data-path="questions06.html"><a href="questions06.html#ggplot2_variable_color_saturation"><i class="fa fa-check"></i><b>7.1</b> ggplot2绘图如何根据一个变量即区分颜色又区分深浅？</a></li>
<li class="chapter" data-level="7.2" data-path="questions06.html"><a href="questions06.html#ggplot2%E7%BB%98%E5%9B%BE%E7%82%B9%E7%9A%84%E5%BD%A2%E7%8A%B6%E4%B8%8D%E5%A4%9F%E7%94%A8%E6%80%8E%E4%B9%88%E5%8A%9E"><i class="fa fa-check"></i><b>7.2</b> ggplot2绘图点的形状不够用怎么办？</a></li>
</ul></li>
<li class="chapter" data-level="8" data-path="推荐一个-r-中很好用的条件判断语句.html"><a href="推荐一个-r-中很好用的条件判断语句.html"><i class="fa fa-check"></i><b>8</b> 推荐一个 R 中很好用的条件判断语句</a>
<ul>
<li class="chapter" data-level="8.1" data-path="推荐一个-r-中很好用的条件判断语句.html"><a href="推荐一个-r-中很好用的条件判断语句.html#ifelse-%E6%A0%87%E8%AE%B0%E5%B7%AE%E5%BC%82%E5%9F%BA%E5%9B%A0"><i class="fa fa-check"></i><b>8.1</b> ifelse 标记差异基因</a></li>
<li class="chapter" data-level="8.2" data-path="推荐一个-r-中很好用的条件判断语句.html"><a href="推荐一个-r-中很好用的条件判断语句.html#dplyrcase-when-%E6%A0%87%E8%AE%B0%E5%B7%AE%E5%BC%82%E5%9F%BA%E5%9B%A0"><i class="fa fa-check"></i><b>8.2</b> dplyr::case-when 标记差异基因</a></li>
<li class="chapter" data-level="8.3" data-path="推荐一个-r-中很好用的条件判断语句.html"><a href="推荐一个-r-中很好用的条件判断语句.html#dplyrif_else-%E4%BC%9A%E6%9B%B4%E5%BF%AB%E4%B8%80%E7%82%B9"><i class="fa fa-check"></i><b>8.3</b> dplyr::if_else 会更快一点</a></li>
<li class="chapter" data-level="8.4" data-path="推荐一个-r-中很好用的条件判断语句.html"><a href="推荐一个-r-中很好用的条件判断语句.html#case-when%E5%8F%AA%E4%BF%9D%E7%95%99%E5%B7%AE%E5%BC%82%E5%9F%BA%E5%9B%A0%E7%9A%84%E5%90%8D%E5%AD%97"><i class="fa fa-check"></i><b>8.4</b> case-when只保留差异基因的名字</a></li>
<li class="chapter" data-level="8.5" data-path="推荐一个-r-中很好用的条件判断语句.html"><a href="推荐一个-r-中很好用的条件判断语句.html#case-when%E6%AF%8F%E9%9A%94-1-%E4%B8%AA%E5%9F%BA%E5%9B%A0%E4%BF%9D%E7%95%99-1-%E4%B8%AA"><i class="fa fa-check"></i><b>8.5</b> case-when每隔 1 个基因保留 1 个</a></li>
<li class="chapter" data-level="8.6" data-path="推荐一个-r-中很好用的条件判断语句.html"><a href="推荐一个-r-中很好用的条件判断语句.html#dplyrif_else%E9%80%9F%E5%BA%A6%E6%9C%80%E5%BF%AB"><i class="fa fa-check"></i><b>8.6</b> <code>dplyr::if_else</code>速度最快！</a></li>
</ul></li>
<li class="chapter" data-level="9" data-path="visual1.html"><a href="visual1.html"><i class="fa fa-check"></i><b>9</b> 易生信-数据可视化</a>
<ul>
<li class="chapter" data-level="9.1" data-path="visual1.html"><a href="visual1.html#visual2"><i class="fa fa-check"></i><b>9.1</b> 加载需要的包</a></li>
<li class="chapter" data-level="9.2" data-path="visual1.html"><a href="visual1.html#visual3"><i class="fa fa-check"></i><b>9.2</b> 读入数据</a>
<ul>
<li class="chapter" data-level="9.2.1" data-path="visual1.html"><a href="visual1.html#visual4"><i class="fa fa-check"></i><b>9.2.1</b> Duplicate row names</a></li>
<li class="chapter" data-level="9.2.2" data-path="visual1.html"><a href="visual1.html#visual15"><i class="fa fa-check"></i><b>9.2.2</b> 行名唯一化处理</a></li>
</ul></li>
<li class="chapter" data-level="9.3" data-path="visual1.html"><a href="visual1.html#visual5"><i class="fa fa-check"></i><b>9.3</b> 热图绘制</a></li>
<li class="chapter" data-level="9.4" data-path="visual1.html"><a href="visual1.html#visual7"><i class="fa fa-check"></i><b>9.4</b> 箱线图和统计比较</a>
<ul>
<li class="chapter" data-level="9.4.1" data-path="visual1.html"><a href="visual1.html#visual8"><i class="fa fa-check"></i><b>9.4.1</b> 单基因箱线图</a></li>
<li class="chapter" data-level="9.4.2" data-path="visual1.html"><a href="visual1.html#visual9"><i class="fa fa-check"></i><b>9.4.2</b> 多基因箱线图 (combine)</a></li>
<li class="chapter" data-level="9.4.3" data-path="visual1.html"><a href="visual1.html#visual10"><i class="fa fa-check"></i><b>9.4.3</b> 多基因箱线图 (merge)</a></li>
<li class="chapter" data-level="9.4.4" data-path="visual1.html"><a href="visual1.html#visual11"><i class="fa fa-check"></i><b>9.4.4</b> 数据对数转换后绘制箱线图</a></li>
<li class="chapter" data-level="9.4.5" data-path="visual1.html"><a href="visual1.html#visual12"><i class="fa fa-check"></i><b>9.4.5</b> 用ggplot2实现ggpubr</a></li>
<li class="chapter" data-level="9.4.6" data-path="visual1.html"><a href="visual1.html#visual13"><i class="fa fa-check"></i><b>9.4.6</b> 配色</a></li>
<li class="chapter" data-level="9.4.7" data-path="visual1.html"><a href="visual1.html#visual14"><i class="fa fa-check"></i><b>9.4.7</b> 箱线图加统计分析</a></li>
</ul></li>
<li class="chapter" data-level="9.5" data-path="visual1.html"><a href="visual1.html#visual151"><i class="fa fa-check"></i><b>9.5</b> 通路内基因的比较</a>
<ul>
<li class="chapter" data-level="9.5.1" data-path="visual1.html"><a href="visual1.html#visual161"><i class="fa fa-check"></i><b>9.5.1</b> 密度图</a></li>
</ul></li>
<li class="chapter" data-level="9.6" data-path="visual1.html"><a href="visual1.html#visual171"><i class="fa fa-check"></i><b>9.6</b> ggstatsplot绘图和统计分析</a>
<ul>
<li class="chapter" data-level="9.6.1" data-path="visual1.html"><a href="visual1.html#visual162"><i class="fa fa-check"></i><b>9.6.1</b> 散点图</a></li>
<li class="chapter" data-level="9.6.2" data-path="visual1.html"><a href="visual1.html#visual172"><i class="fa fa-check"></i><b>9.6.2</b> 相关性图</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="10" data-path="imageGP.html"><a href="imageGP.html"><i class="fa fa-check"></i><b>10</b> 高颜值免费在线绘图（提供绘图源码）</a>
<ul>
<li class="chapter" data-level="10.1" data-path="imageGP.html"><a href="imageGP.html#imagegpbasic"><i class="fa fa-check"></i><b>10.1</b> 高颜值免费在线绘图基础版视频</a></li>
<li class="chapter" data-level="10.2" data-path="imageGP.html"><a href="imageGP.html#imagepbetter"><i class="fa fa-check"></i><b>10.2</b> 高颜值免费在线绘图进阶版视频</a></li>
</ul></li>
<li class="chapter" data-level="11" data-path="ref.html"><a href="ref.html"><i class="fa fa-check"></i><b>11</b> 参考</a>
<ul>
<li class="chapter" data-level="11.1" data-path="ref.html"><a href="ref.html#illumina%E6%B5%8B%E5%BA%8F%E5%BA%94%E7%94%A8%E6%89%8B%E5%86%8C"><i class="fa fa-check"></i><b>11.1</b> Illumina测序应用手册</a></li>
<li class="chapter" data-level="11.2" data-path="ref.html"><a href="ref.html#%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B"><i class="fa fa-check"></i><b>11.2</b> 系列教程</a></li>
<li class="chapter" data-level="11.3" data-path="ref.html"><a href="ref.html#%E8%9B%8B%E7%99%BD%E8%B4%A8%E7%BB%84%E5%AD%A6%E7%A0%94%E7%A9%B6"><i class="fa fa-check"></i><b>11.3</b> 蛋白质组学研究</a></li>
<li class="chapter" data-level="11.4" data-path="ref.html"><a href="ref.html#%E8%BD%AC%E5%BD%95%E7%BB%84%E7%A0%94%E7%A9%B6"><i class="fa fa-check"></i><b>11.4</b> 转录组研究</a></li>
<li class="chapter" data-level="11.5" data-path="ref.html"><a href="ref.html#%E5%8D%95%E7%BB%86%E8%83%9E%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B"><i class="fa fa-check"></i><b>11.5</b> 单细胞系列教程</a>
<ul>
<li class="chapter" data-level="11.5.1" data-path="ref.html"><a href="ref.html#%E7%BB%8F%E5%85%B8%E7%BB%BC%E8%BF%B0"><i class="fa fa-check"></i><b>11.5.1</b> 经典综述</a></li>
<li class="chapter" data-level="11.5.2" data-path="ref.html"><a href="ref.html#%E6%96%87%E7%AB%A0%E8%A7%A3%E8%AF%BB"><i class="fa fa-check"></i><b>11.5.2</b> 文章解读</a></li>
<li class="chapter" data-level="11.5.3" data-path="ref.html"><a href="ref.html#%E7%B3%BB%E5%88%97%E6%95%99%E7%A8%8B-1"><i class="fa fa-check"></i><b>11.5.3</b> 系列教程</a></li>
<li class="chapter" data-level="11.5.4" data-path="ref.html"><a href="ref.html#%E7%89%B9%E8%89%B2%E5%88%86%E6%9E%90"><i class="fa fa-check"></i><b>11.5.4</b> 特色分析</a></li>
</ul></li>
<li class="chapter" data-level="11.6" data-path="ref.html"><a href="ref.html#geotcga%E6%95%B0%E6%8D%AE"><i class="fa fa-check"></i><b>11.6</b> GEO/TCGA数据</a></li>
<li class="chapter" data-level="11.7" data-path="ref.html"><a href="ref.html#%E6%89%A9%E5%A2%9E%E5%AD%90%E4%B8%89%E6%AD%A5%E6%9B%B2"><i class="fa fa-check"></i><b>11.7</b> 扩增子三步曲</a></li>
<li class="chapter" data-level="11.8" data-path="ref.html"><a href="ref.html#%E5%AE%8F%E5%9F%BA%E5%9B%A0%E7%BB%84%E6%95%99%E7%A8%8B"><i class="fa fa-check"></i><b>11.8</b> 宏基因组教程</a></li>
<li class="chapter" data-level="11.9" data-path="ref.html"><a href="ref.html#%E5%AE%8F%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%88%86%E6%9E%90%E4%B8%93%E9%A2%98"><i class="fa fa-check"></i><b>11.9</b> 宏基因组分析专题</a></li>
<li class="chapter" data-level="11.10" data-path="ref.html"><a href="ref.html#chip-seq%E4%B8%93%E9%A2%98"><i class="fa fa-check"></i><b>11.10</b> ChIP-seq专题</a></li>
<li class="chapter" data-level="11.11" data-path="ref.html"><a href="ref.html#linux-%E5%85%A8%E4%BB%8B%E7%BB%8D"><i class="fa fa-check"></i><b>11.11</b> Linux 全介绍</a></li>
<li class="chapter" data-level="11.12" data-path="ref.html"><a href="ref.html#circos%E7%B3%BB%E5%88%97"><i class="fa fa-check"></i><b>11.12</b> CIRCOS系列</a></li>
<li class="chapter" data-level="11.13" data-path="ref.html"><a href="ref.html#r%E7%BB%9F%E8%AE%A1%E5%92%8C%E4%BD%9C%E5%9B%BE"><i class="fa fa-check"></i><b>11.13</b> R统计和作图</a></li>
<li class="chapter" data-level="11.14" data-path="ref.html"><a href="ref.html#ngs%E5%9F%BA%E7%A1%80%E5%92%8C%E8%BD%AF%E4%BB%B6%E5%BA%94%E7%94%A8"><i class="fa fa-check"></i><b>11.14</b> NGS基础和软件应用</a></li>
<li class="chapter" data-level="11.15" data-path="ref.html"><a href="ref.html#%E7%94%9F%E4%BF%A1%E5%AE%9D%E5%85%B8%E4%B9%8B%E5%82%BB%E7%93%9C%E5%BC%8F"><i class="fa fa-check"></i><b>11.15</b> 生信宝典之傻瓜式</a></li>
<li class="chapter" data-level="11.16" data-path="ref.html"><a href="ref.html#python"><i class="fa fa-check"></i><b>11.16</b> Python</a></li>
<li class="chapter" data-level="11.17" data-path="ref.html"><a href="ref.html#cytoscape%E7%BD%91%E7%BB%9C%E5%9B%BE"><i class="fa fa-check"></i><b>11.17</b> Cytoscape网络图</a></li>
<li class="chapter" data-level="11.18" data-path="ref.html"><a href="ref.html#%E5%88%86%E5%AD%90%E5%AF%B9%E6%8E%A5"><i class="fa fa-check"></i><b>11.18</b> 分子对接</a></li>
<li class="chapter" data-level="11.19" data-path="ref.html"><a href="ref.html#%E6%96%87%E7%8C%AE%E7%B2%BE%E8%AF%BB"><i class="fa fa-check"></i><b>11.19</b> 文献精读</a></li>
<li class="chapter" data-level="11.20" data-path="ref.html"><a href="ref.html#%E7%9A%84%E9%AB%98%E9%98%85%E8%AF%BB%E6%96%87%E7%AB%A0%E5%90%88%E9%9B%86"><i class="fa fa-check"></i><b>11.20</b> 2019的高阅读文章合集</a></li>
<li class="chapter" data-level="11.21" data-path="ref.html"><a href="ref.html#%E7%B2%BE%E9%80%89%E6%96%87%E7%AB%A0%E6%8E%A8%E8%8D%90"><i class="fa fa-check"></i><b>11.21</b> 精选文章推荐</a></li>
<li class="chapter" data-level="11.22" data-path="ref.html"><a href="ref.html#%E7%A7%91%E7%A0%94%E7%BB%8F%E9%AA%8C"><i class="fa fa-check"></i><b>11.22</b> 科研经验</a></li>
<li class="chapter" data-level="11.23" data-path="ref.html"><a href="ref.html#%E8%BD%AF%E4%BB%B6%E5%92%8C%E6%95%B0%E6%8D%AE%E5%BA%93"><i class="fa fa-check"></i><b>11.23</b> 软件和数据库</a></li>
<li class="chapter" data-level="11.24" data-path="ref.html"><a href="ref.html#%E6%89%A9%E5%A2%9E%E5%AD%90%E5%88%86%E6%9E%90"><i class="fa fa-check"></i><b>11.24</b> 扩增子分析</a></li>
<li class="chapter" data-level="11.25" data-path="ref.html"><a href="ref.html#%E5%AE%8F%E5%9F%BA%E5%9B%A0%E7%BB%84%E5%88%86%E6%9E%90"><i class="fa fa-check"></i><b>11.25</b> 宏基因组分析</a></li>
<li class="chapter" data-level="11.26" data-path="ref.html"><a href="ref.html#%E5%AE%9E%E9%AA%8C%E8%AE%BE%E8%AE%A1%E4%B8%8E%E6%8A%80%E6%9C%AF"><i class="fa fa-check"></i><b>11.26</b> 实验设计与技术</a></li>
<li class="chapter" data-level="11.27" data-path="ref.html"><a href="ref.html#%E6%96%87%E7%8C%AE%E7%B2%BE%E8%AF%BB-1"><i class="fa fa-check"></i><b>11.27</b> 文献精读</a></li>
<li class="chapter" data-level="11.28" data-path="ref.html"><a href="ref.html#%E7%A7%91%E6%99%AE%E8%A7%86%E9%A2%91%E5%AF%93%E6%95%99%E4%BA%8E%E4%B9%90"><i class="fa fa-check"></i><b>11.28</b> 科普视频*寓教于乐</a></li>
<li class="chapter" data-level="11.29" data-path="ref.html"><a href="ref.html#%E7%B3%BB%E5%88%97%E5%AE%A3%E4%BC%A0"><i class="fa fa-check"></i><b>11.29</b> 系列宣传</a></li>
<li class="chapter" data-level="11.30" data-path="ref.html"><a href="ref.html#%E6%B0%B8%E4%B9%85%E9%93%BE%E6%8E%A5"><i class="fa fa-check"></i><b>11.30</b> 永久链接</a></li>
</ul></li>
<li class="divider"></li>
<li><a href="http://www.bic.ac.cn">Hello</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">R Cytoscape AI生信作图分析教程</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="Rbasic" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">2</span> R基础<a href="Rbasic.html#Rbasic" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>R语言是比较常用的统计分析和绘图语言，拥有强大的统计库、绘图库和生信分析的Bioconductor库，是学习生物信息分析的必备语言之一。</p>
<div id="R_install" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> R安装<a href="Rbasic.html#R_install" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><strong>Linux下安装</strong></p>
<p>如果使用的是新版的操作系统。直接可以用<code>sudo apt-get install r-base</code> 或者<code>yum install r-base</code>来安装。</p>
<p>若系统版本老，或没有根用户权限，则需要下载编译源码安装，最新地址为<a href="https://cran.r-project.org/src/base/R-latest.tar.gz" class="uri">https://cran.r-project.org/src/base/R-latest.tar.gz</a>。</p>
<p>具体编译方式为 (Linux下软件安装见 <a href="http://blog.genesino.com/2016/06/bash1" class="uri">http://blog.genesino.com/2016/06/bash1</a>):</p>
<pre><code># configure是收集系统信息，生成Makefile的过程
# --enable-R-shlib 需要设置，使得其他程序包括Rstudio可以使用R的动态库
# --prefix指定软件安装目录，需使用绝对路径
./configure --prefix=/home/ysx/R/4.0.2 --enable-R-shlib

# 也可以使用这个命令，共享系统的blas库，提高运输速度
#./configure --prefix=/home/ysx/R/4.0.2 --enable-R-shlib --with-blas --with-lapack

# make是编译的过程
make

# 安装到指定目录的过程
make install</code></pre>
<p>安装完成之后，在Linux终端输入<code>R</code>即可启动交互式运行界面，<code>ctrl+d</code>退出<code>R</code>运行界面。若提示<code>找不到命令</code>，需要判断有没有加入进环境变量。</p>
<p><strong>Windows下安装</strong></p>
<p>下载 <a href="https://cran.r-project.org/bin/windows/" class="uri">https://cran.r-project.org/bin/windows/</a>双击就可以了。</p>
<p>两者都需要考虑环境变量，若有问题，见文后的参考。</p>
</div>
<div id="R_basic" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Rstudio基础<a href="Rbasic.html#R_basic" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Rstudio是编辑、运行R语言的最为理想的工具之一，支持纯R脚本、Rmarkdown (脚本文档混排)、Bookdown (脚本文档混排成书)、Shiny (交互式网络应用)等。</p>
<div id="R_version" class="section level3 hasAnchor" number="2.2.1">
<h3><span class="header-section-number">2.2.1</span> Rstudio版本<a href="Rbasic.html#R_version" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Rsdutio分为桌面版和服务器版，桌面版可以在单机使用，服务器版可以从浏览器访问供多人使用。</p>
<p>服务器版安装好之后，访问地址为<服务器IP:8787> (8787为默认端口号)，用户名和密码为Linux用户的用户名和密码。</p>
<p><img src="images/Rstudio_version.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="Rstudio_install" class="section level3 hasAnchor" number="2.2.2">
<h3><span class="header-section-number">2.2.2</span> Rstudio安装<a href="Rbasic.html#Rstudio_install" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><strong>Linux下安装服务器版</strong></p>
<p>安装参考 <a href="https://www.rstudio.com/products/rstudio/download-server/" class="uri">https://www.rstudio.com/products/rstudio/download-server/</a></p>
<pre><code># 自己根据自己安装时间自己去获取最新软件的下载地址
wget -c https://download2.rstudio.org/server/centos6/x86_64/rstudio-server-rhel-1.3.1073-x86_64.rpm
sudo yum install --nogpgcheck rstudio-server-rhel-1.3.1073-x86_64.rpm</code></pre>
<p>安装完之后的检测、启动和配置</p>
<pre><code>sudo rstudio-server verify-installation #查看是否安装正确
sudo rstudio-server start ## 启动
sudo rstudio-server status ## 查看状态
sudo rstudio-server stop ## 停止
ifconfig | grep &#39;inet addr&#39; ## 查看服务端ip地址
sudo rstudio-server start ## 修改配置文件后重启
sudo rstudio-server active-sessions ## 列出活跃的sessions:
sudo rstudio-server suspend-session &lt;pid&gt; ## 暂停session
sudo rstudio-server suspend-all ##暂停所有session</code></pre>
<ul>
<li>如果启动失败，进入Rstudio日志目录查看错误信息：<code>/var/log/rstudio-server/</code></li>
<li>Rstudio的其它配置可在配置文件修改：
<ul>
<li>/etc/rstudio/rserver.conf</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode bash"><code class="sourceCode bash"><span id="cb10-1"><a href="Rbasic.html#cb10-1" tabindex="-1"></a><span class="ex">www-port=8787</span> <span class="er">(</span><span class="ex">default</span><span class="kw">)</span></span>
<span id="cb10-2"><a href="Rbasic.html#cb10-2" tabindex="-1"></a><span class="ex">www-address=0.0.0.0</span> <span class="er">(</span><span class="ex">default</span><span class="kw">)</span></span>
<span id="cb10-3"><a href="Rbasic.html#cb10-3" tabindex="-1"></a><span class="ex">rsession-ld-library-path=/opt/local/lib:/opt/local/someapp/lib</span></span>
<span id="cb10-4"><a href="Rbasic.html#cb10-4" tabindex="-1"></a><span class="ex">rsession-which-r=/usr/local/bin/R</span></span></code></pre></div>
<ul>
<li>/etc/rstudio/rsession.conf
<ul>
<li>Timeout</li>
</ul></li>
</ul>
<pre><code>[user]
session-timeout-minutes=30
[@powerusers]
session-timeout-minutes=0</code></pre>
<p>配置好并且<code>rstudio-server</code>成功启动后，就可以在火狐或谷歌浏览器中输入<code>IP地址:端口号</code>，比如<code>127.123,34.29:8787</code>进行访问了。</p>
<p>如果该网址不能打开，一般有2个原因：</p>
<ol style="list-style-type: decimal">
<li><p>安装<code>rstudio-server</code>的服务器是内网IP，不可以在外网访问，只能被连接到同一台路由器的电脑访问。这时需要配置外网IP或百度查找下其它IP穿透方式的设置。</p></li>
<li><p>确定自己的服务器没有被防火墙限制端口，一般在学校或科研单位会设置防火墙屏蔽大部分端口，这时联系网络管理员开通相应的端口即可。</p></li>
</ol>
<p><strong>Windows下安装桌面版</strong></p>
<p>下载之后 (<a href="https://www.rstudio.com/products/rstudio/download2/" class="uri">https://www.rstudio.com/products/rstudio/download2/</a>)双击安装 (若windows登录名为中文，需要使用<strong>管理员权限</strong>)，其它无需要注意的。</p>
</div>
<div id="Rstudio_usage" class="section level3 hasAnchor" number="2.2.3">
<h3><span class="header-section-number">2.2.3</span> Rstudio 使用<a href="Rbasic.html#Rstudio_usage" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Windows下桌面版直接双击打开即可使用，Linux服务器版访问地址为<strong>服务器IP:8787</strong>，用户名和密码为Linux用户的用户名和密码。</p>
<div id="Rstudio_gui" class="section level4 hasAnchor" number="2.2.3.1">
<h4><span class="header-section-number">2.2.3.1</span> Rstudio 界面<a href="Rbasic.html#Rstudio_gui" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p><img src="images/Rstudio_IDE.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="Rstudio_new_file" class="section level4 hasAnchor" number="2.2.3.2">
<h4><span class="header-section-number">2.2.3.2</span> Rstudio中新建或打开文件<a href="Rbasic.html#Rstudio_new_file" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>如果是桌面版，直接就可以访问”我的电脑”去打开之前写过的脚本。如果是服务器版，可直接访问服务器上写过的脚本。Rstudio右下1/4部分可以切换目录，点击more，设置工作目录。可以上传本地的脚本到对应目录打开。</p>
<p><img src="images/Rstudio.gif" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
</div>
<div id="R_basic_formula" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> R基本语法<a href="Rbasic.html#R_basic_formula" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="Rbasic.html#cb12-1" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">include_graphics</span>(<span class="st">&quot;images/R_basic.jpg&quot;</span>)</span></code></pre></div>
<p><img src="images/R_basic.jpg" width="100%" style="display: block; margin: auto;" /></p>
<div id="R_help" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> 获取帮助文档，查看命令或函数的使用方法、事例或适用范围<a href="Rbasic.html#R_help" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="Rbasic.html#cb13-1" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;&gt;</span> ?command</span>
<span id="cb13-2"><a href="Rbasic.html#cb13-2" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;&gt;</span> ??command <span class="co">#深度搜索或模糊搜索此命令</span></span>
<span id="cb13-3"><a href="Rbasic.html#cb13-3" tabindex="-1"></a></span>
<span id="cb13-4"><a href="Rbasic.html#cb13-4" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;&gt;</span> <span class="fu">example</span>(command) <span class="co">#得到命令的例子</span></span>
<span id="cb13-5"><a href="Rbasic.html#cb13-5" tabindex="-1"></a></span>
<span id="cb13-6"><a href="Rbasic.html#cb13-6" tabindex="-1"></a><span class="sc">&gt;</span><span class="er">&gt;&gt;</span> <span class="fu">example</span>(plot)</span></code></pre></div>
</div>
<div id="R_variable" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> R中的变量及其初始化<a href="Rbasic.html#R_variable" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="Rbasic.html#cb14-1" tabindex="-1"></a><span class="co"># 数字变量</span></span>
<span id="cb14-2"><a href="Rbasic.html#cb14-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">10</span></span>
<span id="cb14-3"><a href="Rbasic.html#cb14-3" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## [1] 10</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="Rbasic.html#cb16-1" tabindex="-1"></a><span class="co"># 字符串变量</span></span>
<span id="cb16-2"><a href="Rbasic.html#cb16-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="st">&quot;abc&quot;</span></span>
<span id="cb16-3"><a href="Rbasic.html#cb16-3" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## [1] &quot;abc&quot;</code></pre>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="Rbasic.html#cb18-1" tabindex="-1"></a><span class="co"># 逻辑变量</span></span>
<span id="cb18-2"><a href="Rbasic.html#cb18-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="cn">TRUE</span></span>
<span id="cb18-3"><a href="Rbasic.html#cb18-3" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="Rbasic.html#cb20-1" tabindex="-1"></a>b <span class="ot">&lt;-</span> T</span>
<span id="cb20-2"><a href="Rbasic.html#cb20-2" tabindex="-1"></a>b</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="Rbasic.html#cb22-1" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="cn">FALSE</span></span>
<span id="cb22-2"><a href="Rbasic.html#cb22-2" tabindex="-1"></a>d</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="Rbasic.html#cb24-1" tabindex="-1"></a><span class="co"># 向量</span></span>
<span id="cb24-2"><a href="Rbasic.html#cb24-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">mode=</span><span class="st">&quot;logical&quot;</span>, <span class="at">length=</span><span class="dv">5</span>)</span>
<span id="cb24-3"><a href="Rbasic.html#cb24-3" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## [1] FALSE FALSE FALSE FALSE FALSE</code></pre>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="Rbasic.html#cb26-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb26-2"><a href="Rbasic.html#cb26-2" tabindex="-1"></a><span class="co"># 判断一个变量是不是vector</span></span>
<span id="cb26-3"><a href="Rbasic.html#cb26-3" tabindex="-1"></a><span class="fu">is.vector</span>(a)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb28-1"><a href="Rbasic.html#cb28-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">element1=</span><span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>), <span class="at">element2=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb28-2"><a href="Rbasic.html#cb28-2" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>## $element1
## [1] 1 2 3 4
## 
## $element2
## [1] 1 2 3 4 5</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="Rbasic.html#cb30-1" tabindex="-1"></a><span class="co"># 矩阵</span></span>
<span id="cb30-2"><a href="Rbasic.html#cb30-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>,<span class="at">nrow=</span><span class="dv">5</span>,<span class="at">ncol=</span><span class="dv">4</span>,<span class="at">byrow=</span>T)</span>
<span id="cb30-3"><a href="Rbasic.html#cb30-3" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    2    3    4
## [2,]    5    6    7    8
## [3,]    9   10   11   12
## [4,]   13   14   15   16
## [5,]   17   18   19   20</code></pre>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="Rbasic.html#cb32-1" tabindex="-1"></a><span class="fu">is.matrix</span>(a)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="Rbasic.html#cb34-1" tabindex="-1"></a><span class="fu">dim</span>(a) <span class="co">#查看或设置数组的维度向量</span></span></code></pre></div>
<pre><code>## [1] 5 4</code></pre>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="Rbasic.html#cb36-1" tabindex="-1"></a><span class="co"># 错误的用法</span></span>
<span id="cb36-2"><a href="Rbasic.html#cb36-2" tabindex="-1"></a><span class="co"># dim(a) &lt;- c(4,4)</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="Rbasic.html#cb37-1" tabindex="-1"></a><span class="co"># 正确的用法</span></span>
<span id="cb37-2"><a href="Rbasic.html#cb37-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb37-3"><a href="Rbasic.html#cb37-3" tabindex="-1"></a><span class="fu">dim</span>(a) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">5</span>,<span class="dv">4</span>) <span class="co">#转换向量为矩阵</span></span>
<span id="cb37-4"><a href="Rbasic.html#cb37-4" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>##      [,1] [,2] [,3] [,4]
## [1,]    1    6   11   16
## [2,]    2    7   12   17
## [3,]    3    8   13   18
## [4,]    4    9   14   19
## [5,]    5   10   15   20</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="Rbasic.html#cb39-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;矩阵a的行数&quot;</span>, <span class="fu">nrow</span>(a)))</span></code></pre></div>
<pre><code>## [1] &quot;矩阵a的行数 5&quot;</code></pre>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="Rbasic.html#cb41-1" tabindex="-1"></a><span class="fu">print</span>(<span class="fu">paste</span>(<span class="st">&quot;矩阵a的列数&quot;</span>, <span class="fu">ncol</span>(a)))</span></code></pre></div>
<pre><code>## [1] &quot;矩阵a的列数 4&quot;</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="Rbasic.html#cb43-1" tabindex="-1"></a><span class="co">#查看或设置行列名</span></span>
<span id="cb43-2"><a href="Rbasic.html#cb43-2" tabindex="-1"></a><span class="fu">rownames</span>(a)</span></code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="Rbasic.html#cb45-1" tabindex="-1"></a><span class="fu">rownames</span>(a) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;a&#39;</span>,<span class="st">&#39;b&#39;</span>,<span class="st">&#39;c&#39;</span>,<span class="st">&#39;d&#39;</span>,<span class="st">&#39;e&#39;</span>)</span>
<span id="cb45-2"><a href="Rbasic.html#cb45-2" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>##   [,1] [,2] [,3] [,4]
## a    1    6   11   16
## b    2    7   12   17
## c    3    8   13   18
## d    4    9   14   19
## e    5   10   15   20</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="Rbasic.html#cb47-1" tabindex="-1"></a><span class="co"># R中获取一系列的字母</span></span>
<span id="cb47-2"><a href="Rbasic.html#cb47-2" tabindex="-1"></a>letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span></code></pre></div>
<pre><code>## [1] &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot;</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb49-1"><a href="Rbasic.html#cb49-1" tabindex="-1"></a><span class="fu">colnames</span>(a) <span class="ot">&lt;-</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>]</span>
<span id="cb49-2"><a href="Rbasic.html#cb49-2" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>##   a  b  c  d
## a 1  6 11 16
## b 2  7 12 17
## c 3  8 13 18
## d 4  9 14 19
## e 5 10 15 20</code></pre>
</div>
<div id="vairableType" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> 变量类型和转换<a href="Rbasic.html#vairableType" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>不同的变量类型有不同的操作方式，<code>is</code>系列和<code>as</code>系列函数用来判断变量的属性和转换变量的属性</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="Rbasic.html#cb51-1" tabindex="-1"></a><span class="fu">is.character</span>(a)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb53-1"><a href="Rbasic.html#cb53-1" tabindex="-1"></a><span class="fu">is.numeric</span>(a)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="Rbasic.html#cb55-1" tabindex="-1"></a><span class="fu">is.matrix</span>(a)</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="Rbasic.html#cb57-1" tabindex="-1"></a><span class="fu">is.data.frame</span>(a)</span></code></pre></div>
<pre><code>## [1] FALSE</code></pre>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="Rbasic.html#cb59-1" tabindex="-1"></a><span class="fu">is.data.frame</span>(<span class="fu">as.data.frame</span>(a))</span></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="Rmatrix" class="section level3 hasAnchor" number="2.3.4">
<h3><span class="header-section-number">2.3.4</span> R中矩阵运算<a href="Rbasic.html#Rmatrix" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="Rbasic.html#cb61-1" tabindex="-1"></a><span class="co"># 获得随机的正态分布数据</span></span>
<span id="cb61-2"><a href="Rbasic.html#cb61-2" tabindex="-1"></a><span class="co"># random generation for the normal distribution with mean equal to ‘mean’</span></span>
<span id="cb61-3"><a href="Rbasic.html#cb61-3" tabindex="-1"></a><span class="co"># and standard deviation equal to ‘sd’.</span></span>
<span id="cb61-4"><a href="Rbasic.html#cb61-4" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># 正态分布的随机数</span></span></code></pre></div>
<pre><code>##  [1]  0.52712467 -0.10475994 -0.09139129 -0.41669693  0.18459219 -0.40894546
##  [7]  2.48039595  0.23856780  0.99240288  0.12540542</code></pre>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="Rbasic.html#cb63-1" tabindex="-1"></a><span class="co"># 获得随机的均匀分布的数据</span></span>
<span id="cb63-2"><a href="Rbasic.html#cb63-2" tabindex="-1"></a><span class="co"># random generation for the uniform distribution with mean equal to ‘mean’</span></span>
<span id="cb63-3"><a href="Rbasic.html#cb63-3" tabindex="-1"></a><span class="co"># and standard deviation equal to ‘sd’.</span></span>
<span id="cb63-4"><a href="Rbasic.html#cb63-4" tabindex="-1"></a><span class="fu">runif</span>(<span class="dv">10</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>) <span class="co"># 平均分布的随机数</span></span></code></pre></div>
<pre><code>##  [1] 0.597723095 0.892481028 0.191395164 0.620892942 0.561990018 0.754794815
##  [7] 0.913468442 0.005828207 0.908370379 0.220653976</code></pre>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="Rbasic.html#cb65-1" tabindex="-1"></a><span class="fu">rep</span>(<span class="dv">1</span>,<span class="dv">5</span>) <span class="co"># 把1重复5次</span></span></code></pre></div>
<pre><code>## [1] 1 1 1 1 1</code></pre>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="Rbasic.html#cb67-1" tabindex="-1"></a><span class="fu">scale</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>) <span class="co"># 标准化数据</span></span></code></pre></div>
<pre><code>##            [,1]
## [1,] -1.2649111
## [2,] -0.6324555
## [3,]  0.0000000
## [4,]  0.6324555
## [5,]  1.2649111
## attr(,&quot;scaled:center&quot;)
## [1] 3
## attr(,&quot;scaled:scale&quot;)
## [1] 1.581139</code></pre>
<p><code>scale</code>默认操作对等于</p>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="Rbasic.html#cb69-1" tabindex="-1"></a><span class="co"># 标准化数据</span></span>
<span id="cb69-2"><a href="Rbasic.html#cb69-2" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb69-3"><a href="Rbasic.html#cb69-3" tabindex="-1"></a>(a <span class="sc">-</span> <span class="fu">mean</span>(a)) <span class="sc">/</span> <span class="fu">sd</span>(a)</span></code></pre></div>
<pre><code>## [1] -1.2649111 -0.6324555  0.0000000  0.6324555  1.2649111</code></pre>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="Rbasic.html#cb71-1" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">5</span>), <span class="fu">rnorm</span>(<span class="dv">5</span>,<span class="dv">1</span>), <span class="fu">runif</span>(<span class="dv">5</span>), <span class="fu">runif</span>(<span class="dv">5</span>,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>), <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="fu">rep</span>(<span class="dv">0</span>,<span class="dv">5</span>), <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">11</span>,<span class="dv">13</span>,<span class="dv">4</span>), </span>
<span id="cb71-2"><a href="Rbasic.html#cb71-2" tabindex="-1"></a>        <span class="fu">scale</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>])</span>
<span id="cb71-3"><a href="Rbasic.html#cb71-3" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>##  [1] -0.2138275 -2.9222701 -0.6744831 -1.4005780  0.6905400  1.2549925
##  [7]  0.8959074  0.8356582  1.0059939 -0.5865703  0.7674368  0.1619154
## [13]  0.3920250  0.1162514  0.4566943 -0.7023189 -0.3025084  0.9406374
## [19] -0.5611974  0.9154688  1.0000000  2.0000000  3.0000000  4.0000000
## [25]  5.0000000  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
## [31]  2.0000000 10.0000000 11.0000000 13.0000000  4.0000000 -1.2649111
## [37] -0.6324555  0.0000000  0.6324555  1.2649111</code></pre>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="Rbasic.html#cb73-1" tabindex="-1"></a><span class="co"># ncol=5 5列</span></span>
<span id="cb73-2"><a href="Rbasic.html#cb73-2" tabindex="-1"></a><span class="co"># byrow=T: 先填充行</span></span>
<span id="cb73-3"><a href="Rbasic.html#cb73-3" tabindex="-1"></a>a <span class="ot">&lt;-</span> <span class="fu">matrix</span>(a, <span class="at">ncol=</span><span class="dv">5</span>, <span class="at">byrow=</span>T)</span>
<span id="cb73-4"><a href="Rbasic.html#cb73-4" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]       [,4]       [,5]
## [1,] -0.2138275 -2.9222701 -0.6744831 -1.4005780  0.6905400
## [2,]  1.2549925  0.8959074  0.8356582  1.0059939 -0.5865703
## [3,]  0.7674368  0.1619154  0.3920250  0.1162514  0.4566943
## [4,] -0.7023189 -0.3025084  0.9406374 -0.5611974  0.9154688
## [5,]  1.0000000  2.0000000  3.0000000  4.0000000  5.0000000
## [6,]  0.0000000  0.0000000  0.0000000  0.0000000  0.0000000
## [7,]  2.0000000 10.0000000 11.0000000 13.0000000  4.0000000
## [8,] -1.2649111 -0.6324555  0.0000000  0.6324555  1.2649111</code></pre>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="Rbasic.html#cb75-1" tabindex="-1"></a><span class="co"># 按行加和</span></span>
<span id="cb75-2"><a href="Rbasic.html#cb75-2" tabindex="-1"></a><span class="fu">rowSums</span>(a)</span></code></pre></div>
<pre><code>## [1] -4.520619e+00  3.405982e+00  1.894323e+00  2.900814e-01  1.500000e+01
## [6]  0.000000e+00  4.000000e+01  2.220446e-16</code></pre>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="Rbasic.html#cb77-1" tabindex="-1"></a><span class="co"># 注意检查括号的配对</span></span>
<span id="cb77-2"><a href="Rbasic.html#cb77-2" tabindex="-1"></a><span class="co">#a &lt;- a[rowSums(abs(a)!=0,]</span></span>
<span id="cb77-3"><a href="Rbasic.html#cb77-3" tabindex="-1"></a><span class="co">#错误: 意外的&#39;]&#39; in &quot;a &lt;- a[rowSums(abs(a)!=0,]&quot;</span></span>
<span id="cb77-4"><a href="Rbasic.html#cb77-4" tabindex="-1"></a></span>
<span id="cb77-5"><a href="Rbasic.html#cb77-5" tabindex="-1"></a><span class="co"># 去除全部为0的行</span></span>
<span id="cb77-6"><a href="Rbasic.html#cb77-6" tabindex="-1"></a>a <span class="ot">&lt;-</span> a[<span class="fu">rowSums</span>(<span class="fu">abs</span>(a))<span class="sc">!=</span><span class="dv">0</span>,]</span>
<span id="cb77-7"><a href="Rbasic.html#cb77-7" tabindex="-1"></a></span>
<span id="cb77-8"><a href="Rbasic.html#cb77-8" tabindex="-1"></a><span class="co"># 另外一种方式去除全部为0的行</span></span>
<span id="cb77-9"><a href="Rbasic.html#cb77-9" tabindex="-1"></a><span class="co">#a[rowSums(a==0)&lt;ncol(a),]</span></span>
<span id="cb77-10"><a href="Rbasic.html#cb77-10" tabindex="-1"></a></span>
<span id="cb77-11"><a href="Rbasic.html#cb77-11" tabindex="-1"></a>a</span></code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]       [,4]       [,5]
## [1,] -0.2138275 -2.9222701 -0.6744831 -1.4005780  0.6905400
## [2,]  1.2549925  0.8959074  0.8356582  1.0059939 -0.5865703
## [3,]  0.7674368  0.1619154  0.3920250  0.1162514  0.4566943
## [4,] -0.7023189 -0.3025084  0.9406374 -0.5611974  0.9154688
## [5,]  1.0000000  2.0000000  3.0000000  4.0000000  5.0000000
## [6,]  2.0000000 10.0000000 11.0000000 13.0000000  4.0000000
## [7,] -1.2649111 -0.6324555  0.0000000  0.6324555  1.2649111</code></pre>
<p>矩阵运算，R默认针对整个数据进行常见运算</p>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="Rbasic.html#cb79-1" tabindex="-1"></a><span class="co">#所有值都乘以2</span></span>
<span id="cb79-2"><a href="Rbasic.html#cb79-2" tabindex="-1"></a>a <span class="sc">*</span> <span class="dv">2</span></span></code></pre></div>
<pre><code>##            [,1]       [,2]      [,3]       [,4]       [,5]
## [1,] -0.4276551 -5.8445403 -1.348966 -2.8011560  1.3810801
## [2,]  2.5099850  1.7918148  1.671316  2.0119878 -1.1731406
## [3,]  1.5348737  0.3238308  0.784050  0.2325029  0.9133886
## [4,] -1.4046379 -0.6050169  1.881275 -1.1223949  1.8309376
## [5,]  2.0000000  4.0000000  6.000000  8.0000000 10.0000000
## [6,]  4.0000000 20.0000000 22.000000 26.0000000  8.0000000
## [7,] -2.5298221 -1.2649111  0.000000  1.2649111  2.5298221</code></pre>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="Rbasic.html#cb81-1" tabindex="-1"></a><span class="co"># 所有值取绝对值，再取对数 （取对数前一般加一个数避免对0或负值取对数）</span></span>
<span id="cb81-2"><a href="Rbasic.html#cb81-2" tabindex="-1"></a><span class="fu">log2</span>(<span class="fu">abs</span>(a)<span class="sc">+</span><span class="dv">1</span>)</span></code></pre></div>
<pre><code>##           [,1]      [,2]      [,3]      [,4]      [,5]
## [1,] 0.2795635 1.9716889 0.7437158 1.2633818 0.7574842
## [2,] 1.1731226 0.9228885 0.8762975 1.0043172 0.6659114
## [3,] 0.8216587 0.2165050 0.4771851 0.1586620 0.5426982
## [4,] 0.7675014 0.3812927 0.9565306 0.6426530 0.9376975
## [5,] 1.0000000 1.5849625 2.0000000 2.3219281 2.5849625
## [6,] 1.5849625 3.4594316 3.5849625 3.8073549 2.3219281
## [7,] 1.1794544 0.7070437 0.0000000 0.7070437 1.1794544</code></pre>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="Rbasic.html#cb83-1" tabindex="-1"></a><span class="co"># 取出最大值、最小值、行数、列数</span></span>
<span id="cb83-2"><a href="Rbasic.html#cb83-2" tabindex="-1"></a><span class="fu">max</span>(a)</span></code></pre></div>
<pre><code>## [1] 13</code></pre>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="Rbasic.html#cb85-1" tabindex="-1"></a><span class="fu">min</span>(a)</span></code></pre></div>
<pre><code>## [1] -2.92227</code></pre>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="Rbasic.html#cb87-1" tabindex="-1"></a><span class="fu">nrow</span>(a)</span></code></pre></div>
<pre><code>## [1] 7</code></pre>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="Rbasic.html#cb89-1" tabindex="-1"></a><span class="fu">ncol</span>(a)</span></code></pre></div>
<pre><code>## [1] 5</code></pre>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="Rbasic.html#cb91-1" tabindex="-1"></a><span class="co">#增加一列或一行</span></span>
<span id="cb91-2"><a href="Rbasic.html#cb91-2" tabindex="-1"></a><span class="co">#cbind: column bind</span></span>
<span id="cb91-3"><a href="Rbasic.html#cb91-3" tabindex="-1"></a><span class="fu">cbind</span>(a, <span class="dv">1</span><span class="sc">:</span><span class="dv">7</span>)</span></code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]       [,4]       [,5] [,6]
## [1,] -0.2138275 -2.9222701 -0.6744831 -1.4005780  0.6905400    1
## [2,]  1.2549925  0.8959074  0.8356582  1.0059939 -0.5865703    2
## [3,]  0.7674368  0.1619154  0.3920250  0.1162514  0.4566943    3
## [4,] -0.7023189 -0.3025084  0.9406374 -0.5611974  0.9154688    4
## [5,]  1.0000000  2.0000000  3.0000000  4.0000000  5.0000000    5
## [6,]  2.0000000 10.0000000 11.0000000 13.0000000  4.0000000    6
## [7,] -1.2649111 -0.6324555  0.0000000  0.6324555  1.2649111    7</code></pre>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="Rbasic.html#cb93-1" tabindex="-1"></a><span class="co"># rbind: row bind</span></span>
<span id="cb93-2"><a href="Rbasic.html#cb93-2" tabindex="-1"></a><span class="fu">rbind</span>(a,<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span></code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]       [,4]       [,5]
## [1,] -0.2138275 -2.9222701 -0.6744831 -1.4005780  0.6905400
## [2,]  1.2549925  0.8959074  0.8356582  1.0059939 -0.5865703
## [3,]  0.7674368  0.1619154  0.3920250  0.1162514  0.4566943
## [4,] -0.7023189 -0.3025084  0.9406374 -0.5611974  0.9154688
## [5,]  1.0000000  2.0000000  3.0000000  4.0000000  5.0000000
## [6,]  2.0000000 10.0000000 11.0000000 13.0000000  4.0000000
## [7,] -1.2649111 -0.6324555  0.0000000  0.6324555  1.2649111
## [8,]  1.0000000  2.0000000  3.0000000  4.0000000  5.0000000</code></pre>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="Rbasic.html#cb95-1" tabindex="-1"></a><span class="co"># 计算每一行的var (方差)</span></span>
<span id="cb95-2"><a href="Rbasic.html#cb95-2" tabindex="-1"></a><span class="co"># apply表示对数据（第一个参数）的每一行 (第二个参数赋值为1) 或每一列 (2)操作</span></span>
<span id="cb95-3"><a href="Rbasic.html#cb95-3" tabindex="-1"></a><span class="co">#      最后返回一个列表</span></span>
<span id="cb95-4"><a href="Rbasic.html#cb95-4" tabindex="-1"></a><span class="fu">apply</span>(a,<span class="dv">1</span>,var)</span></code></pre></div>
<pre><code>## [1]  1.84789449  0.52798175  0.06831292  0.65143955  2.50000000 22.50000000
## [7]  1.00000000</code></pre>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="Rbasic.html#cb97-1" tabindex="-1"></a><span class="co"># 计算每一行的mad (中值绝对偏差)</span></span>
<span id="cb97-2"><a href="Rbasic.html#cb97-2" tabindex="-1"></a><span class="co"># 一般认为比方差的鲁棒性更强，更少受异常值的影响，更能反映数据间的差异)</span></span>
<span id="cb97-3"><a href="Rbasic.html#cb97-3" tabindex="-1"></a><span class="co"># 函数中的第二个参数 1 表示安行操作</span></span>
<span id="cb97-4"><a href="Rbasic.html#cb97-4" tabindex="-1"></a><span class="fu">apply</span>(a,<span class="dv">1</span>,mad)</span></code></pre></div>
<pre><code>## [1] 1.0765083 0.1632143 0.3411605 0.5927590 1.4826000 4.4478000 0.9376786</code></pre>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="Rbasic.html#cb99-1" tabindex="-1"></a><span class="co"># 计算每一列的平均值</span></span>
<span id="cb99-2"><a href="Rbasic.html#cb99-2" tabindex="-1"></a><span class="fu">apply</span>(a,<span class="dv">2</span>,mean)</span></code></pre></div>
<pre><code>## [1] 0.4059103 1.3143698 2.2134054 2.3989893 1.6772920</code></pre>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="Rbasic.html#cb101-1" tabindex="-1"></a><span class="co"># 取出中值绝对偏差大于0.5的行</span></span>
<span id="cb101-2"><a href="Rbasic.html#cb101-2" tabindex="-1"></a>b <span class="ot">=</span> a[<span class="fu">apply</span>(a,<span class="dv">1</span>,mad)<span class="sc">&gt;</span><span class="fl">0.5</span>,]</span>
<span id="cb101-3"><a href="Rbasic.html#cb101-3" tabindex="-1"></a>b</span></code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]       [,4]      [,5]
## [1,] -0.2138275 -2.9222701 -0.6744831 -1.4005780 0.6905400
## [2,] -0.7023189 -0.3025084  0.9406374 -0.5611974 0.9154688
## [3,]  1.0000000  2.0000000  3.0000000  4.0000000 5.0000000
## [4,]  2.0000000 10.0000000 11.0000000 13.0000000 4.0000000
## [5,] -1.2649111 -0.6324555  0.0000000  0.6324555 1.2649111</code></pre>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="Rbasic.html#cb103-1" tabindex="-1"></a><span class="co"># 输出 1 4 2 3 5</span></span>
<span id="cb103-2"><a href="Rbasic.html#cb103-2" tabindex="-1"></a><span class="co"># 解释：原列表第一个元素显示在第一位</span></span>
<span id="cb103-3"><a href="Rbasic.html#cb103-3" tabindex="-1"></a><span class="co">#       原列表第四个元素显示在第二位</span></span>
<span id="cb103-4"><a href="Rbasic.html#cb103-4" tabindex="-1"></a><span class="co">#       原列表第二个元素显示在第三位</span></span>
<span id="cb103-5"><a href="Rbasic.html#cb103-5" tabindex="-1"></a><span class="fu">order</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">2</span>,<span class="dv">5</span>))</span></code></pre></div>
<pre><code>## [1] 1 4 2 3 5</code></pre>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="Rbasic.html#cb105-1" tabindex="-1"></a><span class="co"># 产生新的顺序</span></span>
<span id="cb105-2"><a href="Rbasic.html#cb105-2" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb105-3"><a href="Rbasic.html#cb105-3" tabindex="-1"></a><span class="fu">order</span>(<span class="fu">apply</span>(b,<span class="dv">1</span>,mad), <span class="at">decreasing=</span>T)</span></code></pre></div>
<pre><code>## [1] 4 3 1 5 2</code></pre>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="Rbasic.html#cb107-1" tabindex="-1"></a><span class="co"># 矩阵按照mad的大小降序排列</span></span>
<span id="cb107-2"><a href="Rbasic.html#cb107-2" tabindex="-1"></a>c <span class="ot">=</span> b[<span class="fu">order</span>(<span class="fu">apply</span>(b,<span class="dv">1</span>,mad), <span class="at">decreasing=</span>T),]</span>
<span id="cb107-3"><a href="Rbasic.html#cb107-3" tabindex="-1"></a>c</span></code></pre></div>
<pre><code>##            [,1]       [,2]       [,3]       [,4]      [,5]
## [1,]  2.0000000 10.0000000 11.0000000 13.0000000 4.0000000
## [2,]  1.0000000  2.0000000  3.0000000  4.0000000 5.0000000
## [3,] -0.2138275 -2.9222701 -0.6744831 -1.4005780 0.6905400
## [4,] -1.2649111 -0.6324555  0.0000000  0.6324555 1.2649111
## [5,] -0.7023189 -0.3025084  0.9406374 -0.5611974 0.9154688</code></pre>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="Rbasic.html#cb109-1" tabindex="-1"></a><span class="fu">rownames</span>(c) <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&#39;Gene&#39;</span>, letters[<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(c)], <span class="at">sep=</span><span class="st">&quot;_&quot;</span>)</span>
<span id="cb109-2"><a href="Rbasic.html#cb109-2" tabindex="-1"></a><span class="fu">colnames</span>(c) <span class="ot">&lt;-</span> <span class="fu">toupper</span>(letters[<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(c)])</span>
<span id="cb109-3"><a href="Rbasic.html#cb109-3" tabindex="-1"></a>c</span></code></pre></div>
<pre><code>##                 A          B          C          D         E
## Gene_a  2.0000000 10.0000000 11.0000000 13.0000000 4.0000000
## Gene_b  1.0000000  2.0000000  3.0000000  4.0000000 5.0000000
## Gene_c -0.2138275 -2.9222701 -0.6744831 -1.4005780 0.6905400
## Gene_d -1.2649111 -0.6324555  0.0000000  0.6324555 1.2649111
## Gene_e -0.7023189 -0.3025084  0.9406374 -0.5611974 0.9154688</code></pre>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="Rbasic.html#cb111-1" tabindex="-1"></a><span class="co"># 矩阵转置</span></span>
<span id="cb111-2"><a href="Rbasic.html#cb111-2" tabindex="-1"></a>expr <span class="ot">=</span> <span class="fu">t</span>(c)</span>
<span id="cb111-3"><a href="Rbasic.html#cb111-3" tabindex="-1"></a>expr</span></code></pre></div>
<pre><code>##   Gene_a Gene_b     Gene_c     Gene_d     Gene_e
## A      2      1 -0.2138275 -1.2649111 -0.7023189
## B     10      2 -2.9222701 -0.6324555 -0.3025084
## C     11      3 -0.6744831  0.0000000  0.9406374
## D     13      4 -1.4005780  0.6324555 -0.5611974
## E      4      5  0.6905400  1.2649111  0.9154688</code></pre>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="Rbasic.html#cb113-1" tabindex="-1"></a><span class="co"># 矩阵值的替换</span></span>
<span id="cb113-2"><a href="Rbasic.html#cb113-2" tabindex="-1"></a>expr2 <span class="ot">=</span> expr</span>
<span id="cb113-3"><a href="Rbasic.html#cb113-3" tabindex="-1"></a>expr2[expr2<span class="sc">&lt;</span><span class="dv">0</span>] <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb113-4"><a href="Rbasic.html#cb113-4" tabindex="-1"></a>expr2</span></code></pre></div>
<pre><code>##   Gene_a Gene_b  Gene_c    Gene_d    Gene_e
## A      2      1 0.00000 0.0000000 0.0000000
## B     10      2 0.00000 0.0000000 0.0000000
## C     11      3 0.00000 0.0000000 0.9406374
## D     13      4 0.00000 0.6324555 0.0000000
## E      4      5 0.69054 1.2649111 0.9154688</code></pre>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="Rbasic.html#cb115-1" tabindex="-1"></a><span class="co"># 矩阵中只针对某一列替换</span></span>
<span id="cb115-2"><a href="Rbasic.html#cb115-2" tabindex="-1"></a><span class="co"># expr2是个矩阵不是数据框，不能使用列名字索引</span></span>
<span id="cb115-3"><a href="Rbasic.html#cb115-3" tabindex="-1"></a><span class="co"># expr2[expr2$Gene_b&lt;1, &quot;Gene_b&quot;] &lt;- 1</span></span></code></pre></div>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="Rbasic.html#cb116-1" tabindex="-1"></a><span class="co"># str是一个最为常用、好用的查看变量信息的工具，尤其是对特别复杂的变量，</span></span>
<span id="cb116-2"><a href="Rbasic.html#cb116-2" tabindex="-1"></a><span class="co">#    可以看清其层级结构，便于提取数据</span></span>
<span id="cb116-3"><a href="Rbasic.html#cb116-3" tabindex="-1"></a><span class="fu">str</span>(expr2)</span></code></pre></div>
<pre><code>##  num [1:5, 1:5] 2 10 11 13 4 1 2 3 4 5 ...
##  - attr(*, &quot;dimnames&quot;)=List of 2
##   ..$ : chr [1:5] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; ...
##   ..$ : chr [1:5] &quot;Gene_a&quot; &quot;Gene_b&quot; &quot;Gene_c&quot; &quot;Gene_d&quot; ...</code></pre>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="Rbasic.html#cb118-1" tabindex="-1"></a><span class="co"># 转换为数据框，再进行相应的操作</span></span>
<span id="cb118-2"><a href="Rbasic.html#cb118-2" tabindex="-1"></a>expr2 <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(expr2)</span>
<span id="cb118-3"><a href="Rbasic.html#cb118-3" tabindex="-1"></a><span class="fu">str</span>(expr2)</span></code></pre></div>
<pre><code>## &#39;data.frame&#39;:    5 obs. of  5 variables:
##  $ Gene_a: num  2 10 11 13 4
##  $ Gene_b: num  1 2 3 4 5
##  $ Gene_c: num  0 0 0 0 0.691
##  $ Gene_d: num  0 0 0 0.632 1.265
##  $ Gene_e: num  0 0 0.941 0 0.915</code></pre>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="Rbasic.html#cb120-1" tabindex="-1"></a>expr2[expr2<span class="sc">$</span>Gene_b<span class="sc">&lt;</span><span class="dv">1</span>, <span class="st">&quot;Gene_b&quot;</span>] <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb120-2"><a href="Rbasic.html#cb120-2" tabindex="-1"></a>expr2</span></code></pre></div>
<pre><code>##   Gene_a Gene_b  Gene_c    Gene_d    Gene_e
## A      2      1 0.00000 0.0000000 0.0000000
## B     10      2 0.00000 0.0000000 0.0000000
## C     11      3 0.00000 0.0000000 0.9406374
## D     13      4 0.00000 0.6324555 0.0000000
## E      4      5 0.69054 1.2649111 0.9154688</code></pre>
</div>
<div id="Rmatrixcombine" class="section level3 hasAnchor" number="2.3.5">
<h3><span class="header-section-number">2.3.5</span> R中矩阵筛选合并<a href="Rbasic.html#Rmatrixcombine" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="Rbasic.html#cb122-1" tabindex="-1"></a><span class="co"># 读入样品信息</span></span>
<span id="cb122-2"><a href="Rbasic.html#cb122-2" tabindex="-1"></a>sampleInfo <span class="ot">=</span> <span class="st">&quot;Samp;Group;Genotype</span></span>
<span id="cb122-3"><a href="Rbasic.html#cb122-3" tabindex="-1"></a><span class="st">A;Control;WT</span></span>
<span id="cb122-4"><a href="Rbasic.html#cb122-4" tabindex="-1"></a><span class="st">B;Control;WT</span></span>
<span id="cb122-5"><a href="Rbasic.html#cb122-5" tabindex="-1"></a><span class="st">D;Treatment;Mutant</span></span>
<span id="cb122-6"><a href="Rbasic.html#cb122-6" tabindex="-1"></a><span class="st">C;Treatment;Mutant</span></span>
<span id="cb122-7"><a href="Rbasic.html#cb122-7" tabindex="-1"></a><span class="st">E;Treatment;WT</span></span>
<span id="cb122-8"><a href="Rbasic.html#cb122-8" tabindex="-1"></a><span class="st">F;Treatment;WT&quot;</span></span>
<span id="cb122-9"><a href="Rbasic.html#cb122-9" tabindex="-1"></a></span>
<span id="cb122-10"><a href="Rbasic.html#cb122-10" tabindex="-1"></a>phenoData <span class="ot">=</span> <span class="fu">read.table</span>(<span class="at">text=</span>sampleInfo,<span class="at">sep=</span><span class="st">&quot;;&quot;</span>, <span class="at">header=</span>T, <span class="at">row.names=</span><span class="dv">1</span>, <span class="at">quote=</span><span class="st">&quot;&quot;</span>)</span>
<span id="cb122-11"><a href="Rbasic.html#cb122-11" tabindex="-1"></a>phenoData</span></code></pre></div>
<pre><code>##       Group Genotype
## A   Control       WT
## B   Control       WT
## D Treatment   Mutant
## C Treatment   Mutant
## E Treatment       WT
## F Treatment       WT</code></pre>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="Rbasic.html#cb124-1" tabindex="-1"></a><span class="co"># 把样品信息按照基因表达矩阵中的样品信息排序，并只保留有基因表达信息的样品</span></span>
<span id="cb124-2"><a href="Rbasic.html#cb124-2" tabindex="-1"></a><span class="co"># ‘%in%’ is a more intuitive interface as a binary operator, which</span></span>
<span id="cb124-3"><a href="Rbasic.html#cb124-3" tabindex="-1"></a><span class="co">#     returns a logical vector indicating if there is a match or not for</span></span>
<span id="cb124-4"><a href="Rbasic.html#cb124-4" tabindex="-1"></a><span class="co">#     its left operand.</span></span>
<span id="cb124-5"><a href="Rbasic.html#cb124-5" tabindex="-1"></a>     </span>
<span id="cb124-6"><a href="Rbasic.html#cb124-6" tabindex="-1"></a>phenoData <span class="ot">=</span> phenoData[<span class="fu">rownames</span>(phenoData) <span class="sc">%in%</span> <span class="fu">rownames</span>(expr),]</span>
<span id="cb124-7"><a href="Rbasic.html#cb124-7" tabindex="-1"></a>phenoData</span></code></pre></div>
<pre><code>##       Group Genotype
## A   Control       WT
## B   Control       WT
## D Treatment   Mutant
## C Treatment   Mutant
## E Treatment       WT</code></pre>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="Rbasic.html#cb126-1" tabindex="-1"></a><span class="co"># 合并矩阵</span></span>
<span id="cb126-2"><a href="Rbasic.html#cb126-2" tabindex="-1"></a><span class="co"># by=0 表示按照行的名字排序</span></span>
<span id="cb126-3"><a href="Rbasic.html#cb126-3" tabindex="-1"></a><span class="co"># by=columnname 表示按照共有的某一列合并</span></span>
<span id="cb126-4"><a href="Rbasic.html#cb126-4" tabindex="-1"></a><span class="co"># 合并后多出了新的一列Row.names</span></span>
<span id="cb126-5"><a href="Rbasic.html#cb126-5" tabindex="-1"></a>merge_data <span class="ot">=</span> <span class="fu">merge</span>(expr, phenoData, <span class="at">by=</span><span class="dv">0</span>, <span class="at">all.x=</span>T)</span>
<span id="cb126-6"><a href="Rbasic.html#cb126-6" tabindex="-1"></a>merge_data</span></code></pre></div>
<pre><code>##   Row.names Gene_a Gene_b     Gene_c     Gene_d     Gene_e     Group Genotype
## 1         A      2      1 -0.2138275 -1.2649111 -0.7023189   Control       WT
## 2         B     10      2 -2.9222701 -0.6324555 -0.3025084   Control       WT
## 3         C     11      3 -0.6744831  0.0000000  0.9406374 Treatment   Mutant
## 4         D     13      4 -1.4005780  0.6324555 -0.5611974 Treatment   Mutant
## 5         E      4      5  0.6905400  1.2649111  0.9154688 Treatment       WT</code></pre>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="Rbasic.html#cb128-1" tabindex="-1"></a><span class="fu">rownames</span>(merge_data) <span class="ot">&lt;-</span> merge_data<span class="sc">$</span>Row.names</span>
<span id="cb128-2"><a href="Rbasic.html#cb128-2" tabindex="-1"></a>merge_data</span></code></pre></div>
<pre><code>##   Row.names Gene_a Gene_b     Gene_c     Gene_d     Gene_e     Group Genotype
## A         A      2      1 -0.2138275 -1.2649111 -0.7023189   Control       WT
## B         B     10      2 -2.9222701 -0.6324555 -0.3025084   Control       WT
## C         C     11      3 -0.6744831  0.0000000  0.9406374 Treatment   Mutant
## D         D     13      4 -1.4005780  0.6324555 -0.5611974 Treatment   Mutant
## E         E      4      5  0.6905400  1.2649111  0.9154688 Treatment       WT</code></pre>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="Rbasic.html#cb130-1" tabindex="-1"></a><span class="co"># 去除一列；-1表示去除第一列</span></span>
<span id="cb130-2"><a href="Rbasic.html#cb130-2" tabindex="-1"></a>merge_data <span class="ot">=</span> merge_data[,<span class="sc">-</span><span class="dv">1</span>]</span>
<span id="cb130-3"><a href="Rbasic.html#cb130-3" tabindex="-1"></a>merge_data</span></code></pre></div>
<pre><code>##   Gene_a Gene_b     Gene_c     Gene_d     Gene_e     Group Genotype
## A      2      1 -0.2138275 -1.2649111 -0.7023189   Control       WT
## B     10      2 -2.9222701 -0.6324555 -0.3025084   Control       WT
## C     11      3 -0.6744831  0.0000000  0.9406374 Treatment   Mutant
## D     13      4 -1.4005780  0.6324555 -0.5611974 Treatment   Mutant
## E      4      5  0.6905400  1.2649111  0.9154688 Treatment       WT</code></pre>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="Rbasic.html#cb132-1" tabindex="-1"></a><span class="co"># 提取出所有的数值列</span></span>
<span id="cb132-2"><a href="Rbasic.html#cb132-2" tabindex="-1"></a>merge_data[<span class="fu">sapply</span>(merge_data, is.numeric)]</span></code></pre></div>
<pre><code>##   Gene_a Gene_b     Gene_c     Gene_d     Gene_e
## A      2      1 -0.2138275 -1.2649111 -0.7023189
## B     10      2 -2.9222701 -0.6324555 -0.3025084
## C     11      3 -0.6744831  0.0000000  0.9406374
## D     13      4 -1.4005780  0.6324555 -0.5611974
## E      4      5  0.6905400  1.2649111  0.9154688</code></pre>
</div>
<div id="str" class="section level3 hasAnchor" number="2.3.6">
<h3><span class="header-section-number">2.3.6</span> <code>str</code>的应用<a href="Rbasic.html#str" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p><code>str</code>: Compactly display the internal <em>str</em>ucture of an R object, a
diagnostic function and an alternative to ‘summary (and to some
extent, ’dput’). Ideally, only one line for each ‘basic’
structure is displayed. It is especially well suited to compactly
display the (abbreviated) contents of (possibly nested) lists.
The idea is to give reasonable output for <em>any</em> R object. It
calls ‘args’ for (non-primitive) function objects.</p>
<p><code>str</code>用来告诉结果的构成方式，对于不少Bioconductor的包，或者复杂的R函数的输出，都是一堆列表的嵌套，<code>str(complex_result)</code>会输出每个列表的名字，方便提取对应的信息。</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="Rbasic.html#cb134-1" tabindex="-1"></a><span class="co"># str的一个应用例子</span></span>
<span id="cb134-2"><a href="Rbasic.html#cb134-2" tabindex="-1"></a><span class="fu">str</span>(<span class="fu">list</span>(<span class="at">a =</span> <span class="st">&quot;A&quot;</span>, <span class="at">L =</span> <span class="fu">as.list</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>)), <span class="at">list.len =</span> <span class="dv">9</span>)</span></code></pre></div>
<pre><code>## List of 2
##  $ a: chr &quot;A&quot;
##  $ L:List of 100
##   ..$ : int 1
##   ..$ : int 2
##   ..$ : int 3
##   ..$ : int 4
##   ..$ : int 5
##   ..$ : int 6
##   ..$ : int 7
##   ..$ : int 8
##   ..$ : int 9
##   .. [list output truncated]</code></pre>
<p>利用<code>str</code>查看<code>pca</code>的结果，具体的<code>PCA</code>应用查看 <a href="http://mp.weixin.qq.com/s/sRElBMkyR9rGa4TQp9KjNQ" class="uri">http://mp.weixin.qq.com/s/sRElBMkyR9rGa4TQp9KjNQ</a>。</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="Rbasic.html#cb136-1" tabindex="-1"></a>pca_result <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(expr)</span>
<span id="cb136-2"><a href="Rbasic.html#cb136-2" tabindex="-1"></a>pca_result</span></code></pre></div>
<pre><code>## Standard deviations (1, .., p=5):
## [1] 4.842700e+00 2.060965e+00 7.007376e-01 5.558627e-01 7.775454e-17
## 
## Rotation (n x k) = (5 x 5):
##                  PC1          PC2        PC3         PC4           PC5
## Gene_a  0.9791016897  0.003788981  0.1719731 -0.10849318  0.000000e+00
## Gene_b  0.0782878704 -0.731231501 -0.4159160  0.02170449 -5.345225e-01
## Gene_c -0.1810480386 -0.420752292  0.6755017 -0.57782918  1.010029e-16
## Gene_d  0.0495135967 -0.462471408 -0.2630484  0.01372713  8.451543e-01
## Gene_e -0.0009497244 -0.272715676  0.5214807  0.80850674 -8.829184e-16</code></pre>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="Rbasic.html#cb138-1" tabindex="-1"></a><span class="fu">str</span>(pca_result)</span></code></pre></div>
<pre><code>## List of 5
##  $ sdev    : num [1:5] 4.84 2.06 7.01e-01 5.56e-01 7.78e-17
##  $ rotation: num [1:5, 1:5] 0.9791 0.07829 -0.18105 0.04951 -0.00095 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:5] &quot;Gene_a&quot; &quot;Gene_b&quot; &quot;Gene_c&quot; &quot;Gene_d&quot; ...
##   .. ..$ : chr [1:5] &quot;PC1&quot; &quot;PC2&quot; &quot;PC3&quot; &quot;PC4&quot; ...
##  $ center  : Named num [1:5] 8.00 3.00 -9.04e-01 4.44e-17 5.80e-02
##   ..- attr(*, &quot;names&quot;)= chr [1:5] &quot;Gene_a&quot; &quot;Gene_b&quot; &quot;Gene_c&quot; &quot;Gene_d&quot; ...
##  $ scale   : logi FALSE
##  $ x       : num [1:5, 1:5] -6.22 2.21 2.89 5.1 -3.99 ...
##   ..- attr(*, &quot;dimnames&quot;)=List of 2
##   .. ..$ : chr [1:5] &quot;A&quot; &quot;B&quot; &quot;C&quot; &quot;D&quot; ...
##   .. ..$ : chr [1:5] &quot;PC1&quot; &quot;PC2&quot; &quot;PC3&quot; &quot;PC4&quot; ...
##  - attr(*, &quot;class&quot;)= chr &quot;prcomp&quot;</code></pre>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="Rbasic.html#cb140-1" tabindex="-1"></a><span class="co"># 取出每个主成分解释的差异</span></span>
<span id="cb140-2"><a href="Rbasic.html#cb140-2" tabindex="-1"></a>pca_result<span class="sc">$</span>sdev</span></code></pre></div>
<pre><code>## [1] 4.842700e+00 2.060965e+00 7.007376e-01 5.558627e-01 7.775454e-17</code></pre>
</div>
<div id="Rpackage" class="section level3 hasAnchor" number="2.3.7">
<h3><span class="header-section-number">2.3.7</span> R的包管理<a href="Rbasic.html#Rpackage" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>什么时候需要安装包</p>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="Rbasic.html#cb142-1" tabindex="-1"></a><span class="fu">library</span>(<span class="st">&#39;unExistedPackage&#39;</span>)</span>
<span id="cb142-2"><a href="Rbasic.html#cb142-2" tabindex="-1"></a>Error <span class="cf">in</span> <span class="fu">library</span>(<span class="st">&quot;unExistedPackage&quot;</span>) <span class="sc">:</span> </span>
<span id="cb142-3"><a href="Rbasic.html#cb142-3" tabindex="-1"></a>  不存在叫‘unExistedPackage’这个名字的程辑包</span></code></pre></div>
<p>如何安装R包</p>
<pre><code>install.packages(&quot;package_name&quot;)
# 指定安装来源
install.packages(&quot;package_name&quot;, repo=&quot;http://cran.us.r-project.org&quot;)

# 安装Bioconductor的包
if (!requireNamespace(&quot;BiocManager&quot;, quietly = TRUE))
      install.packages(&quot;BiocManager&quot;, update = F)
BiocManager::install(c(&quot;RUVSeq&quot;,&quot;pcaMethods&quot;))

# 安装Github的R包
install.packages(&quot;devtools&quot;)
devtools::install_github(&quot;JustinaZ/pcaReduce&quot;)

# 手动安装, 首先下载包的源文件（压缩版就可），然后在终端运行下面的命令。
ct@ysx:~$ R CMD INSTALL package.tar.gz

# 移除包
remove.packages(&quot;package_name&quot;)

# 查看所有安装的包
library()

# 查看特定安装包的版本
installed.packages()[c(&quot;ggplot2&quot;), c(&quot;Package&quot;, &quot;Version&quot;)]

#  Package  Version 
# &quot;ggplot2&quot; &quot;3.3.2&quot; 

# 查看默认安装包的位置
.libPaths()

# 查看已加载的包
.packages()

# 调用安装的包
library(package_name)</code></pre>
<p>自动安装包</p>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="Rbasic.html#cb144-1" tabindex="-1"></a>usePackage <span class="ot">&lt;-</span> <span class="cf">function</span>(p) {</span>
<span id="cb144-2"><a href="Rbasic.html#cb144-2" tabindex="-1"></a>    <span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(p, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb144-3"><a href="Rbasic.html#cb144-3" tabindex="-1"></a>      BiocManager<span class="sc">::</span><span class="fu">install</span>(p, <span class="at">update =</span> F)</span>
<span id="cb144-4"><a href="Rbasic.html#cb144-4" tabindex="-1"></a>    <span class="fu">require</span>(p, <span class="at">character.only =</span> <span class="cn">TRUE</span>)</span>
<span id="cb144-5"><a href="Rbasic.html#cb144-5" tabindex="-1"></a>}</span></code></pre></div>
</div>
</div>
<div id="checkinstalltpackages" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> 检查并安装本教程需要的 R 包<a href="Rbasic.html#checkinstalltpackages" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb145"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb145-1"><a href="Rbasic.html#cb145-1" tabindex="-1"></a>site <span class="ot">=</span> <span class="st">&quot;https://mirrors.tuna.tsinghua.edu.cn/CRAN&quot;</span></span>
<span id="cb145-2"><a href="Rbasic.html#cb145-2" tabindex="-1"></a></span>
<span id="cb145-3"><a href="Rbasic.html#cb145-3" tabindex="-1"></a><span class="co"># options(BioC_mirror = &quot;https://mirrors.tuna.tsinghua.edu.cn/bioconductor&quot;)</span></span>
<span id="cb145-4"><a href="Rbasic.html#cb145-4" tabindex="-1"></a><span class="fu">options</span>(<span class="at">BioC_mirror=</span><span class="st">&quot;https://mirrors.westlake.edu.cn/bioconductor&quot;</span>)</span>
<span id="cb145-5"><a href="Rbasic.html#cb145-5" tabindex="-1"></a></span>
<span id="cb145-6"><a href="Rbasic.html#cb145-6" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="fu">requireNamespace</span>(<span class="st">&quot;BiocManager&quot;</span>, <span class="at">quietly =</span> <span class="cn">TRUE</span>))</span>
<span id="cb145-7"><a href="Rbasic.html#cb145-7" tabindex="-1"></a>  <span class="fu">install.packages</span>(<span class="st">&quot;BiocManager&quot;</span>, <span class="at">repos =</span> site)</span>
<span id="cb145-8"><a href="Rbasic.html#cb145-8" tabindex="-1"></a></span>
<span id="cb145-9"><a href="Rbasic.html#cb145-9" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">rownames</span>(<span class="fu">installed.packages</span>())</span>
<span id="cb145-10"><a href="Rbasic.html#cb145-10" tabindex="-1"></a></span>
<span id="cb145-11"><a href="Rbasic.html#cb145-11" tabindex="-1"></a>install_bioc <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb145-12"><a href="Rbasic.html#cb145-12" tabindex="-1"></a>  <span class="st">&quot;amap&quot;</span>,</span>
<span id="cb145-13"><a href="Rbasic.html#cb145-13" tabindex="-1"></a><span class="st">&quot;BiocParallel&quot;</span>,</span>
<span id="cb145-14"><a href="Rbasic.html#cb145-14" tabindex="-1"></a><span class="st">&quot;cowplot&quot;</span>,</span>
<span id="cb145-15"><a href="Rbasic.html#cb145-15" tabindex="-1"></a><span class="st">&quot;data.table&quot;</span>,</span>
<span id="cb145-16"><a href="Rbasic.html#cb145-16" tabindex="-1"></a><span class="st">&quot;dendextend&quot;</span>,</span>
<span id="cb145-17"><a href="Rbasic.html#cb145-17" tabindex="-1"></a><span class="st">&quot;DESeq2&quot;</span>,</span>
<span id="cb145-18"><a href="Rbasic.html#cb145-18" tabindex="-1"></a><span class="st">&quot;dplyr&quot;</span>,</span>
<span id="cb145-19"><a href="Rbasic.html#cb145-19" tabindex="-1"></a><span class="st">&quot;ggfortify&quot;</span>,</span>
<span id="cb145-20"><a href="Rbasic.html#cb145-20" tabindex="-1"></a><span class="st">&quot;ggplot2&quot;</span>,</span>
<span id="cb145-21"><a href="Rbasic.html#cb145-21" tabindex="-1"></a><span class="st">&quot;ggpubr&quot;</span>,</span>
<span id="cb145-22"><a href="Rbasic.html#cb145-22" tabindex="-1"></a><span class="st">&quot;ggrepel&quot;</span>,</span>
<span id="cb145-23"><a href="Rbasic.html#cb145-23" tabindex="-1"></a><span class="st">&quot;ggstatsplot&quot;</span>,</span>
<span id="cb145-24"><a href="Rbasic.html#cb145-24" tabindex="-1"></a><span class="st">&quot;ggthemes&quot;</span>,</span>
<span id="cb145-25"><a href="Rbasic.html#cb145-25" tabindex="-1"></a><span class="st">&quot;gplots&quot;</span>,</span>
<span id="cb145-26"><a href="Rbasic.html#cb145-26" tabindex="-1"></a><span class="st">&quot;grid&quot;</span>,</span>
<span id="cb145-27"><a href="Rbasic.html#cb145-27" tabindex="-1"></a><span class="st">&quot;gridExtra&quot;</span>,</span>
<span id="cb145-28"><a href="Rbasic.html#cb145-28" tabindex="-1"></a><span class="st">&quot;Hmisc&quot;</span>,</span>
<span id="cb145-29"><a href="Rbasic.html#cb145-29" tabindex="-1"></a><span class="st">&quot;knitr&quot;</span>,</span>
<span id="cb145-30"><a href="Rbasic.html#cb145-30" tabindex="-1"></a><span class="st">&quot;limma&quot;</span>,</span>
<span id="cb145-31"><a href="Rbasic.html#cb145-31" tabindex="-1"></a><span class="st">&quot;patchwork&quot;</span>,</span>
<span id="cb145-32"><a href="Rbasic.html#cb145-32" tabindex="-1"></a><span class="st">&quot;pheatmap&quot;</span>,</span>
<span id="cb145-33"><a href="Rbasic.html#cb145-33" tabindex="-1"></a><span class="st">&quot;plyr &quot;</span>,</span>
<span id="cb145-34"><a href="Rbasic.html#cb145-34" tabindex="-1"></a><span class="st">&quot;psych&quot;</span>,</span>
<span id="cb145-35"><a href="Rbasic.html#cb145-35" tabindex="-1"></a><span class="st">&quot;RColorBrewer&quot;</span>,</span>
<span id="cb145-36"><a href="Rbasic.html#cb145-36" tabindex="-1"></a><span class="st">&quot;reshape2&quot;</span>,</span>
<span id="cb145-37"><a href="Rbasic.html#cb145-37" tabindex="-1"></a><span class="st">&quot;scatterplot3d&quot;</span>,</span>
<span id="cb145-38"><a href="Rbasic.html#cb145-38" tabindex="-1"></a><span class="st">&quot;showtext&quot;</span>,</span>
<span id="cb145-39"><a href="Rbasic.html#cb145-39" tabindex="-1"></a><span class="st">&quot;stringr&quot;</span>,</span>
<span id="cb145-40"><a href="Rbasic.html#cb145-40" tabindex="-1"></a><span class="st">&quot;survival&quot;</span>,</span>
<span id="cb145-41"><a href="Rbasic.html#cb145-41" tabindex="-1"></a><span class="st">&quot;survminer&quot;</span>,</span>
<span id="cb145-42"><a href="Rbasic.html#cb145-42" tabindex="-1"></a><span class="st">&quot;sva&quot;</span>,</span>
<span id="cb145-43"><a href="Rbasic.html#cb145-43" tabindex="-1"></a><span class="st">&quot;tidyr&quot;</span>,</span>
<span id="cb145-44"><a href="Rbasic.html#cb145-44" tabindex="-1"></a><span class="st">&quot;tidyverse&quot;</span>,</span>
<span id="cb145-45"><a href="Rbasic.html#cb145-45" tabindex="-1"></a><span class="st">&quot;UpSetR&quot;</span>,</span>
<span id="cb145-46"><a href="Rbasic.html#cb145-46" tabindex="-1"></a><span class="st">&quot;useful&quot;</span>,</span>
<span id="cb145-47"><a href="Rbasic.html#cb145-47" tabindex="-1"></a><span class="st">&quot;VennDiagram&quot;</span></span>
<span id="cb145-48"><a href="Rbasic.html#cb145-48" tabindex="-1"></a>)</span>
<span id="cb145-49"><a href="Rbasic.html#cb145-49" tabindex="-1"></a></span>
<span id="cb145-50"><a href="Rbasic.html#cb145-50" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> install_bioc) {</span>
<span id="cb145-51"><a href="Rbasic.html#cb145-51" tabindex="-1"></a>  <span class="cf">if</span> (<span class="sc">!</span>i <span class="sc">%in%</span> a)</span>
<span id="cb145-52"><a href="Rbasic.html#cb145-52" tabindex="-1"></a>    BiocManager<span class="sc">::</span><span class="fu">install</span>(i)</span>
<span id="cb145-53"><a href="Rbasic.html#cb145-53" tabindex="-1"></a>}</span></code></pre></div>
<pre><code>## &#39;getOption(&quot;repos&quot;)&#39; replaces Bioconductor standard repositories, see
## &#39;help(&quot;repositories&quot;, package = &quot;BiocManager&quot;)&#39; for details.
## Replacement repositories:
##     CRAN: https://cran.rstudio.com/</code></pre>
<pre><code>## Bioconductor version 3.20 (BiocManager 1.30.26), R 4.4.2 (2024-10-31)</code></pre>
<pre><code>## Installing package(s) &#39;plyr &#39;</code></pre>
<pre><code>## Old packages: &#39;DOSE&#39;, &#39;edgeR&#39;, &#39;fgsea&#39;, &#39;GenomeInfoDb&#39;, &#39;gert&#39;, &#39;ggbeeswarm&#39;,
##   &#39;ggsci&#39;, &#39;igraph&#39;, &#39;IRanges&#39;, &#39;lava&#39;, &#39;limma&#39;, &#39;microeco&#39;, &#39;multcomp&#39;,
##   &#39;parallelly&#39;, &#39;promises&#39;, &#39;reformulas&#39;, &#39;reticulate&#39;, &#39;rvest&#39;, &#39;vroom&#39;,
##   &#39;xfun&#39;, &#39;xml2&#39;</code></pre>
<pre><code>## &#39;getOption(&quot;repos&quot;)&#39; replaces Bioconductor standard repositories, see
## &#39;help(&quot;repositories&quot;, package = &quot;BiocManager&quot;)&#39; for details.
## Replacement repositories:
##     CRAN: https://cran.rstudio.com/</code></pre>
<pre><code>## Bioconductor version 3.20 (BiocManager 1.30.26), R 4.4.2 (2024-10-31)</code></pre>
<pre><code>## Installing package(s) &#39;showtext&#39;</code></pre>
<pre><code>## also installing the dependencies &#39;sysfonts&#39;, &#39;showtextdb&#39;</code></pre>
<pre><code>## 
## The downloaded binary packages are in
##  /var/folders/_b/tnc424qj6g9f8xvfhmvdr0h00000gn/T//RtmpWuDZJM/downloaded_packages</code></pre>
<pre><code>## Old packages: &#39;DOSE&#39;, &#39;edgeR&#39;, &#39;fgsea&#39;, &#39;GenomeInfoDb&#39;, &#39;gert&#39;, &#39;ggbeeswarm&#39;,
##   &#39;ggsci&#39;, &#39;igraph&#39;, &#39;IRanges&#39;, &#39;lava&#39;, &#39;limma&#39;, &#39;microeco&#39;, &#39;multcomp&#39;,
##   &#39;parallelly&#39;, &#39;promises&#39;, &#39;reformulas&#39;, &#39;reticulate&#39;, &#39;rvest&#39;, &#39;vroom&#39;,
##   &#39;xfun&#39;, &#39;xml2&#39;</code></pre>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="Rbasic.html#cb156-1" tabindex="-1"></a>installed_packages <span class="ot">=</span> <span class="fu">installed.packages</span>()</span>
<span id="cb156-2"><a href="Rbasic.html#cb156-2" tabindex="-1"></a></span>
<span id="cb156-3"><a href="Rbasic.html#cb156-3" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="st">&quot;ggbeeswarm&quot;</span> <span class="sc">%in%</span> a){</span>
<span id="cb156-4"><a href="Rbasic.html#cb156-4" tabindex="-1"></a>   <span class="fu">install.packages</span>(<span class="st">&quot;https://cran.r-project.org/src/contrib/Archive/ggbeeswarm/ggbeeswarm_0.6.0.tar.gz&quot;</span>, <span class="at">repos =</span> <span class="cn">NULL</span>, <span class="at">type =</span> <span class="st">&quot;source&quot;</span>)</span>
<span id="cb156-5"><a href="Rbasic.html#cb156-5" tabindex="-1"></a>} <span class="cf">else</span> {</span>
<span id="cb156-6"><a href="Rbasic.html#cb156-6" tabindex="-1"></a>  <span class="cf">if</span> (installed_packages[<span class="st">&quot;ggbeeswarm&quot;</span>,<span class="st">&quot;Version&quot;</span>] <span class="sc">!=</span> <span class="st">&quot;0.6.0&quot;</span>) {</span>
<span id="cb156-7"><a href="Rbasic.html#cb156-7" tabindex="-1"></a>    <span class="fu">install.packages</span>(<span class="st">&quot;https://cran.r-project.org/src/contrib/Archive/ggbeeswarm/ggbeeswarm_0.6.0.tar.gz&quot;</span>, <span class="at">repos =</span> <span class="cn">NULL</span>, <span class="at">type =</span> <span class="st">&quot;source&quot;</span>)</span>
<span id="cb156-8"><a href="Rbasic.html#cb156-8" tabindex="-1"></a>  }</span>
<span id="cb156-9"><a href="Rbasic.html#cb156-9" tabindex="-1"></a>}</span>
<span id="cb156-10"><a href="Rbasic.html#cb156-10" tabindex="-1"></a></span>
<span id="cb156-11"><a href="Rbasic.html#cb156-11" tabindex="-1"></a><span class="cf">if</span> (<span class="sc">!</span><span class="st">&quot;ImageGP&quot;</span> <span class="sc">%in%</span> a) {</span>
<span id="cb156-12"><a href="Rbasic.html#cb156-12" tabindex="-1"></a>  <span class="co"># devtools::install_github(&quot;Tong-Chen/ImageGP&quot;)</span></span>
<span id="cb156-13"><a href="Rbasic.html#cb156-13" tabindex="-1"></a>  devtools<span class="sc">::</span><span class="fu">install_git</span>(<span class="st">&quot;https://gitee.com/ct5869/ImageGP.git&quot;</span>)</span>
<span id="cb156-14"><a href="Rbasic.html#cb156-14" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="ggplot2_plot" class="section level2 hasAnchor" number="2.5">
<h2><span class="header-section-number">2.5</span> ggplot2绘图<a href="Rbasic.html#ggplot2_plot" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<div class="sourceCode" id="cb157"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb157-1"><a href="Rbasic.html#cb157-1" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="st">&quot;Gene;Sample;Group;Abundance</span></span>
<span id="cb157-2"><a href="Rbasic.html#cb157-2" tabindex="-1"></a><span class="st">Gene1;KO1;KO;1.2</span></span>
<span id="cb157-3"><a href="Rbasic.html#cb157-3" tabindex="-1"></a><span class="st">Gene2;KO1;KO;1.4</span></span>
<span id="cb157-4"><a href="Rbasic.html#cb157-4" tabindex="-1"></a><span class="st">Gene3;KO1;KO;16</span></span>
<span id="cb157-5"><a href="Rbasic.html#cb157-5" tabindex="-1"></a><span class="st">Gene4;KO1;KO;10</span></span>
<span id="cb157-6"><a href="Rbasic.html#cb157-6" tabindex="-1"></a><span class="st">Gene5;KO1;KO;25</span></span>
<span id="cb157-7"><a href="Rbasic.html#cb157-7" tabindex="-1"></a><span class="st">Gene6;KO1;KO;30</span></span>
<span id="cb157-8"><a href="Rbasic.html#cb157-8" tabindex="-1"></a><span class="st">Gene7;KO1;KO;2</span></span>
<span id="cb157-9"><a href="Rbasic.html#cb157-9" tabindex="-1"></a><span class="st">Gene8;KO1;KO;3</span></span>
<span id="cb157-10"><a href="Rbasic.html#cb157-10" tabindex="-1"></a><span class="st">Gene1;KO2;KO;1.2</span></span>
<span id="cb157-11"><a href="Rbasic.html#cb157-11" tabindex="-1"></a><span class="st">Gene2;KO2;KO;1.4</span></span>
<span id="cb157-12"><a href="Rbasic.html#cb157-12" tabindex="-1"></a><span class="st">Gene3;KO2;KO;16</span></span>
<span id="cb157-13"><a href="Rbasic.html#cb157-13" tabindex="-1"></a><span class="st">Gene4;KO2;KO;10</span></span>
<span id="cb157-14"><a href="Rbasic.html#cb157-14" tabindex="-1"></a><span class="st">Gene5;KO2;KO;25</span></span>
<span id="cb157-15"><a href="Rbasic.html#cb157-15" tabindex="-1"></a><span class="st">Gene6;KO2;KO;30</span></span>
<span id="cb157-16"><a href="Rbasic.html#cb157-16" tabindex="-1"></a><span class="st">Gene7;KO2;KO;2</span></span>
<span id="cb157-17"><a href="Rbasic.html#cb157-17" tabindex="-1"></a><span class="st">Gene8;KO2;KO;3</span></span>
<span id="cb157-18"><a href="Rbasic.html#cb157-18" tabindex="-1"></a><span class="st">Gene1;KO3;KO;1.2</span></span>
<span id="cb157-19"><a href="Rbasic.html#cb157-19" tabindex="-1"></a><span class="st">Gene2;KO3;KO;1.4</span></span>
<span id="cb157-20"><a href="Rbasic.html#cb157-20" tabindex="-1"></a><span class="st">Gene3;KO3;KO;16</span></span>
<span id="cb157-21"><a href="Rbasic.html#cb157-21" tabindex="-1"></a><span class="st">Gene4;KO3;KO;10</span></span>
<span id="cb157-22"><a href="Rbasic.html#cb157-22" tabindex="-1"></a><span class="st">Gene5;KO3;KO;25</span></span>
<span id="cb157-23"><a href="Rbasic.html#cb157-23" tabindex="-1"></a><span class="st">Gene6;KO3;KO;30</span></span>
<span id="cb157-24"><a href="Rbasic.html#cb157-24" tabindex="-1"></a><span class="st">Gene7;KO3;KO;2</span></span>
<span id="cb157-25"><a href="Rbasic.html#cb157-25" tabindex="-1"></a><span class="st">Gene8;KO3;KO;3</span></span>
<span id="cb157-26"><a href="Rbasic.html#cb157-26" tabindex="-1"></a><span class="st">Gene8;WT1;WT;1.2</span></span>
<span id="cb157-27"><a href="Rbasic.html#cb157-27" tabindex="-1"></a><span class="st">Gene7;WT1;WT;1.4</span></span>
<span id="cb157-28"><a href="Rbasic.html#cb157-28" tabindex="-1"></a><span class="st">Gene6;WT1;WT;16</span></span>
<span id="cb157-29"><a href="Rbasic.html#cb157-29" tabindex="-1"></a><span class="st">Gene5;WT1;WT;10</span></span>
<span id="cb157-30"><a href="Rbasic.html#cb157-30" tabindex="-1"></a><span class="st">Gene4;WT1;WT;25</span></span>
<span id="cb157-31"><a href="Rbasic.html#cb157-31" tabindex="-1"></a><span class="st">Gene3;WT1;WT;30</span></span>
<span id="cb157-32"><a href="Rbasic.html#cb157-32" tabindex="-1"></a><span class="st">Gene2;WT1;WT;2</span></span>
<span id="cb157-33"><a href="Rbasic.html#cb157-33" tabindex="-1"></a><span class="st">Gene1;WT1;WT;3</span></span>
<span id="cb157-34"><a href="Rbasic.html#cb157-34" tabindex="-1"></a><span class="st">Gene8;WT2;WT;1.2</span></span>
<span id="cb157-35"><a href="Rbasic.html#cb157-35" tabindex="-1"></a><span class="st">Gene7;WT2;WT;1.4</span></span>
<span id="cb157-36"><a href="Rbasic.html#cb157-36" tabindex="-1"></a><span class="st">Gene6;WT2;WT;16</span></span>
<span id="cb157-37"><a href="Rbasic.html#cb157-37" tabindex="-1"></a><span class="st">Gene5;WT2;WT;10</span></span>
<span id="cb157-38"><a href="Rbasic.html#cb157-38" tabindex="-1"></a><span class="st">Gene4;WT2;WT;25</span></span>
<span id="cb157-39"><a href="Rbasic.html#cb157-39" tabindex="-1"></a><span class="st">Gene3;WT2;WT;30</span></span>
<span id="cb157-40"><a href="Rbasic.html#cb157-40" tabindex="-1"></a><span class="st">Gene2;WT2;WT;2</span></span>
<span id="cb157-41"><a href="Rbasic.html#cb157-41" tabindex="-1"></a><span class="st">Gene1;WT2;WT;3</span></span>
<span id="cb157-42"><a href="Rbasic.html#cb157-42" tabindex="-1"></a><span class="st">Gene8;WT3;WT;1.2</span></span>
<span id="cb157-43"><a href="Rbasic.html#cb157-43" tabindex="-1"></a><span class="st">Gene7;WT3;WT;1.4</span></span>
<span id="cb157-44"><a href="Rbasic.html#cb157-44" tabindex="-1"></a><span class="st">Gene6;WT3;WT;16</span></span>
<span id="cb157-45"><a href="Rbasic.html#cb157-45" tabindex="-1"></a><span class="st">Gene5;WT3;WT;10</span></span>
<span id="cb157-46"><a href="Rbasic.html#cb157-46" tabindex="-1"></a><span class="st">Gene4;WT3;WT;25</span></span>
<span id="cb157-47"><a href="Rbasic.html#cb157-47" tabindex="-1"></a><span class="st">Gene3;WT3;WT;30</span></span>
<span id="cb157-48"><a href="Rbasic.html#cb157-48" tabindex="-1"></a><span class="st">Gene2;WT3;WT;2</span></span>
<span id="cb157-49"><a href="Rbasic.html#cb157-49" tabindex="-1"></a><span class="st">Gene1;WT3;WT;3&quot;</span></span>
<span id="cb157-50"><a href="Rbasic.html#cb157-50" tabindex="-1"></a></span>
<span id="cb157-51"><a href="Rbasic.html#cb157-51" tabindex="-1"></a>data <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">text=</span>data, <span class="at">header=</span>T, <span class="at">row.names=</span><span class="cn">NULL</span>, <span class="at">sep=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb157-52"><a href="Rbasic.html#cb157-52" tabindex="-1"></a></span>
<span id="cb157-53"><a href="Rbasic.html#cb157-53" tabindex="-1"></a>data[<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(data),<span class="dv">6</span>),]</span></code></pre></div>
<pre><code>##     Gene Sample Group Abundance
## 32 Gene1    WT1    WT       3.0
## 41 Gene8    WT3    WT       1.2
## 48 Gene1    WT3    WT       3.0
## 16 Gene8    KO2    KO       3.0
## 11 Gene3    KO2    KO      16.0
## 5  Gene5    KO1    KO      25.0</code></pre>
<div class="sourceCode" id="cb159"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb159-1"><a href="Rbasic.html#cb159-1" tabindex="-1"></a><span class="co"># 加载包</span></span>
<span id="cb159-2"><a href="Rbasic.html#cb159-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<p>初始化ggplot，建立坐标系</p>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="Rbasic.html#cb160-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>Sample, <span class="at">y=</span>Gene))</span>
<span id="cb160-2"><a href="Rbasic.html#cb160-2" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-76-1.png" width="100%" style="display: block; margin: auto;" />
绘制几何属性</p>
<div class="sourceCode" id="cb161"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb161-1"><a href="Rbasic.html#cb161-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>()</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-77-1.png" width="100%" style="display: block; margin: auto;" />
映射数据到几何形状的属性，如颜色</p>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="Rbasic.html#cb162-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Abundance))</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-78-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>映射数据到几何形状的属性，如大小</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="Rbasic.html#cb163-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">size=</span>Abundance))</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-79-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>自定义颜色</p>
<div class="sourceCode" id="cb164"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb164-1"><a href="Rbasic.html#cb164-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Abundance)) <span class="sc">+</span> <span class="fu">scale_color_continuous</span>(<span class="at">low=</span><span class="st">&quot;green&quot;</span>, <span class="at">high=</span><span class="st">&quot;red&quot;</span>)</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-80-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>设置主题属性</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="Rbasic.html#cb165-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Abundance)) <span class="sc">+</span> <span class="fu">scale_color_continuous</span>(<span class="at">low=</span><span class="st">&quot;green&quot;</span>, <span class="at">high=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-81-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>放大点，并添加文字作为label</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb166-1"><a href="Rbasic.html#cb166-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Abundance), <span class="at">size=</span><span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb166-2"><a href="Rbasic.html#cb166-2" tabindex="-1"></a>                 <span class="fu">scale_color_continuous</span>(<span class="at">low=</span><span class="st">&quot;green&quot;</span>, <span class="at">high=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb166-3"><a href="Rbasic.html#cb166-3" tabindex="-1"></a>                 <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>Abundance)) <span class="sc">+</span></span>
<span id="cb166-4"><a href="Rbasic.html#cb166-4" tabindex="-1"></a>                 <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-82-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>自定义注释</p>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="Rbasic.html#cb167-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">color=</span>Abundance), <span class="at">size=</span><span class="dv">10</span>) <span class="sc">+</span> </span>
<span id="cb167-2"><a href="Rbasic.html#cb167-2" tabindex="-1"></a>  <span class="fu">scale_color_continuous</span>(<span class="at">low=</span><span class="st">&quot;green&quot;</span>, <span class="at">high=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb167-3"><a href="Rbasic.html#cb167-3" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>Abundance)) <span class="sc">+</span></span>
<span id="cb167-4"><a href="Rbasic.html#cb167-4" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">&quot;rect&quot;</span>,<span class="at">xmin=</span><span class="fl">0.5</span>, <span class="at">xmax=</span><span class="fl">3.5</span>, <span class="at">ymin=</span><span class="fl">5.5</span>,<span class="at">ymax=</span><span class="fl">6.5</span>,<span class="at">alpha=</span><span class="fl">0.2</span>) <span class="sc">+</span> </span>
<span id="cb167-5"><a href="Rbasic.html#cb167-5" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-83-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>绘制热图</p>
<div class="sourceCode" id="cb168"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb168-1"><a href="Rbasic.html#cb168-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Abundance)) <span class="sc">+</span> </span>
<span id="cb168-2"><a href="Rbasic.html#cb168-2" tabindex="-1"></a>  <span class="fu">scale_fill_continuous</span>(<span class="at">low=</span><span class="st">&quot;green&quot;</span>, <span class="at">high=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb168-3"><a href="Rbasic.html#cb168-3" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>Abundance)) <span class="sc">+</span></span>
<span id="cb168-4"><a href="Rbasic.html#cb168-4" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-84-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>转换坐标系</p>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="Rbasic.html#cb169-1" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Abundance)) <span class="sc">+</span> </span>
<span id="cb169-2"><a href="Rbasic.html#cb169-2" tabindex="-1"></a>  <span class="fu">scale_fill_gradient</span>(<span class="at">low =</span> <span class="st">&quot;white&quot;</span>, <span class="at">high =</span> <span class="st">&quot;steelblue&quot;</span>) <span class="sc">+</span></span>
<span id="cb169-3"><a href="Rbasic.html#cb169-3" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>Abundance)) <span class="sc">+</span></span>
<span id="cb169-4"><a href="Rbasic.html#cb169-4" tabindex="-1"></a>  <span class="fu">coord_polar</span>(<span class="at">theta=</span><span class="st">&quot;x&quot;</span>) <span class="sc">+</span> </span>
<span id="cb169-5"><a href="Rbasic.html#cb169-5" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.background=</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-6"><a href="Rbasic.html#cb169-6" tabindex="-1"></a>           <span class="at">axis.title=</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-7"><a href="Rbasic.html#cb169-7" tabindex="-1"></a>           <span class="at">panel.grid=</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-8"><a href="Rbasic.html#cb169-8" tabindex="-1"></a>           <span class="at">axis.ticks=</span><span class="fu">element_blank</span>(),</span>
<span id="cb169-9"><a href="Rbasic.html#cb169-9" tabindex="-1"></a>           <span class="at">axis.text.y=</span><span class="fu">element_text</span>(<span class="at">size=</span><span class="dv">5</span>))</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-85-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>更改横轴的顺序</p>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="Rbasic.html#cb170-1" tabindex="-1"></a><span class="co"># paste0(rep(c(&quot;WT&quot;,&quot;KO&quot;),each=3), rep(1:3))</span></span>
<span id="cb170-2"><a href="Rbasic.html#cb170-2" tabindex="-1"></a>data<span class="sc">$</span>Sample <span class="ot">&lt;-</span> <span class="fu">factor</span>(data<span class="sc">$</span>Sample,<span class="at">levels=</span><span class="fu">c</span>(<span class="st">&quot;WT1&quot;</span>,<span class="st">&quot;WT2&quot;</span>,<span class="st">&quot;WT3&quot;</span>,<span class="st">&quot;KO1&quot;</span>,<span class="st">&quot;KO2&quot;</span>,<span class="st">&quot;KO3&quot;</span>), <span class="at">ordered=</span>T)</span>
<span id="cb170-3"><a href="Rbasic.html#cb170-3" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>Sample, <span class="at">y=</span>Gene)) <span class="sc">+</span> </span>
<span id="cb170-4"><a href="Rbasic.html#cb170-4" tabindex="-1"></a>  <span class="fu">geom_tile</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Abundance)) <span class="sc">+</span> </span>
<span id="cb170-5"><a href="Rbasic.html#cb170-5" tabindex="-1"></a>  <span class="fu">scale_fill_continuous</span>(<span class="at">low=</span><span class="st">&quot;green&quot;</span>, <span class="at">high=</span><span class="st">&quot;red&quot;</span>) <span class="sc">+</span> </span>
<span id="cb170-6"><a href="Rbasic.html#cb170-6" tabindex="-1"></a>  <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>Abundance)) <span class="sc">+</span></span>
<span id="cb170-7"><a href="Rbasic.html#cb170-7" tabindex="-1"></a>  <span class="fu">theme_classic</span>()</span>
<span id="cb170-8"><a href="Rbasic.html#cb170-8" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-86-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>箱线图展示</p>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="Rbasic.html#cb171-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>Sample, <span class="at">y=</span>Abundance)) <span class="sc">+</span> </span>
<span id="cb171-2"><a href="Rbasic.html#cb171-2" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Group))</span>
<span id="cb171-3"><a href="Rbasic.html#cb171-3" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-87-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>小提琴图加点的连线</p>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="Rbasic.html#cb172-1" tabindex="-1"></a><span class="co"># geom_line把同一个Gene的数据作为一组</span></span>
<span id="cb172-2"><a href="Rbasic.html#cb172-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data, <span class="fu">aes</span>(<span class="at">x=</span>Group, <span class="at">y=</span>Abundance)) <span class="sc">+</span> </span>
<span id="cb172-3"><a href="Rbasic.html#cb172-3" tabindex="-1"></a>  <span class="fu">geom_violin</span>(<span class="fu">aes</span>(<span class="at">fill=</span>Group), <span class="at">alpha=</span><span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb172-4"><a href="Rbasic.html#cb172-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group=</span>Gene), <span class="at">alpha=</span><span class="fl">0.5</span>)</span>
<span id="cb172-5"><a href="Rbasic.html#cb172-5" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-88-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="Rbasic.html#cb173-1" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb173-2"><a href="Rbasic.html#cb173-2" tabindex="-1"></a><span class="fu">ggviolin</span>(data, <span class="at">x=</span><span class="st">&quot;Group&quot;</span>, <span class="at">y=</span><span class="st">&quot;Abundance&quot;</span>, <span class="at">fill=</span><span class="st">&quot;Group&quot;</span>, <span class="at">palette =</span> <span class="st">&quot;npg&quot;</span>, <span class="at">add=</span><span class="fu">c</span>(<span class="st">&quot;jitter&quot;</span>)) <span class="sc">+</span> <span class="fu">stat_compare_means</span>(<span class="at">comparisons =</span> <span class="fu">list</span>(<span class="fu">c</span>(<span class="st">&quot;KO&quot;</span>, <span class="st">&quot;WT&quot;</span>)))</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-89-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div id="matrixFormat" class="section level3 hasAnchor" number="2.5.1">
<h3><span class="header-section-number">2.5.1</span> 数据格式转换和字符串处理<a href="Rbasic.html#matrixFormat" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>假如我们的数据如下形式，如何完成上面的图的绘制？</p>
<pre><code>KO1;KO2;KO3;WT1;WT2;WT3
Gene1;1.2;1.2;1.2;3.0;3.0;3.0
Gene2;1.4;1.4;1.4;2.0;2.0;2.0
Gene3;16.0;16.0;16.0;30.0;30.0;30.0
Gene4;10.0;10.0;10.0;25.0;25.0;25.0
Gene5;25.0;25.0;25.0;10.0;10.0;10.0
Gene6;30.0;30.0;30.0;16.0;16.0;16.0
Gene7;2.0;2.0;2.0;1.4;1.4;1.4
Gene8;3.0;3.0;3.0;1.2;1.2;1.2</code></pre>
<p>读入数据，查看数据格式 (注意：<code>read.table</code>中参数与之前的不同地方在哪？为什么？)</p>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="Rbasic.html#cb175-1" tabindex="-1"></a>data_matrix <span class="ot">=</span> <span class="st">&quot;KO1;KO2;KO3;WT1;WT2;WT3</span></span>
<span id="cb175-2"><a href="Rbasic.html#cb175-2" tabindex="-1"></a><span class="st">Gene1;1.3;1.2;1.4;3.1;3.2;3.3</span></span>
<span id="cb175-3"><a href="Rbasic.html#cb175-3" tabindex="-1"></a><span class="st">Gene2;1.1;1.9;1.6;2.3;2.2;2.1</span></span>
<span id="cb175-4"><a href="Rbasic.html#cb175-4" tabindex="-1"></a><span class="st">Gene3;16.8;17.0;18.0;33.0;30.0;35.0</span></span>
<span id="cb175-5"><a href="Rbasic.html#cb175-5" tabindex="-1"></a><span class="st">Gene4;11.0;13.0;12.0;25.0;26.0;28.0</span></span>
<span id="cb175-6"><a href="Rbasic.html#cb175-6" tabindex="-1"></a><span class="st">Gene5;20.0;25.0;23.0;9.0;10.0;13.0</span></span>
<span id="cb175-7"><a href="Rbasic.html#cb175-7" tabindex="-1"></a><span class="st">Gene6;33.0;30.0;35.0;16.0;17.0;16.0</span></span>
<span id="cb175-8"><a href="Rbasic.html#cb175-8" tabindex="-1"></a><span class="st">Gene7;2.0;2.3;2.0;1.4;1.8;1.4</span></span>
<span id="cb175-9"><a href="Rbasic.html#cb175-9" tabindex="-1"></a><span class="st">Gene8;3.0;3.6;3.0;1.2;1.9;1.2&quot;</span></span>
<span id="cb175-10"><a href="Rbasic.html#cb175-10" tabindex="-1"></a>data_matrix <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">text=</span>data_matrix, <span class="at">header=</span>T, <span class="at">row.names=</span><span class="dv">1</span>, <span class="at">sep=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb175-11"><a href="Rbasic.html#cb175-11" tabindex="-1"></a>data_matrix</span></code></pre></div>
<pre><code>##        KO1  KO2  KO3  WT1  WT2  WT3
## Gene1  1.3  1.2  1.4  3.1  3.2  3.3
## Gene2  1.1  1.9  1.6  2.3  2.2  2.1
## Gene3 16.8 17.0 18.0 33.0 30.0 35.0
## Gene4 11.0 13.0 12.0 25.0 26.0 28.0
## Gene5 20.0 25.0 23.0  9.0 10.0 13.0
## Gene6 33.0 30.0 35.0 16.0 17.0 16.0
## Gene7  2.0  2.3  2.0  1.4  1.8  1.4
## Gene8  3.0  3.6  3.0  1.2  1.9  1.2</code></pre>
<p>宽矩阵转换为长矩阵</p>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="Rbasic.html#cb177-1" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb177-2"><a href="Rbasic.html#cb177-2" tabindex="-1"></a></span>
<span id="cb177-3"><a href="Rbasic.html#cb177-3" tabindex="-1"></a>data_matrix<span class="sc">$</span>Gene <span class="ot">&lt;-</span> <span class="fu">rownames</span>(data_matrix) </span>
<span id="cb177-4"><a href="Rbasic.html#cb177-4" tabindex="-1"></a></span>
<span id="cb177-5"><a href="Rbasic.html#cb177-5" tabindex="-1"></a>data_matrix_long <span class="ot">&lt;-</span> <span class="fu">gather</span>(data_matrix, <span class="at">key=</span><span class="st">&quot;Sample&quot;</span>, <span class="at">value=</span><span class="st">&quot;Abundance&quot;</span>, <span class="sc">-</span>Gene)</span>
<span id="cb177-6"><a href="Rbasic.html#cb177-6" tabindex="-1"></a></span>
<span id="cb177-7"><a href="Rbasic.html#cb177-7" tabindex="-1"></a><span class="fu">head</span>(data_matrix_long)</span></code></pre></div>
<pre><code>##    Gene Sample Abundance
## 1 Gene1    KO1       1.3
## 2 Gene2    KO1       1.1
## 3 Gene3    KO1      16.8
## 4 Gene4    KO1      11.0
## 5 Gene5    KO1      20.0
## 6 Gene6    KO1      33.0</code></pre>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="Rbasic.html#cb179-1" tabindex="-1"></a>data_matrix_long <span class="ot">&lt;-</span> data_matrix_long <span class="sc">%&gt;%</span> <span class="fu">separate</span>(<span class="st">&quot;Sample&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Group&quot;</span>, <span class="st">&quot;Rep&quot;</span>), <span class="at">sep=</span><span class="dv">2</span>, <span class="at">remove=</span>F)</span>
<span id="cb179-2"><a href="Rbasic.html#cb179-2" tabindex="-1"></a></span>
<span id="cb179-3"><a href="Rbasic.html#cb179-3" tabindex="-1"></a><span class="fu">head</span>(data_matrix_long)</span></code></pre></div>
<pre><code>##    Gene Sample Group Rep Abundance
## 1 Gene1    KO1    KO   1       1.3
## 2 Gene2    KO1    KO   1       1.1
## 3 Gene3    KO1    KO   1      16.8
## 4 Gene4    KO1    KO   1      11.0
## 5 Gene5    KO1    KO   1      20.0
## 6 Gene6    KO1    KO   1      33.0</code></pre>
<p>获取分组信息 (分组名字等长)</p>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="Rbasic.html#cb181-1" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb181-2"><a href="Rbasic.html#cb181-2" tabindex="-1"></a>data_matrix_long<span class="sc">$</span>Group2 <span class="ot">&lt;-</span> <span class="fu">str_sub</span>(data_matrix_long<span class="sc">$</span>Sample,<span class="at">start=</span><span class="dv">1</span>,<span class="at">end=</span><span class="dv">2</span>)</span>
<span id="cb181-3"><a href="Rbasic.html#cb181-3" tabindex="-1"></a></span>
<span id="cb181-4"><a href="Rbasic.html#cb181-4" tabindex="-1"></a><span class="fu">head</span>(data_matrix_long)</span></code></pre></div>
<p>另外一种拆分样本名字的方式 (分组名字和生物重复之间分隔符固定)</p>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="Rbasic.html#cb182-1" tabindex="-1"></a><span class="fu">library</span>(stringr)</span>
<span id="cb182-2"><a href="Rbasic.html#cb182-2" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb182-3"><a href="Rbasic.html#cb182-3" tabindex="-1"></a></span>
<span id="cb182-4"><a href="Rbasic.html#cb182-4" tabindex="-1"></a>data_matrix2 <span class="ot">=</span> <span class="st">&quot;KO_1;KO_2;KO_3;WT_1;WT_2;WT_3</span></span>
<span id="cb182-5"><a href="Rbasic.html#cb182-5" tabindex="-1"></a><span class="st">Gene1;1.3;1.2;1.4;3.1;3.2;3.3</span></span>
<span id="cb182-6"><a href="Rbasic.html#cb182-6" tabindex="-1"></a><span class="st">Gene2;1.1;1.9;1.6;2.3;2.2;2.1</span></span>
<span id="cb182-7"><a href="Rbasic.html#cb182-7" tabindex="-1"></a><span class="st">Gene3;16.8;17.0;18.0;33.0;30.0;35.0</span></span>
<span id="cb182-8"><a href="Rbasic.html#cb182-8" tabindex="-1"></a><span class="st">Gene4;11.0;13.0;12.0;25.0;26.0;28.0</span></span>
<span id="cb182-9"><a href="Rbasic.html#cb182-9" tabindex="-1"></a><span class="st">Gene5;20.0;25.0;23.0;9.0;10.0;13.0</span></span>
<span id="cb182-10"><a href="Rbasic.html#cb182-10" tabindex="-1"></a><span class="st">Gene6;33.0;30.0;35.0;16.0;17.0;16.0</span></span>
<span id="cb182-11"><a href="Rbasic.html#cb182-11" tabindex="-1"></a><span class="st">Gene7;2.0;2.3;2.0;1.4;1.8;1.4</span></span>
<span id="cb182-12"><a href="Rbasic.html#cb182-12" tabindex="-1"></a><span class="st">Gene8;3.0;3.6;3.0;1.2;1.9;1.2&quot;</span></span>
<span id="cb182-13"><a href="Rbasic.html#cb182-13" tabindex="-1"></a>data_matrix2 <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">text=</span>data_matrix2, <span class="at">header=</span>T, <span class="at">row.names=</span><span class="dv">1</span>, <span class="at">sep=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb182-14"><a href="Rbasic.html#cb182-14" tabindex="-1"></a></span>
<span id="cb182-15"><a href="Rbasic.html#cb182-15" tabindex="-1"></a>data_matrix2<span class="sc">$</span>Gene <span class="ot">&lt;-</span> <span class="fu">rownames</span>(data_matrix2) </span>
<span id="cb182-16"><a href="Rbasic.html#cb182-16" tabindex="-1"></a></span>
<span id="cb182-17"><a href="Rbasic.html#cb182-17" tabindex="-1"></a>data_matrix_long2 <span class="ot">&lt;-</span> <span class="fu">gather</span>(data_matrix2, <span class="at">key=</span><span class="st">&quot;Sample&quot;</span>, <span class="at">value=</span><span class="st">&quot;Abundance&quot;</span>, <span class="sc">-</span>Gene)</span>
<span id="cb182-18"><a href="Rbasic.html#cb182-18" tabindex="-1"></a></span>
<span id="cb182-19"><a href="Rbasic.html#cb182-19" tabindex="-1"></a><span class="fu">head</span>(data_matrix_long2)</span></code></pre></div>
<pre><code>##    Gene Sample Abundance
## 1 Gene1   KO_1       1.3
## 2 Gene2   KO_1       1.1
## 3 Gene3   KO_1      16.8
## 4 Gene4   KO_1      11.0
## 5 Gene5   KO_1      20.0
## 6 Gene6   KO_1      33.0</code></pre>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="Rbasic.html#cb184-1" tabindex="-1"></a>data_matrix_long2<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">str_split</span>(data_matrix_long2<span class="sc">$</span>Sample, <span class="at">pattern=</span><span class="st">&quot;_&quot;</span>, <span class="at">simplify=</span>T)[,<span class="dv">1</span>]</span>
<span id="cb184-2"><a href="Rbasic.html#cb184-2" tabindex="-1"></a><span class="fu">head</span>(data_matrix_long2)</span></code></pre></div>
<pre><code>##    Gene Sample Abundance Group
## 1 Gene1   KO_1       1.3    KO
## 2 Gene2   KO_1       1.1    KO
## 3 Gene3   KO_1      16.8    KO
## 4 Gene4   KO_1      11.0    KO
## 5 Gene5   KO_1      20.0    KO
## 6 Gene6   KO_1      33.0    KO</code></pre>
<p>使用<code>separate</code>更简单</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="Rbasic.html#cb186-1" tabindex="-1"></a>data_matrix_long2 <span class="sc">%&gt;%</span> <span class="fu">separate</span>(Sample, <span class="fu">c</span>(<span class="st">&quot;Group&quot;</span>, <span class="st">&quot;Rep&quot;</span>),<span class="at">sep=</span><span class="st">&quot;_&quot;</span>, <span class="at">remove=</span>F)</span></code></pre></div>
<pre><code>##     Gene Sample Group Rep Abundance
## 1  Gene1   KO_1    KO   1       1.3
## 2  Gene2   KO_1    KO   1       1.1
## 3  Gene3   KO_1    KO   1      16.8
## 4  Gene4   KO_1    KO   1      11.0
## 5  Gene5   KO_1    KO   1      20.0
## 6  Gene6   KO_1    KO   1      33.0
## 7  Gene7   KO_1    KO   1       2.0
## 8  Gene8   KO_1    KO   1       3.0
## 9  Gene1   KO_2    KO   2       1.2
## 10 Gene2   KO_2    KO   2       1.9
## 11 Gene3   KO_2    KO   2      17.0
## 12 Gene4   KO_2    KO   2      13.0
## 13 Gene5   KO_2    KO   2      25.0
## 14 Gene6   KO_2    KO   2      30.0
## 15 Gene7   KO_2    KO   2       2.3
## 16 Gene8   KO_2    KO   2       3.6
## 17 Gene1   KO_3    KO   3       1.4
## 18 Gene2   KO_3    KO   3       1.6
## 19 Gene3   KO_3    KO   3      18.0
## 20 Gene4   KO_3    KO   3      12.0
## 21 Gene5   KO_3    KO   3      23.0
## 22 Gene6   KO_3    KO   3      35.0
## 23 Gene7   KO_3    KO   3       2.0
## 24 Gene8   KO_3    KO   3       3.0
## 25 Gene1   WT_1    WT   1       3.1
## 26 Gene2   WT_1    WT   1       2.3
## 27 Gene3   WT_1    WT   1      33.0
## 28 Gene4   WT_1    WT   1      25.0
## 29 Gene5   WT_1    WT   1       9.0
## 30 Gene6   WT_1    WT   1      16.0
## 31 Gene7   WT_1    WT   1       1.4
## 32 Gene8   WT_1    WT   1       1.2
## 33 Gene1   WT_2    WT   2       3.2
## 34 Gene2   WT_2    WT   2       2.2
## 35 Gene3   WT_2    WT   2      30.0
## 36 Gene4   WT_2    WT   2      26.0
## 37 Gene5   WT_2    WT   2      10.0
## 38 Gene6   WT_2    WT   2      17.0
## 39 Gene7   WT_2    WT   2       1.8
## 40 Gene8   WT_2    WT   2       1.9
## 41 Gene1   WT_3    WT   3       3.3
## 42 Gene2   WT_3    WT   3       2.1
## 43 Gene3   WT_3    WT   3      35.0
## 44 Gene4   WT_3    WT   3      28.0
## 45 Gene5   WT_3    WT   3      13.0
## 46 Gene6   WT_3    WT   3      16.0
## 47 Gene7   WT_3    WT   3       1.4
## 48 Gene8   WT_3    WT   3       1.2</code></pre>
<p>字符串拼合</p>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="Rbasic.html#cb188-1" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb188-2"><a href="Rbasic.html#cb188-2" tabindex="-1"></a><span class="co"># group_rep &lt;- as.data.frame(str_split(data_matrix_long2$Sample, pattern=&quot;_&quot;, simplify=T))</span></span>
<span id="cb188-3"><a href="Rbasic.html#cb188-3" tabindex="-1"></a><span class="co"># colnames(group_rep) &lt;- c(&quot;Group&quot;, &quot;Rep&quot;)</span></span>
<span id="cb188-4"><a href="Rbasic.html#cb188-4" tabindex="-1"></a><span class="co"># unite(group_rep, col=&quot;Sample&quot;, sep=&quot;_&quot;)</span></span>
<span id="cb188-5"><a href="Rbasic.html#cb188-5" tabindex="-1"></a></span>
<span id="cb188-6"><a href="Rbasic.html#cb188-6" tabindex="-1"></a>data_matrix_long2 <span class="sc">%&gt;%</span> <span class="fu">separate</span>(Sample, <span class="fu">c</span>(<span class="st">&quot;Group&quot;</span>, <span class="st">&quot;Rep&quot;</span>),<span class="at">sep=</span><span class="st">&quot;_&quot;</span>, <span class="at">remove=</span>F) <span class="sc">%&gt;%</span> <span class="fu">unite</span>(<span class="at">col=</span><span class="st">&quot;Sample2&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;Group&quot;</span>,<span class="st">&quot;Rep&quot;</span>), <span class="at">sep=</span><span class="st">&quot;-&quot;</span>, <span class="at">remove=</span>F)</span></code></pre></div>
<pre><code>##     Gene Sample Sample2 Group Rep Abundance
## 1  Gene1   KO_1    KO-1    KO   1       1.3
## 2  Gene2   KO_1    KO-1    KO   1       1.1
## 3  Gene3   KO_1    KO-1    KO   1      16.8
## 4  Gene4   KO_1    KO-1    KO   1      11.0
## 5  Gene5   KO_1    KO-1    KO   1      20.0
## 6  Gene6   KO_1    KO-1    KO   1      33.0
## 7  Gene7   KO_1    KO-1    KO   1       2.0
## 8  Gene8   KO_1    KO-1    KO   1       3.0
## 9  Gene1   KO_2    KO-2    KO   2       1.2
## 10 Gene2   KO_2    KO-2    KO   2       1.9
## 11 Gene3   KO_2    KO-2    KO   2      17.0
## 12 Gene4   KO_2    KO-2    KO   2      13.0
## 13 Gene5   KO_2    KO-2    KO   2      25.0
## 14 Gene6   KO_2    KO-2    KO   2      30.0
## 15 Gene7   KO_2    KO-2    KO   2       2.3
## 16 Gene8   KO_2    KO-2    KO   2       3.6
## 17 Gene1   KO_3    KO-3    KO   3       1.4
## 18 Gene2   KO_3    KO-3    KO   3       1.6
## 19 Gene3   KO_3    KO-3    KO   3      18.0
## 20 Gene4   KO_3    KO-3    KO   3      12.0
## 21 Gene5   KO_3    KO-3    KO   3      23.0
## 22 Gene6   KO_3    KO-3    KO   3      35.0
## 23 Gene7   KO_3    KO-3    KO   3       2.0
## 24 Gene8   KO_3    KO-3    KO   3       3.0
## 25 Gene1   WT_1    WT-1    WT   1       3.1
## 26 Gene2   WT_1    WT-1    WT   1       2.3
## 27 Gene3   WT_1    WT-1    WT   1      33.0
## 28 Gene4   WT_1    WT-1    WT   1      25.0
## 29 Gene5   WT_1    WT-1    WT   1       9.0
## 30 Gene6   WT_1    WT-1    WT   1      16.0
## 31 Gene7   WT_1    WT-1    WT   1       1.4
## 32 Gene8   WT_1    WT-1    WT   1       1.2
## 33 Gene1   WT_2    WT-2    WT   2       3.2
## 34 Gene2   WT_2    WT-2    WT   2       2.2
## 35 Gene3   WT_2    WT-2    WT   2      30.0
## 36 Gene4   WT_2    WT-2    WT   2      26.0
## 37 Gene5   WT_2    WT-2    WT   2      10.0
## 38 Gene6   WT_2    WT-2    WT   2      17.0
## 39 Gene7   WT_2    WT-2    WT   2       1.8
## 40 Gene8   WT_2    WT-2    WT   2       1.9
## 41 Gene1   WT_3    WT-3    WT   3       3.3
## 42 Gene2   WT_3    WT-3    WT   3       2.1
## 43 Gene3   WT_3    WT-3    WT   3      35.0
## 44 Gene4   WT_3    WT-3    WT   3      28.0
## 45 Gene5   WT_3    WT-3    WT   3      13.0
## 46 Gene6   WT_3    WT-3    WT   3      16.0
## 47 Gene7   WT_3    WT-3    WT   3       1.4
## 48 Gene8   WT_3    WT-3    WT   3       1.2</code></pre>
<p>用柱状图看下每个Gene在不同组的表达情况</p>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="Rbasic.html#cb190-1" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb190-2"><a href="Rbasic.html#cb190-2" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb190-3"><a href="Rbasic.html#cb190-3" tabindex="-1"></a><span class="co"># 给定数据，和x轴、y轴所在列名字</span></span>
<span id="cb190-4"><a href="Rbasic.html#cb190-4" tabindex="-1"></a><span class="co"># 直接使用geom_bar就可以绘制柱状图</span></span>
<span id="cb190-5"><a href="Rbasic.html#cb190-5" tabindex="-1"></a><span class="co"># position: dodge: 柱子并排放置</span></span>
<span id="cb190-6"><a href="Rbasic.html#cb190-6" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_matrix_long, <span class="fu">aes</span>(<span class="at">x=</span>Gene, <span class="at">y=</span>Abundance))</span>
<span id="cb190-7"><a href="Rbasic.html#cb190-7" tabindex="-1"></a>p <span class="sc">+</span> <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="fu">aes</span>(<span class="at">fill=</span>Sample))</span>
<span id="cb190-8"><a href="Rbasic.html#cb190-8" tabindex="-1"></a></span>
<span id="cb190-9"><a href="Rbasic.html#cb190-9" tabindex="-1"></a><span class="co"># 如果没有图形界面，运行下面的语句把图存在工作目录下的Rplots.pdf文件中</span></span>
<span id="cb190-10"><a href="Rbasic.html#cb190-10" tabindex="-1"></a><span class="co">#dev.off()</span></span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-98-1.png" width="100%" style="display: block; margin: auto;" />
柱子有点多，也可以利用mean±SD的形式展现</p>
<p>首先计算平均值和标准差，使用<code>group_by</code>按<code>Gene, Group</code>分组，对每组做<code>summarize</code>。</p>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="Rbasic.html#cb191-1" tabindex="-1"></a>data_matrix_long <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Gene)</span></code></pre></div>
<pre><code>##     Gene Sample Group Rep Abundance
## 1  Gene1    KO1    KO   1       1.3
## 2  Gene1    KO2    KO   2       1.2
## 3  Gene1    KO3    KO   3       1.4
## 4  Gene1    WT1    WT   1       3.1
## 5  Gene1    WT2    WT   2       3.2
## 6  Gene1    WT3    WT   3       3.3
## 7  Gene2    KO1    KO   1       1.1
## 8  Gene2    KO2    KO   2       1.9
## 9  Gene2    KO3    KO   3       1.6
## 10 Gene2    WT1    WT   1       2.3
## 11 Gene2    WT2    WT   2       2.2
## 12 Gene2    WT3    WT   3       2.1
## 13 Gene3    KO1    KO   1      16.8
## 14 Gene3    KO2    KO   2      17.0
## 15 Gene3    KO3    KO   3      18.0
## 16 Gene3    WT1    WT   1      33.0
## 17 Gene3    WT2    WT   2      30.0
## 18 Gene3    WT3    WT   3      35.0
## 19 Gene4    KO1    KO   1      11.0
## 20 Gene4    KO2    KO   2      13.0
## 21 Gene4    KO3    KO   3      12.0
## 22 Gene4    WT1    WT   1      25.0
## 23 Gene4    WT2    WT   2      26.0
## 24 Gene4    WT3    WT   3      28.0
## 25 Gene5    KO1    KO   1      20.0
## 26 Gene5    KO2    KO   2      25.0
## 27 Gene5    KO3    KO   3      23.0
## 28 Gene5    WT1    WT   1       9.0
## 29 Gene5    WT2    WT   2      10.0
## 30 Gene5    WT3    WT   3      13.0
## 31 Gene6    KO1    KO   1      33.0
## 32 Gene6    KO2    KO   2      30.0
## 33 Gene6    KO3    KO   3      35.0
## 34 Gene6    WT1    WT   1      16.0
## 35 Gene6    WT2    WT   2      17.0
## 36 Gene6    WT3    WT   3      16.0
## 37 Gene7    KO1    KO   1       2.0
## 38 Gene7    KO2    KO   2       2.3
## 39 Gene7    KO3    KO   3       2.0
## 40 Gene7    WT1    WT   1       1.4
## 41 Gene7    WT2    WT   2       1.8
## 42 Gene7    WT3    WT   3       1.4
## 43 Gene8    KO1    KO   1       3.0
## 44 Gene8    KO2    KO   2       3.6
## 45 Gene8    KO3    KO   3       3.0
## 46 Gene8    WT1    WT   1       1.2
## 47 Gene8    WT2    WT   2       1.9
## 48 Gene8    WT3    WT   3       1.2</code></pre>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="Rbasic.html#cb193-1" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb193-2"><a href="Rbasic.html#cb193-2" tabindex="-1"></a><span class="co"># 获取平均值和标准差</span></span>
<span id="cb193-3"><a href="Rbasic.html#cb193-3" tabindex="-1"></a>data_m_sd_mean <span class="ot">&lt;-</span> data_matrix_long <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Gene, Group) <span class="sc">%&gt;%</span> </span>
<span id="cb193-4"><a href="Rbasic.html#cb193-4" tabindex="-1"></a>    dplyr<span class="sc">::</span><span class="fu">summarise</span>(<span class="at">sd=</span><span class="fu">sd</span>(Abundance), <span class="at">mean_value=</span><span class="fu">mean</span>(Abundance))</span></code></pre></div>
<pre><code>## `summarise()` has grouped output by
## &#39;Gene&#39;. You can override using the
## `.groups` argument.</code></pre>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="Rbasic.html#cb195-1" tabindex="-1"></a>data_m_sd_mean <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data_m_sd_mean)</span>
<span id="cb195-2"><a href="Rbasic.html#cb195-2" tabindex="-1"></a>data_m_sd_mean</span></code></pre></div>
<pre><code>##     Gene Group        sd mean_value
## 1  Gene1    KO 0.1000000   1.300000
## 2  Gene1    WT 0.1000000   3.200000
## 3  Gene2    KO 0.4041452   1.533333
## 4  Gene2    WT 0.1000000   2.200000
## 5  Gene3    KO 0.6429101  17.266667
## 6  Gene3    WT 2.5166115  32.666667
## 7  Gene4    KO 1.0000000  12.000000
## 8  Gene4    WT 1.5275252  26.333333
## 9  Gene5    KO 2.5166115  22.666667
## 10 Gene5    WT 2.0816660  10.666667
## 11 Gene6    KO 2.5166115  32.666667
## 12 Gene6    WT 0.5773503  16.333333
## 13 Gene7    KO 0.1732051   2.100000
## 14 Gene7    WT 0.2309401   1.533333
## 15 Gene8    KO 0.3464102   3.200000
## 16 Gene8    WT 0.4041452   1.433333</code></pre>
<p>使用<code>geom_errorbar</code>添加误差线</p>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="Rbasic.html#cb197-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_m_sd_mean, <span class="fu">aes</span>(<span class="at">x=</span>Gene, <span class="at">y=</span>mean_value, <span class="at">group=</span>Group)) <span class="sc">+</span> </span>
<span id="cb197-2"><a href="Rbasic.html#cb197-2" tabindex="-1"></a>       <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">position=</span><span class="st">&quot;dodge&quot;</span>, <span class="fu">aes</span>(<span class="at">fill=</span>Group)) <span class="sc">+</span></span>
<span id="cb197-3"><a href="Rbasic.html#cb197-3" tabindex="-1"></a>     <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>mean_value<span class="sc">-</span>sd, <span class="at">ymax=</span>mean_value<span class="sc">+</span>sd), <span class="at">width=</span><span class="fl">0.2</span>, <span class="at">position=</span><span class="fu">position_dodge</span>(<span class="at">width=</span><span class="fl">0.9</span>))</span>
<span id="cb197-4"><a href="Rbasic.html#cb197-4" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-101-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>采用<code>ggpubr</code>绘制<code>barplot+errorbar</code></p>
<div class="sourceCode" id="cb198"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb198-1"><a href="Rbasic.html#cb198-1" tabindex="-1"></a><span class="fu">library</span>(ggpubr)</span>
<span id="cb198-2"><a href="Rbasic.html#cb198-2" tabindex="-1"></a><span class="fu">ggbarplot</span>(data_matrix_long, <span class="at">x =</span> <span class="st">&quot;Gene&quot;</span>, <span class="at">y =</span> <span class="st">&quot;Abundance&quot;</span>, <span class="at">color =</span> <span class="st">&quot;Group&quot;</span>, <span class="co">#add.params = list(group = &quot;Group&quot;),</span></span>
<span id="cb198-3"><a href="Rbasic.html#cb198-3" tabindex="-1"></a> <span class="at">add =</span> <span class="fu">c</span>(<span class="st">&quot;mean_se&quot;</span>,<span class="st">&quot;jitter&quot;</span>), <span class="at">palette =</span> <span class="fu">c</span>(<span class="st">&quot;#00AFBB&quot;</span>, <span class="st">&quot;#E7B800&quot;</span>),</span>
<span id="cb198-4"><a href="Rbasic.html#cb198-4" tabindex="-1"></a> <span class="at">position =</span> <span class="fu">position_dodge</span>())</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-102-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>绘制带Error-bar的堆叠柱状图</p>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="Rbasic.html#cb199-1" tabindex="-1"></a><span class="fu">library</span>(plyr) </span>
<span id="cb199-2"><a href="Rbasic.html#cb199-2" tabindex="-1"></a>data_m_sd_mean_stack <span class="ot">&lt;-</span> data_m_sd_mean</span>
<span id="cb199-3"><a href="Rbasic.html#cb199-3" tabindex="-1"></a>factor_level <span class="ot">&lt;-</span> <span class="fu">unique</span>(data_m_sd_mean_stack<span class="sc">$</span>Group)</span>
<span id="cb199-4"><a href="Rbasic.html#cb199-4" tabindex="-1"></a>data_m_sd_mean_stack<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">factor</span>(data_m_sd_mean_stack<span class="sc">$</span>Group, <span class="at">levels=</span>factor_level, <span class="at">ordered=</span>T)</span>
<span id="cb199-5"><a href="Rbasic.html#cb199-5" tabindex="-1"></a>mydata2 <span class="ot">&lt;-</span> <span class="fu">ddply</span>(data_m_sd_mean_stack,.(Gene),transform,<span class="at">ymin =</span> <span class="fu">cumsum</span>(mean_value) <span class="sc">-</span> sd,<span class="at">ymax =</span> <span class="fu">cumsum</span>(mean_value) <span class="sc">+</span> sd)  </span>
<span id="cb199-6"><a href="Rbasic.html#cb199-6" tabindex="-1"></a>mydata2</span></code></pre></div>
<pre><code>##     Gene Group        sd mean_value      ymin      ymax
## 1  Gene1    KO 0.1000000   1.300000  1.200000  1.400000
## 2  Gene1    WT 0.1000000   3.200000  4.400000  4.600000
## 3  Gene2    KO 0.4041452   1.533333  1.129188  1.937479
## 4  Gene2    WT 0.1000000   2.200000  3.633333  3.833333
## 5  Gene3    KO 0.6429101  17.266667 16.623757 17.909577
## 6  Gene3    WT 2.5166115  32.666667 47.416722 52.449945
## 7  Gene4    KO 1.0000000  12.000000 11.000000 13.000000
## 8  Gene4    WT 1.5275252  26.333333 36.805808 39.860859
## 9  Gene5    KO 2.5166115  22.666667 20.150055 25.183278
## 10 Gene5    WT 2.0816660  10.666667 31.251667 35.414999
## 11 Gene6    KO 2.5166115  32.666667 30.150055 35.183278
## 12 Gene6    WT 0.5773503  16.333333 48.422650 49.577350
## 13 Gene7    KO 0.1732051   2.100000  1.926795  2.273205
## 14 Gene7    WT 0.2309401   1.533333  3.402393  3.864273
## 15 Gene8    KO 0.3464102   3.200000  2.853590  3.546410
## 16 Gene8    WT 0.4041452   1.433333  4.229188  5.037479</code></pre>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="Rbasic.html#cb201-1" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb201-2"><a href="Rbasic.html#cb201-2" tabindex="-1"></a></span>
<span id="cb201-3"><a href="Rbasic.html#cb201-3" tabindex="-1"></a>cols <span class="ot">=</span> <span class="fu">colorRampPalette</span>(<span class="fu">brewer.pal</span>(<span class="dv">9</span>, <span class="st">&quot;Paired&quot;</span>))(<span class="fu">length</span>(factor_level))</span>
<span id="cb201-4"><a href="Rbasic.html#cb201-4" tabindex="-1"></a>mydata2<span class="sc">$</span>Group <span class="ot">&lt;-</span> <span class="fu">factor</span>(mydata2<span class="sc">$</span>Group, <span class="at">levels=</span><span class="fu">rev</span>(factor_level), <span class="at">ordered=</span>T)</span>
<span id="cb201-5"><a href="Rbasic.html#cb201-5" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(mydata2, <span class="fu">aes</span>(<span class="at">x=</span>Gene, <span class="at">y=</span>mean_value, <span class="at">group=</span>Group)) <span class="sc">+</span> </span>
<span id="cb201-6"><a href="Rbasic.html#cb201-6" tabindex="-1"></a>       <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="fu">aes</span>(<span class="at">fill=</span>Group), <span class="at">position =</span> <span class="st">&quot;stack&quot;</span>) <span class="sc">+</span></span>
<span id="cb201-7"><a href="Rbasic.html#cb201-7" tabindex="-1"></a>     <span class="fu">scale_fill_manual</span>(<span class="at">values=</span>cols) <span class="sc">+</span> </span>
<span id="cb201-8"><a href="Rbasic.html#cb201-8" tabindex="-1"></a>     <span class="fu">geom_errorbar</span>(<span class="fu">aes</span>(<span class="at">ymin=</span>ymin, <span class="at">ymax=</span>ymax), <span class="at">width=</span><span class="fl">0.2</span>,<span class="at">color=</span><span class="st">&quot;black&quot;</span>, <span class="at">position=</span><span class="fu">position_identity</span>())</span>
<span id="cb201-9"><a href="Rbasic.html#cb201-9" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-104-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>在柱子中标记百分比值</p>
<p>首先计算百分比，同样是<code>group_by</code> (按照给定的变量分组，然后按组操作)和<code>mutate</code>两个函数(在当前数据表增加新变量)</p>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="Rbasic.html#cb202-1" tabindex="-1"></a><span class="co"># group_by: 按照给定的变量分组，然后按组操作</span></span>
<span id="cb202-2"><a href="Rbasic.html#cb202-2" tabindex="-1"></a><span class="co"># mutate: 在当前数据表增加新变量</span></span>
<span id="cb202-3"><a href="Rbasic.html#cb202-3" tabindex="-1"></a><span class="co"># 第一步增加每个组的加和，第二步计算比例</span></span>
<span id="cb202-4"><a href="Rbasic.html#cb202-4" tabindex="-1"></a>data_m <span class="ot">&lt;-</span> data_matrix_long</span>
<span id="cb202-5"><a href="Rbasic.html#cb202-5" tabindex="-1"></a>data_m <span class="ot">&lt;-</span> data_m <span class="sc">%&gt;%</span> <span class="fu">group_by</span>(Gene) <span class="sc">%&gt;%</span> <span class="fu">mutate</span>(<span class="at">count=</span><span class="fu">sum</span>(Abundance), <span class="at">freq=</span><span class="fu">round</span>(<span class="dv">100</span><span class="sc">*</span>Abundance<span class="sc">/</span>count,<span class="dv">2</span>)) <span class="sc">%&gt;%</span> <span class="fu">arrange</span>(Gene, Sample)</span>
<span id="cb202-6"><a href="Rbasic.html#cb202-6" tabindex="-1"></a></span>
<span id="cb202-7"><a href="Rbasic.html#cb202-7" tabindex="-1"></a><span class="fu">head</span>(data_m)</span></code></pre></div>
<pre><code>## # A tibble: 6 × 7
## # Groups:   Gene [1]
##   Gene  Sample Group Rep   Abundance count  freq
##   &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt; &lt;chr&gt;     &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
## 1 Gene1 KO1    KO    1           1.3  561.  0.23
## 2 Gene1 KO2    KO    2           1.2  561.  0.21
## 3 Gene1 KO3    KO    3           1.4  561.  0.25
## 4 Gene1 WT1    WT    1           3.1  561.  0.55
## 5 Gene1 WT2    WT    2           3.2  561.  0.57
## 6 Gene1 WT3    WT    3           3.3  561.  0.59</code></pre>
<p>再标记相对比例信息</p>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="Rbasic.html#cb204-1" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="fu">ggplot</span>(data_m, <span class="fu">aes</span>(<span class="at">x=</span>Gene, <span class="at">y=</span>Abundance, <span class="at">group=</span>Group)) <span class="sc">+</span></span>
<span id="cb204-2"><a href="Rbasic.html#cb204-2" tabindex="-1"></a>    <span class="fu">geom_bar</span>(<span class="at">stat=</span><span class="st">&quot;identity&quot;</span>, <span class="at">position=</span><span class="st">&quot;fill&quot;</span>, <span class="fu">aes</span>(<span class="at">fill=</span>Sample)) <span class="sc">+</span></span>
<span id="cb204-3"><a href="Rbasic.html#cb204-3" tabindex="-1"></a>    <span class="fu">scale_y_continuous</span>(<span class="at">labels =</span> scales<span class="sc">::</span>percent) <span class="sc">+</span></span>
<span id="cb204-4"><a href="Rbasic.html#cb204-4" tabindex="-1"></a>    <span class="fu">geom_text</span>(<span class="fu">aes</span>(<span class="at">label=</span>freq), <span class="at">position=</span><span class="fu">position_fill</span>(<span class="at">vjust=</span><span class="fl">0.5</span>))</span>
<span id="cb204-5"><a href="Rbasic.html#cb204-5" tabindex="-1"></a>p</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-106-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="RColorBrewer" class="section level3 hasAnchor" number="2.5.2">
<h3><span class="header-section-number">2.5.2</span> 配色<a href="Rbasic.html#RColorBrewer" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>序列型颜色板适用于从低到高排序明显的数据，浅色数字小，深色数字大。</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="Rbasic.html#cb205-1" tabindex="-1"></a><span class="fu">library</span>(RColorBrewer)</span>
<span id="cb205-2"><a href="Rbasic.html#cb205-2" tabindex="-1"></a><span class="fu">display.brewer.all</span>(<span class="at">type =</span> <span class="st">&quot;seq&quot;</span>)</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-107-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>离散型颜色板适合带“正、负”的，对极值和中间值比较注重的数据。</p>
<div class="sourceCode" id="cb206"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb206-1"><a href="Rbasic.html#cb206-1" tabindex="-1"></a><span class="fu">display.brewer.all</span>(<span class="at">type =</span> <span class="st">&quot;div&quot;</span>)</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-108-1.png" width="100%" style="display: block; margin: auto;" /></p>
<p>分类型颜色板比较适合区分分类型的数据。</p>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="Rbasic.html#cb207-1" tabindex="-1"></a><span class="fu">display.brewer.all</span>(<span class="at">type =</span> <span class="st">&quot;qual&quot;</span>)</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-109-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
<div id="phetamap" class="section level3 hasAnchor" number="2.5.3">
<h3><span class="header-section-number">2.5.3</span> pheatmap绘制热图<a href="Rbasic.html#phetamap" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="Rbasic.html#cb208-1" tabindex="-1"></a>data_matrix <span class="ot">=</span> <span class="st">&quot;KO1;KO2;KO3;WT1;WT2;WT3</span></span>
<span id="cb208-2"><a href="Rbasic.html#cb208-2" tabindex="-1"></a><span class="st">Gene1;1.2;1.2;1.2;3.0;3.0;3.0</span></span>
<span id="cb208-3"><a href="Rbasic.html#cb208-3" tabindex="-1"></a><span class="st">Gene2;1.4;1.4;1.4;2.0;2.0;2.0</span></span>
<span id="cb208-4"><a href="Rbasic.html#cb208-4" tabindex="-1"></a><span class="st">Gene3;16.0;16.0;16.0;30.0;30.0;30.0</span></span>
<span id="cb208-5"><a href="Rbasic.html#cb208-5" tabindex="-1"></a><span class="st">Gene4;10.0;10.0;10.0;25.0;25.0;25.0</span></span>
<span id="cb208-6"><a href="Rbasic.html#cb208-6" tabindex="-1"></a><span class="st">Gene5;25.0;25.0;25.0;10.0;10.0;10.0</span></span>
<span id="cb208-7"><a href="Rbasic.html#cb208-7" tabindex="-1"></a><span class="st">Gene6;30.0;30.0;30.0;16.0;16.0;16.0</span></span>
<span id="cb208-8"><a href="Rbasic.html#cb208-8" tabindex="-1"></a><span class="st">Gene7;2.0;2.0;2.0;1.4;1.4;1.4</span></span>
<span id="cb208-9"><a href="Rbasic.html#cb208-9" tabindex="-1"></a><span class="st">Gene8;3.0;3.0;3.0;1.2;1.2;1.2&quot;</span></span>
<span id="cb208-10"><a href="Rbasic.html#cb208-10" tabindex="-1"></a></span>
<span id="cb208-11"><a href="Rbasic.html#cb208-11" tabindex="-1"></a>data_matrix <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">text=</span>data_matrix, <span class="at">header=</span>T, <span class="at">row.names=</span><span class="dv">1</span>, <span class="at">sep=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb208-12"><a href="Rbasic.html#cb208-12" tabindex="-1"></a></span>
<span id="cb208-13"><a href="Rbasic.html#cb208-13" tabindex="-1"></a><span class="fu">head</span>(data_matrix)</span></code></pre></div>
<pre><code>##        KO1  KO2  KO3 WT1 WT2 WT3
## Gene1  1.2  1.2  1.2   3   3   3
## Gene2  1.4  1.4  1.4   2   2   2
## Gene3 16.0 16.0 16.0  30  30  30
## Gene4 10.0 10.0 10.0  25  25  25
## Gene5 25.0 25.0 25.0  10  10  10
## Gene6 30.0 30.0 30.0  16  16  16</code></pre>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="Rbasic.html#cb210-1" tabindex="-1"></a><span class="co">#data_matrix &lt;- read.table(&quot;gene_expr_mat.txt&quot;, header=T, row.names=1, sep=&quot;\t&quot;)</span></span>
<span id="cb210-2"><a href="Rbasic.html#cb210-2" tabindex="-1"></a></span>
<span id="cb210-3"><a href="Rbasic.html#cb210-3" tabindex="-1"></a><span class="co">#head(data_matrix)</span></span></code></pre></div>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="Rbasic.html#cb211-1" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span>
<span id="cb211-2"><a href="Rbasic.html#cb211-2" tabindex="-1"></a><span class="fu">pheatmap</span>(data_matrix)</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-112-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="Rbasic.html#cb212-1" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="st">&quot;samp;Grp</span></span>
<span id="cb212-2"><a href="Rbasic.html#cb212-2" tabindex="-1"></a><span class="st">WT1;WT</span></span>
<span id="cb212-3"><a href="Rbasic.html#cb212-3" tabindex="-1"></a><span class="st">WT2;WT</span></span>
<span id="cb212-4"><a href="Rbasic.html#cb212-4" tabindex="-1"></a><span class="st">WT3;WT</span></span>
<span id="cb212-5"><a href="Rbasic.html#cb212-5" tabindex="-1"></a><span class="st">KO1;KO</span></span>
<span id="cb212-6"><a href="Rbasic.html#cb212-6" tabindex="-1"></a><span class="st">KO2;KO</span></span>
<span id="cb212-7"><a href="Rbasic.html#cb212-7" tabindex="-1"></a><span class="st">KO3;KO&quot;</span></span>
<span id="cb212-8"><a href="Rbasic.html#cb212-8" tabindex="-1"></a></span>
<span id="cb212-9"><a href="Rbasic.html#cb212-9" tabindex="-1"></a>metadata <span class="ot">&lt;-</span> <span class="fu">read.table</span>(<span class="at">text=</span>metadata, <span class="at">header=</span>T, <span class="at">row.names=</span><span class="dv">1</span>, <span class="at">sep=</span><span class="st">&quot;;&quot;</span>)</span>
<span id="cb212-10"><a href="Rbasic.html#cb212-10" tabindex="-1"></a></span>
<span id="cb212-11"><a href="Rbasic.html#cb212-11" tabindex="-1"></a><span class="fu">pheatmap</span>(data_matrix, <span class="at">annotation_col =</span> metadata)</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-113-1.png" width="100%" style="display: block; margin: auto;" /></p>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="Rbasic.html#cb213-1" tabindex="-1"></a>colorL <span class="ot">=</span> <span class="fu">colorRampPalette</span>(<span class="fu">c</span>(<span class="st">&quot;green&quot;</span>,<span class="st">&quot;red&quot;</span>))(<span class="dv">30</span>)</span>
<span id="cb213-2"><a href="Rbasic.html#cb213-2" tabindex="-1"></a></span>
<span id="cb213-3"><a href="Rbasic.html#cb213-3" tabindex="-1"></a><span class="fu">pheatmap</span>(data_matrix, <span class="at">annotation_col =</span> metadata, <span class="at">color =</span> colorL)</span></code></pre></div>
<p><img src="R_course_files/figure-html/unnamed-chunk-114-1.png" width="100%" style="display: block; margin: auto;" /></p>
</div>
</div>
<div id="cheetsheets" class="section level2 hasAnchor" number="2.6">
<h2><span class="header-section-number">2.6</span> CheetSheets<a href="Rbasic.html#cheetsheets" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p><a href="https://www.rstudio.com/resources/cheatsheets/" class="uri">https://www.rstudio.com/resources/cheatsheets/</a></p>
</div>
<div id="参考-ref01" class="section level2 hasAnchor" number="2.7">
<h2><span class="header-section-number">2.7</span> 参考 {ref01}<a href="Rbasic.html#%E5%8F%82%E8%80%83-ref01" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<ul>
<li><a href="http://www.ysx.com/Bioinfo_bash_course/">生信宝典Linux系列</a></li>
<li><a href="https://mp.weixin.qq.com/mp/appmsgalbum?__biz=MzI5MTcwNjA4NQ==&amp;action=getalbum&amp;album_id=1335864997100224512&amp;subscene=21&amp;scenenote=https%3A%2F%2Fmp.weixin.qq.com%2Fs%3F__biz%3DMzI5MTcwNjA4NQ%3D%3D%26mid%3D2247490572%26idx%3D1%26sn%3Dc2ba3cb9e8117efff6bfd53c9f797109%26scene%3D21%26key%3D14893ff72db1d5ee36ae599230370c4cdd9e49dbfdd44fe73757d5c60d26ff6e698d2ccc26b16c7898a5164ac9ddb35f990c0bfeb88037b926c9eb29fbaf9867d2ad02e4b2e6da694013a82c124b6e44%26ascene%3D7%26uin%3DOTY2MDEyMzgw%26devicetype%3DWindows%2B10%2Bx64%26version%3D62090529%26lang%3Dzh_CN%26exportkey%3DAWleeoJ2D3RuwW6exYsshOM%253D%26pass_ticket%3D6oR4VId9JNdCLZp2iJjodI21oAREmYTa3D%252F9nfZlbY8TG5eZ3ToAoRlMm5nwdtwk%26winzoom%3D1#wechat_redirect">生信宝典R系列</a></li>
</ul>

</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="questions.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="Rplots.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": {
    "github": false,
    "facebook": false,
    "twitter": false,
    "linkedin": false,
    "weibo": false,
    "instapaper": false,
    "vk": false,
    "whatsapp": false,
    "all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
  },
  "fontsettings": {
    "theme": "white",
    "family": "sans",
    "size": 2
  },
  "edit": {
    "link": "https://github.com/Tong-Chen/Bioinfo_course_R/edit/master/01-Rbasic.Rmd",
    "text": "Edit"
  },
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": null,
    "text": null
  },
  "download": ["R_course.pdf"],
  "search": {
    "engine": "fuse",
    "options": null
  },
  "toc": {
    "collapse": "subsection"
  }
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
